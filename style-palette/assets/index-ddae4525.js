var Rg=Object.defineProperty;var Mg=(r,t,e)=>t in r?Rg(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var ar=(r,t,e)=>(Mg(r,typeof t!="symbol"?t+"":t,e),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();function Fh(r,t){const e=Object.create(null),i=r.split(",");for(let s=0;s<i.length;s++)e[i[s]]=!0;return t?s=>!!e[s.toLowerCase()]:s=>!!e[s]}const Mt={},ts=[],Oe=()=>{},Bg=()=>!1,Dg=/^on[^a-z]/,Wo=r=>Dg.test(r),Oh=r=>r.startsWith("onUpdate:"),qt=Object.assign,Nh=(r,t)=>{const e=r.indexOf(t);e>-1&&r.splice(e,1)},Fg=Object.prototype.hasOwnProperty,At=(r,t)=>Fg.call(r,t),ht=Array.isArray,es=r=>gn(r)==="[object Map]",Tf=r=>gn(r)==="[object Set]",Rc=r=>gn(r)==="[object Date]",gt=r=>typeof r=="function",$t=r=>typeof r=="string",cs=r=>typeof r=="symbol",Pt=r=>r!==null&&typeof r=="object",wf=r=>(Pt(r)||gt(r))&&gt(r.then)&&gt(r.catch),Af=Object.prototype.toString,gn=r=>Af.call(r),Og=r=>gn(r).slice(8,-1),Sf=r=>gn(r)==="[object Object]",Lh=r=>$t(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,ro=Fh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),jo=r=>{const t=Object.create(null);return e=>t[e]||(t[e]=r(e))},Ng=/-(\w)/g,ir=jo(r=>r.replace(Ng,(t,e)=>e?e.toUpperCase():"")),Lg=/\B([A-Z])/g,xs=jo(r=>r.replace(Lg,"-$1").toLowerCase()),Yo=jo(r=>r.charAt(0).toUpperCase()+r.slice(1)),xa=jo(r=>r?`on${Yo(r)}`:""),Si=(r,t)=>!Object.is(r,t),io=(r,t)=>{for(let e=0;e<r.length;e++)r[e](t)},_o=(r,t,e)=>{Object.defineProperty(r,t,{configurable:!0,enumerable:!1,value:e})},ml=r=>{const t=parseFloat(r);return isNaN(t)?r:t},kg=r=>{const t=$t(r)?Number(r):NaN;return isNaN(t)?r:t};let Mc;const gl=()=>Mc||(Mc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function kh(r){if(ht(r)){const t={};for(let e=0;e<r.length;e++){const i=r[e],s=$t(i)?$g(i):kh(i);if(s)for(const n in s)t[n]=s[n]}return t}else if($t(r)||Pt(r))return r}const Ug=/;(?![^(]*\))/g,Gg=/:([^]+)/,Hg=/\/\*[^]*?\*\//g;function $g(r){const t={};return r.replace(Hg,"").split(Ug).forEach(e=>{if(e){const i=e.split(Gg);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Er(r){let t="";if($t(r))t=r;else if(ht(r))for(let e=0;e<r.length;e++){const i=Er(r[e]);i&&(t+=i+" ")}else if(Pt(r))for(const e in r)r[e]&&(t+=e+" ");return t.trim()}const Vg="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Xg=Fh(Vg);function Cf(r){return!!r||r===""}function zg(r,t){if(r.length!==t.length)return!1;let e=!0;for(let i=0;e&&i<r.length;i++)e=vo(r[i],t[i]);return e}function vo(r,t){if(r===t)return!0;let e=Rc(r),i=Rc(t);if(e||i)return e&&i?r.getTime()===t.getTime():!1;if(e=cs(r),i=cs(t),e||i)return r===t;if(e=ht(r),i=ht(t),e||i)return e&&i?zg(r,t):!1;if(e=Pt(r),i=Pt(t),e||i){if(!e||!i)return!1;const s=Object.keys(r).length,n=Object.keys(t).length;if(s!==n)return!1;for(const o in r){const a=r.hasOwnProperty(o),l=t.hasOwnProperty(o);if(a&&!l||!a&&l||!vo(r[o],t[o]))return!1}}return String(r)===String(t)}const Uh=r=>$t(r)?r:r==null?"":ht(r)||Pt(r)&&(r.toString===Af||!gt(r.toString))?JSON.stringify(r,If,2):String(r),If=(r,t)=>t&&t.__v_isRef?If(r,t.value):es(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[i,s])=>(e[`${i} =>`]=s,e),{})}:Tf(t)?{[`Set(${t.size})`]:[...t.values()]}:Pt(t)&&!ht(t)&&!Sf(t)?String(t):t;let ge;class Pf{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=ge,!t&&ge&&(this.index=(ge.scopes||(ge.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const e=ge;try{return ge=this,t()}finally{ge=e}}}on(){ge=this}off(){ge=this.parent}stop(t){if(this._active){let e,i;for(e=0,i=this.effects.length;e<i;e++)this.effects[e].stop();for(e=0,i=this.cleanups.length;e<i;e++)this.cleanups[e]();if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function Rf(r){return new Pf(r)}function Wg(r,t=ge){t&&t.active&&t.effects.push(r)}function Mf(){return ge}function jg(r){ge&&ge.cleanups.push(r)}const Gh=r=>{const t=new Set(r);return t.w=0,t.n=0,t},Bf=r=>(r.w&Wr)>0,Df=r=>(r.n&Wr)>0,Yg=({deps:r})=>{if(r.length)for(let t=0;t<r.length;t++)r[t].w|=Wr},qg=r=>{const{deps:t}=r;if(t.length){let e=0;for(let i=0;i<t.length;i++){const s=t[i];Bf(s)&&!Df(s)?s.delete(r):t[e++]=s,s.w&=~Wr,s.n&=~Wr}t.length=e}},xo=new WeakMap;let Ns=0,Wr=1;const yl=30;let Be;const bi=Symbol(""),_l=Symbol("");class Hh{constructor(t,e=null,i){this.fn=t,this.scheduler=e,this.active=!0,this.deps=[],this.parent=void 0,Wg(this,i)}run(){if(!this.active)return this.fn();let t=Be,e=Hr;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Be,Be=this,Hr=!0,Wr=1<<++Ns,Ns<=yl?Yg(this):Bc(this),this.fn()}finally{Ns<=yl&&qg(this),Wr=1<<--Ns,Be=this.parent,Hr=e,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Be===this?this.deferStop=!0:this.active&&(Bc(this),this.onStop&&this.onStop(),this.active=!1)}}function Bc(r){const{deps:t}=r;if(t.length){for(let e=0;e<t.length;e++)t[e].delete(r);t.length=0}}let Hr=!0;const Ff=[];function bs(){Ff.push(Hr),Hr=!1}function Es(){const r=Ff.pop();Hr=r===void 0?!0:r}function fe(r,t,e){if(Hr&&Be){let i=xo.get(r);i||xo.set(r,i=new Map);let s=i.get(e);s||i.set(e,s=Gh()),Of(s)}}function Of(r,t){let e=!1;Ns<=yl?Df(r)||(r.n|=Wr,e=!Bf(r)):e=!r.has(Be),e&&(r.add(Be),Be.deps.push(r))}function vr(r,t,e,i,s,n){const o=xo.get(r);if(!o)return;let a=[];if(t==="clear")a=[...o.values()];else if(e==="length"&&ht(r)){const l=Number(i);o.forEach((h,c)=>{(c==="length"||!cs(c)&&c>=l)&&a.push(h)})}else switch(e!==void 0&&a.push(o.get(e)),t){case"add":ht(r)?Lh(e)&&a.push(o.get("length")):(a.push(o.get(bi)),es(r)&&a.push(o.get(_l)));break;case"delete":ht(r)||(a.push(o.get(bi)),es(r)&&a.push(o.get(_l)));break;case"set":es(r)&&a.push(o.get(bi));break}if(a.length===1)a[0]&&vl(a[0]);else{const l=[];for(const h of a)h&&l.push(...h);vl(Gh(l))}}function vl(r,t){const e=ht(r)?r:[...r];for(const i of e)i.computed&&Dc(i);for(const i of e)i.computed||Dc(i)}function Dc(r,t){(r!==Be||r.allowRecurse)&&(r.scheduler?r.scheduler():r.run())}function Kg(r,t){var e;return(e=xo.get(r))==null?void 0:e.get(t)}const Zg=Fh("__proto__,__v_isRef,__isVue"),Nf=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(cs)),Fc=Qg();function Qg(){const r={};return["includes","indexOf","lastIndexOf"].forEach(t=>{r[t]=function(...e){const i=yt(this);for(let n=0,o=this.length;n<o;n++)fe(i,"get",n+"");const s=i[t](...e);return s===-1||s===!1?i[t](...e.map(yt)):s}}),["push","pop","shift","unshift","splice"].forEach(t=>{r[t]=function(...e){bs();const i=yt(this)[t].apply(this,e);return Es(),i}}),r}function Jg(r){const t=yt(this);return fe(t,"has",r),t.hasOwnProperty(r)}class Lf{constructor(t=!1,e=!1){this._isReadonly=t,this._shallow=e}get(t,e,i){const s=this._isReadonly,n=this._shallow;if(e==="__v_isReactive")return!s;if(e==="__v_isReadonly")return s;if(e==="__v_isShallow")return n;if(e==="__v_raw"&&i===(s?n?dy:Hf:n?Gf:Uf).get(t))return t;const o=ht(t);if(!s){if(o&&At(Fc,e))return Reflect.get(Fc,e,i);if(e==="hasOwnProperty")return Jg}const a=Reflect.get(t,e,i);return(cs(e)?Nf.has(e):Zg(e))||(s||fe(t,"get",e),n)?a:Gt(a)?o&&Lh(e)?a:a.value:Pt(a)?s?Vf(a):Zr(a):a}}class kf extends Lf{constructor(t=!1){super(!1,t)}set(t,e,i,s){let n=t[e];if(us(n)&&Gt(n)&&!Gt(i))return!1;if(!this._shallow&&(!bo(i)&&!us(i)&&(n=yt(n),i=yt(i)),!ht(t)&&Gt(n)&&!Gt(i)))return n.value=i,!0;const o=ht(t)&&Lh(e)?Number(e)<t.length:At(t,e),a=Reflect.set(t,e,i,s);return t===yt(s)&&(o?Si(i,n)&&vr(t,"set",e,i):vr(t,"add",e,i)),a}deleteProperty(t,e){const i=At(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&i&&vr(t,"delete",e,void 0),s}has(t,e){const i=Reflect.has(t,e);return(!cs(e)||!Nf.has(e))&&fe(t,"has",e),i}ownKeys(t){return fe(t,"iterate",ht(t)?"length":bi),Reflect.ownKeys(t)}}class ty extends Lf{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const ey=new kf,ry=new ty,iy=new kf(!0),$h=r=>r,qo=r=>Reflect.getPrototypeOf(r);function En(r,t,e=!1,i=!1){r=r.__v_raw;const s=yt(r),n=yt(t);e||(Si(t,n)&&fe(s,"get",t),fe(s,"get",n));const{has:o}=qo(s),a=i?$h:e?zh:sn;if(o.call(s,t))return a(r.get(t));if(o.call(s,n))return a(r.get(n));r!==s&&r.get(t)}function Tn(r,t=!1){const e=this.__v_raw,i=yt(e),s=yt(r);return t||(Si(r,s)&&fe(i,"has",r),fe(i,"has",s)),r===s?e.has(r):e.has(r)||e.has(s)}function wn(r,t=!1){return r=r.__v_raw,!t&&fe(yt(r),"iterate",bi),Reflect.get(r,"size",r)}function Oc(r){r=yt(r);const t=yt(this);return qo(t).has.call(t,r)||(t.add(r),vr(t,"add",r,r)),this}function Nc(r,t){t=yt(t);const e=yt(this),{has:i,get:s}=qo(e);let n=i.call(e,r);n||(r=yt(r),n=i.call(e,r));const o=s.call(e,r);return e.set(r,t),n?Si(t,o)&&vr(e,"set",r,t):vr(e,"add",r,t),this}function Lc(r){const t=yt(this),{has:e,get:i}=qo(t);let s=e.call(t,r);s||(r=yt(r),s=e.call(t,r)),i&&i.call(t,r);const n=t.delete(r);return s&&vr(t,"delete",r,void 0),n}function kc(){const r=yt(this),t=r.size!==0,e=r.clear();return t&&vr(r,"clear",void 0,void 0),e}function An(r,t){return function(i,s){const n=this,o=n.__v_raw,a=yt(o),l=t?$h:r?zh:sn;return!r&&fe(a,"iterate",bi),o.forEach((h,c)=>i.call(s,l(h),l(c),n))}}function Sn(r,t,e){return function(...i){const s=this.__v_raw,n=yt(s),o=es(n),a=r==="entries"||r===Symbol.iterator&&o,l=r==="keys"&&o,h=s[r](...i),c=e?$h:t?zh:sn;return!t&&fe(n,"iterate",l?_l:bi),{next(){const{value:u,done:d}=h.next();return d?{value:u,done:d}:{value:a?[c(u[0]),c(u[1])]:c(u),done:d}},[Symbol.iterator](){return this}}}}function Ar(r){return function(...t){return r==="delete"?!1:this}}function sy(){const r={get(n){return En(this,n)},get size(){return wn(this)},has:Tn,add:Oc,set:Nc,delete:Lc,clear:kc,forEach:An(!1,!1)},t={get(n){return En(this,n,!1,!0)},get size(){return wn(this)},has:Tn,add:Oc,set:Nc,delete:Lc,clear:kc,forEach:An(!1,!0)},e={get(n){return En(this,n,!0)},get size(){return wn(this,!0)},has(n){return Tn.call(this,n,!0)},add:Ar("add"),set:Ar("set"),delete:Ar("delete"),clear:Ar("clear"),forEach:An(!0,!1)},i={get(n){return En(this,n,!0,!0)},get size(){return wn(this,!0)},has(n){return Tn.call(this,n,!0)},add:Ar("add"),set:Ar("set"),delete:Ar("delete"),clear:Ar("clear"),forEach:An(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(n=>{r[n]=Sn(n,!1,!1),e[n]=Sn(n,!0,!1),t[n]=Sn(n,!1,!0),i[n]=Sn(n,!0,!0)}),[r,e,t,i]}const[ny,oy,ay,ly]=sy();function Vh(r,t){const e=t?r?ly:ay:r?oy:ny;return(i,s,n)=>s==="__v_isReactive"?!r:s==="__v_isReadonly"?r:s==="__v_raw"?i:Reflect.get(At(e,s)&&s in i?e:i,s,n)}const hy={get:Vh(!1,!1)},cy={get:Vh(!1,!0)},uy={get:Vh(!0,!1)},Uf=new WeakMap,Gf=new WeakMap,Hf=new WeakMap,dy=new WeakMap;function fy(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function py(r){return r.__v_skip||!Object.isExtensible(r)?0:fy(Og(r))}function Zr(r){return us(r)?r:Xh(r,!1,ey,hy,Uf)}function $f(r){return Xh(r,!1,iy,cy,Gf)}function Vf(r){return Xh(r,!0,ry,uy,Hf)}function Xh(r,t,e,i,s){if(!Pt(r)||r.__v_raw&&!(t&&r.__v_isReactive))return r;const n=s.get(r);if(n)return n;const o=py(r);if(o===0)return r;const a=new Proxy(r,o===2?i:e);return s.set(r,a),a}function $r(r){return us(r)?$r(r.__v_raw):!!(r&&r.__v_isReactive)}function us(r){return!!(r&&r.__v_isReadonly)}function bo(r){return!!(r&&r.__v_isShallow)}function Xf(r){return $r(r)||us(r)}function yt(r){const t=r&&r.__v_raw;return t?yt(t):r}function Ko(r){return _o(r,"__v_skip",!0),r}const sn=r=>Pt(r)?Zr(r):r,zh=r=>Pt(r)?Vf(r):r;function zf(r){Hr&&Be&&(r=yt(r),Of(r.dep||(r.dep=Gh())))}function Wf(r,t){r=yt(r);const e=r.dep;e&&vl(e)}function Gt(r){return!!(r&&r.__v_isRef===!0)}function oe(r){return jf(r,!1)}function my(r){return jf(r,!0)}function jf(r,t){return Gt(r)?r:new gy(r,t)}class gy{constructor(t,e){this.__v_isShallow=e,this.dep=void 0,this.__v_isRef=!0,this._rawValue=e?t:yt(t),this._value=e?t:sn(t)}get value(){return zf(this),this._value}set value(t){const e=this.__v_isShallow||bo(t)||us(t);t=e?t:yt(t),Si(t,this._rawValue)&&(this._rawValue=t,this._value=e?t:sn(t),Wf(this))}}function Ut(r){return Gt(r)?r.value:r}const yy={get:(r,t,e)=>Ut(Reflect.get(r,t,e)),set:(r,t,e,i)=>{const s=r[t];return Gt(s)&&!Gt(e)?(s.value=e,!0):Reflect.set(r,t,e,i)}};function Yf(r){return $r(r)?r:new Proxy(r,yy)}function Zo(r){const t=ht(r)?new Array(r.length):{};for(const e in r)t[e]=vy(r,e);return t}class _y{constructor(t,e,i){this._object=t,this._key=e,this._defaultValue=i,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return Kg(yt(this._object),this._key)}}function vy(r,t,e){const i=r[t];return Gt(i)?i:new _y(r,t,e)}class xy{constructor(t,e,i,s){this._setter=e,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new Hh(t,()=>{this._dirty||(this._dirty=!0,Wf(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=i}get value(){const t=yt(this);return zf(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function by(r,t,e=!1){let i,s;const n=gt(r);return n?(i=r,s=Oe):(i=r.get,s=r.set),new xy(i,s,n||!s,e)}function Vr(r,t,e,i){let s;try{s=i?r(...i):r()}catch(n){Qo(n,t,e)}return s}function we(r,t,e,i){if(gt(r)){const n=Vr(r,t,e,i);return n&&wf(n)&&n.catch(o=>{Qo(o,t,e)}),n}const s=[];for(let n=0;n<r.length;n++)s.push(we(r[n],t,e,i));return s}function Qo(r,t,e,i=!0){const s=t?t.vnode:null;if(t){let n=t.parent;const o=t.proxy,a=e;for(;n;){const h=n.ec;if(h){for(let c=0;c<h.length;c++)if(h[c](r,o,a)===!1)return}n=n.parent}const l=t.appContext.config.errorHandler;if(l){Vr(l,null,10,[r,o,a]);return}}Ey(r,e,s,i)}function Ey(r,t,e,i=!0){console.error(r)}let nn=!1,xl=!1;const ie=[];let Ze=0;const rs=[];let dr=null,fi=0;const qf=Promise.resolve();let Wh=null;function jh(r){const t=Wh||qf;return r?t.then(this?r.bind(this):r):t}function Ty(r){let t=Ze+1,e=ie.length;for(;t<e;){const i=t+e>>>1,s=ie[i],n=on(s);n<r||n===r&&s.pre?t=i+1:e=i}return t}function Yh(r){(!ie.length||!ie.includes(r,nn&&r.allowRecurse?Ze+1:Ze))&&(r.id==null?ie.push(r):ie.splice(Ty(r.id),0,r),Kf())}function Kf(){!nn&&!xl&&(xl=!0,Wh=qf.then(Qf))}function wy(r){const t=ie.indexOf(r);t>Ze&&ie.splice(t,1)}function Ay(r){ht(r)?rs.push(...r):(!dr||!dr.includes(r,r.allowRecurse?fi+1:fi))&&rs.push(r),Kf()}function Uc(r,t=nn?Ze+1:0){for(;t<ie.length;t++){const e=ie[t];e&&e.pre&&(ie.splice(t,1),t--,e())}}function Zf(r){if(rs.length){const t=[...new Set(rs)];if(rs.length=0,dr){dr.push(...t);return}for(dr=t,dr.sort((e,i)=>on(e)-on(i)),fi=0;fi<dr.length;fi++)dr[fi]();dr=null,fi=0}}const on=r=>r.id==null?1/0:r.id,Sy=(r,t)=>{const e=on(r)-on(t);if(e===0){if(r.pre&&!t.pre)return-1;if(t.pre&&!r.pre)return 1}return e};function Qf(r){xl=!1,nn=!0,ie.sort(Sy);const t=Oe;try{for(Ze=0;Ze<ie.length;Ze++){const e=ie[Ze];e&&e.active!==!1&&Vr(e,null,14)}}finally{Ze=0,ie.length=0,Zf(),nn=!1,Wh=null,(ie.length||rs.length)&&Qf()}}function Cy(r,t,...e){if(r.isUnmounted)return;const i=r.vnode.props||Mt;let s=e;const n=t.startsWith("update:"),o=n&&t.slice(7);if(o&&o in i){const c=`${o==="modelValue"?"model":o}Modifiers`,{number:u,trim:d}=i[c]||Mt;d&&(s=e.map(f=>$t(f)?f.trim():f)),u&&(s=e.map(ml))}let a,l=i[a=xa(t)]||i[a=xa(ir(t))];!l&&n&&(l=i[a=xa(xs(t))]),l&&we(l,r,6,s);const h=i[a+"Once"];if(h){if(!r.emitted)r.emitted={};else if(r.emitted[a])return;r.emitted[a]=!0,we(h,r,6,s)}}function Jf(r,t,e=!1){const i=t.emitsCache,s=i.get(r);if(s!==void 0)return s;const n=r.emits;let o={},a=!1;if(!gt(r)){const l=h=>{const c=Jf(h,t,!0);c&&(a=!0,qt(o,c))};!e&&t.mixins.length&&t.mixins.forEach(l),r.extends&&l(r.extends),r.mixins&&r.mixins.forEach(l)}return!n&&!a?(Pt(r)&&i.set(r,null),null):(ht(n)?n.forEach(l=>o[l]=null):qt(o,n),Pt(r)&&i.set(r,o),o)}function Jo(r,t){return!r||!Wo(t)?!1:(t=t.slice(2).replace(/Once$/,""),At(r,t[0].toLowerCase()+t.slice(1))||At(r,xs(t))||At(r,t))}let Jt=null,ta=null;function Eo(r){const t=Jt;return Jt=r,ta=r&&r.type.__scopeId||null,t}function qh(r){ta=r}function Kh(){ta=null}function ea(r,t=Jt,e){if(!t||r._n)return r;const i=(...s)=>{i._d&&Qc(-1);const n=Eo(t);let o;try{o=r(...s)}finally{Eo(n),i._d&&Qc(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function ba(r){const{type:t,vnode:e,proxy:i,withProxy:s,props:n,propsOptions:[o],slots:a,attrs:l,emit:h,render:c,renderCache:u,data:d,setupState:f,ctx:p,inheritAttrs:m}=r;let g,y;const x=Eo(r);try{if(e.shapeFlag&4){const b=s||i;g=je(c.call(b,b,u,n,f,d,p)),y=l}else{const b=t;g=je(b.length>1?b(n,{attrs:l,slots:a,emit:h}):b(n,null)),y=t.props?l:Iy(l)}}catch(b){Ys.length=0,Qo(b,r,1),g=Lt(Ae)}let _=g;if(y&&m!==!1){const b=Object.keys(y),{shapeFlag:S}=_;b.length&&S&7&&(o&&b.some(Oh)&&(y=Py(y,o)),_=jr(_,y))}return e.dirs&&(_=jr(_),_.dirs=_.dirs?_.dirs.concat(e.dirs):e.dirs),e.transition&&(_.transition=e.transition),g=_,Eo(x),g}const Iy=r=>{let t;for(const e in r)(e==="class"||e==="style"||Wo(e))&&((t||(t={}))[e]=r[e]);return t},Py=(r,t)=>{const e={};for(const i in r)(!Oh(i)||!(i.slice(9)in t))&&(e[i]=r[i]);return e};function Ry(r,t,e){const{props:i,children:s,component:n}=r,{props:o,children:a,patchFlag:l}=t,h=n.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return i?Gc(i,o,h):!!o;if(l&8){const c=t.dynamicProps;for(let u=0;u<c.length;u++){const d=c[u];if(o[d]!==i[d]&&!Jo(h,d))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:i===o?!1:i?o?Gc(i,o,h):!0:!!o;return!1}function Gc(r,t,e){const i=Object.keys(t);if(i.length!==Object.keys(r).length)return!0;for(let s=0;s<i.length;s++){const n=i[s];if(t[n]!==r[n]&&!Jo(e,n))return!0}return!1}function My({vnode:r,parent:t},e){for(;t&&t.subTree===r;)(r=t.vnode).el=e,t=t.parent}const tp="components";function By(r,t){return Fy(tp,r,!0,t)||r}const Dy=Symbol.for("v-ndc");function Fy(r,t,e=!0,i=!1){const s=Jt||jt;if(s){const n=s.type;if(r===tp){const a=B_(n,!1);if(a&&(a===t||a===ir(t)||a===Yo(ir(t))))return n}const o=Hc(s[r]||n[r],t)||Hc(s.appContext[r],t);return!o&&i?n:o}}function Hc(r,t){return r&&(r[t]||r[ir(t)]||r[Yo(ir(t))])}const Oy=r=>r.__isSuspense;function Ny(r,t){t&&t.pendingBranch?ht(r)?t.effects.push(...r):t.effects.push(r):Ay(r)}const Cn={};function Xr(r,t,e){return ep(r,t,e)}function ep(r,t,{immediate:e,deep:i,flush:s,onTrack:n,onTrigger:o}=Mt){var a;const l=Mf()===((a=jt)==null?void 0:a.scope)?jt:null;let h,c=!1,u=!1;if(Gt(r)?(h=()=>r.value,c=bo(r)):$r(r)?(h=()=>r,i=!0):ht(r)?(u=!0,c=r.some(b=>$r(b)||bo(b)),h=()=>r.map(b=>{if(Gt(b))return b.value;if($r(b))return xi(b);if(gt(b))return Vr(b,l,2)})):gt(r)?t?h=()=>Vr(r,l,2):h=()=>{if(!(l&&l.isUnmounted))return d&&d(),we(r,l,3,[f])}:h=Oe,t&&i){const b=h;h=()=>xi(b())}let d,f=b=>{d=x.onStop=()=>{Vr(b,l,4)}},p;if(hn)if(f=Oe,t?e&&we(t,l,3,[h(),u?[]:void 0,f]):h(),s==="sync"){const b=O_();p=b.__watcherHandles||(b.__watcherHandles=[])}else return Oe;let m=u?new Array(r.length).fill(Cn):Cn;const g=()=>{if(x.active)if(t){const b=x.run();(i||c||(u?b.some((S,D)=>Si(S,m[D])):Si(b,m)))&&(d&&d(),we(t,l,3,[b,m===Cn?void 0:u&&m[0]===Cn?[]:m,f]),m=b)}else x.run()};g.allowRecurse=!!t;let y;s==="sync"?y=g:s==="post"?y=()=>he(g,l&&l.suspense):(g.pre=!0,l&&(g.id=l.uid),y=()=>Yh(g));const x=new Hh(h,y);t?e?g():m=x.run():s==="post"?he(x.run.bind(x),l&&l.suspense):x.run();const _=()=>{x.stop(),l&&l.scope&&Nh(l.scope.effects,x)};return p&&p.push(_),_}function Ly(r,t,e){const i=this.proxy,s=$t(r)?r.includes(".")?rp(i,r):()=>i[r]:r.bind(i,i);let n;gt(t)?n=t:(n=t.handler,e=t);const o=jt;fs(this);const a=ep(s,n.bind(i),e);return o?fs(o):Ei(),a}function rp(r,t){const e=t.split(".");return()=>{let i=r;for(let s=0;s<e.length&&i;s++)i=i[e[s]];return i}}function xi(r,t){if(!Pt(r)||r.__v_skip||(t=t||new Set,t.has(r)))return r;if(t.add(r),Gt(r))xi(r.value,t);else if(ht(r))for(let e=0;e<r.length;e++)xi(r[e],t);else if(Tf(r)||es(r))r.forEach(e=>{xi(e,t)});else if(Sf(r))for(const e in r)xi(r[e],t);return r}function ds(r,t){const e=Jt;if(e===null)return r;const i=oa(e)||e.proxy,s=r.dirs||(r.dirs=[]);for(let n=0;n<t.length;n++){let[o,a,l,h=Mt]=t[n];o&&(gt(o)&&(o={mounted:o,updated:o}),o.deep&&xi(a),s.push({dir:o,instance:i,value:a,oldValue:void 0,arg:l,modifiers:h}))}return r}function ei(r,t,e,i){const s=r.dirs,n=t&&t.dirs;for(let o=0;o<s.length;o++){const a=s[o];n&&(a.oldValue=n[o].value);let l=a.dir[i];l&&(bs(),we(l,e,8,[r.el,a,r,t]),Es())}}const Dr=Symbol("_leaveCb"),In=Symbol("_enterCb");function ky(){const r={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Zh(()=>{r.isMounted=!0}),ap(()=>{r.isUnmounting=!0}),r}const xe=[Function,Array],ip={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:xe,onEnter:xe,onAfterEnter:xe,onEnterCancelled:xe,onBeforeLeave:xe,onLeave:xe,onAfterLeave:xe,onLeaveCancelled:xe,onBeforeAppear:xe,onAppear:xe,onAfterAppear:xe,onAppearCancelled:xe},Uy={name:"BaseTransition",props:ip,setup(r,{slots:t}){const e=C_(),i=ky();let s;return()=>{const n=t.default&&np(t.default(),!0);if(!n||!n.length)return;let o=n[0];if(n.length>1){for(const m of n)if(m.type!==Ae){o=m;break}}const a=yt(r),{mode:l}=a;if(i.isLeaving)return Ea(o);const h=$c(o);if(!h)return Ea(o);const c=bl(h,a,i,e);El(h,c);const u=e.subTree,d=u&&$c(u);let f=!1;const{getTransitionKey:p}=h.type;if(p){const m=p();s===void 0?s=m:m!==s&&(s=m,f=!0)}if(d&&d.type!==Ae&&(!pi(h,d)||f)){const m=bl(d,a,i,e);if(El(d,m),l==="out-in")return i.isLeaving=!0,m.afterLeave=()=>{i.isLeaving=!1,e.update.active!==!1&&e.update()},Ea(o);l==="in-out"&&h.type!==Ae&&(m.delayLeave=(g,y,x)=>{const _=sp(i,d);_[String(d.key)]=d,g[Dr]=()=>{y(),g[Dr]=void 0,delete c.delayedLeave},c.delayedLeave=x})}return o}}},Gy=Uy;function sp(r,t){const{leavingVNodes:e}=r;let i=e.get(t.type);return i||(i=Object.create(null),e.set(t.type,i)),i}function bl(r,t,e,i){const{appear:s,mode:n,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:h,onEnterCancelled:c,onBeforeLeave:u,onLeave:d,onAfterLeave:f,onLeaveCancelled:p,onBeforeAppear:m,onAppear:g,onAfterAppear:y,onAppearCancelled:x}=t,_=String(r.key),b=sp(e,r),S=(T,I)=>{T&&we(T,i,9,I)},D=(T,I)=>{const F=I[1];S(T,I),ht(T)?T.every(q=>q.length<=1)&&F():T.length<=1&&F()},M={mode:n,persisted:o,beforeEnter(T){let I=a;if(!e.isMounted)if(s)I=m||a;else return;T[Dr]&&T[Dr](!0);const F=b[_];F&&pi(r,F)&&F.el[Dr]&&F.el[Dr](),S(I,[T])},enter(T){let I=l,F=h,q=c;if(!e.isMounted)if(s)I=g||l,F=y||h,q=x||c;else return;let C=!1;const A=T[In]=O=>{C||(C=!0,O?S(q,[T]):S(F,[T]),M.delayedLeave&&M.delayedLeave(),T[In]=void 0)};I?D(I,[T,A]):A()},leave(T,I){const F=String(r.key);if(T[In]&&T[In](!0),e.isUnmounting)return I();S(u,[T]);let q=!1;const C=T[Dr]=A=>{q||(q=!0,I(),A?S(p,[T]):S(f,[T]),T[Dr]=void 0,b[F]===r&&delete b[F])};b[F]=r,d?D(d,[T,C]):C()},clone(T){return bl(T,t,e,i)}};return M}function Ea(r){if(ra(r))return r=jr(r),r.children=null,r}function $c(r){return ra(r)?r.children?r.children[0]:void 0:r}function El(r,t){r.shapeFlag&6&&r.component?El(r.component.subTree,t):r.shapeFlag&128?(r.ssContent.transition=t.clone(r.ssContent),r.ssFallback.transition=t.clone(r.ssFallback)):r.transition=t}function np(r,t=!1,e){let i=[],s=0;for(let n=0;n<r.length;n++){let o=r[n];const a=e==null?o.key:String(e)+String(o.key!=null?o.key:n);o.type===re?(o.patchFlag&128&&s++,i=i.concat(np(o.children,t,a))):(t||o.type!==Ae)&&i.push(a!=null?jr(o,{key:a}):o)}if(s>1)for(let n=0;n<i.length;n++)i[n].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function nr(r,t){return gt(r)?(()=>qt({name:r.name},t,{setup:r}))():r}const zs=r=>!!r.type.__asyncLoader,ra=r=>r.type.__isKeepAlive;function Hy(r,t){op(r,"a",t)}function $y(r,t){op(r,"da",t)}function op(r,t,e=jt){const i=r.__wdc||(r.__wdc=()=>{let s=e;for(;s;){if(s.isDeactivated)return;s=s.parent}return r()});if(ia(t,i,e),e){let s=e.parent;for(;s&&s.parent;)ra(s.parent.vnode)&&Vy(i,t,e,s),s=s.parent}}function Vy(r,t,e,i){const s=ia(t,r,i,!0);lp(()=>{Nh(i[t],s)},e)}function ia(r,t,e=jt,i=!1){if(e){const s=e[r]||(e[r]=[]),n=t.__weh||(t.__weh=(...o)=>{if(e.isUnmounted)return;bs(),fs(e);const a=we(t,e,r,o);return Ei(),Es(),a});return i?s.unshift(n):s.push(n),n}}const wr=r=>(t,e=jt)=>(!hn||r==="sp")&&ia(r,(...i)=>t(...i),e),Xy=wr("bm"),Zh=wr("m"),zy=wr("bu"),Wy=wr("u"),ap=wr("bum"),lp=wr("um"),jy=wr("sp"),Yy=wr("rtg"),qy=wr("rtc");function Ky(r,t=jt){ia("ec",r,t)}function Tl(r,t,e,i){let s;const n=e&&e[i];if(ht(r)||$t(r)){s=new Array(r.length);for(let o=0,a=r.length;o<a;o++)s[o]=t(r[o],o,void 0,n&&n[o])}else if(typeof r=="number"){s=new Array(r);for(let o=0;o<r;o++)s[o]=t(o+1,o,void 0,n&&n[o])}else if(Pt(r))if(r[Symbol.iterator])s=Array.from(r,(o,a)=>t(o,a,void 0,n&&n[a]));else{const o=Object.keys(r);s=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const h=o[a];s[a]=t(r[h],h,a,n&&n[a])}}else s=[];return e&&(e[i]=s),s}function Zy(r,t,e={},i,s){if(Jt.isCE||Jt.parent&&zs(Jt.parent)&&Jt.parent.isCE)return t!=="default"&&(e.name=t),Lt("slot",e,i&&i());let n=r[t];n&&n._c&&(n._d=!1),Wt();const o=n&&hp(n(e)),a=Ts(re,{key:e.key||o&&o.key||`_${t}`},o||(i?i():[]),o&&r._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),n&&n._c&&(n._d=!0),a}function hp(r){return r.some(t=>wo(t)?!(t.type===Ae||t.type===re&&!hp(t.children)):!0)?r:null}const wl=r=>r?bp(r)?oa(r)||r.proxy:wl(r.parent):null,Ws=qt(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>wl(r.parent),$root:r=>wl(r.root),$emit:r=>r.emit,$options:r=>Qh(r),$forceUpdate:r=>r.f||(r.f=()=>Yh(r.update)),$nextTick:r=>r.n||(r.n=jh.bind(r.proxy)),$watch:r=>Ly.bind(r)}),Ta=(r,t)=>r!==Mt&&!r.__isScriptSetup&&At(r,t),Qy={get({_:r},t){const{ctx:e,setupState:i,data:s,props:n,accessCache:o,type:a,appContext:l}=r;let h;if(t[0]!=="$"){const f=o[t];if(f!==void 0)switch(f){case 1:return i[t];case 2:return s[t];case 4:return e[t];case 3:return n[t]}else{if(Ta(i,t))return o[t]=1,i[t];if(s!==Mt&&At(s,t))return o[t]=2,s[t];if((h=r.propsOptions[0])&&At(h,t))return o[t]=3,n[t];if(e!==Mt&&At(e,t))return o[t]=4,e[t];Al&&(o[t]=0)}}const c=Ws[t];let u,d;if(c)return t==="$attrs"&&fe(r,"get",t),c(r);if((u=a.__cssModules)&&(u=u[t]))return u;if(e!==Mt&&At(e,t))return o[t]=4,e[t];if(d=l.config.globalProperties,At(d,t))return d[t]},set({_:r},t,e){const{data:i,setupState:s,ctx:n}=r;return Ta(s,t)?(s[t]=e,!0):i!==Mt&&At(i,t)?(i[t]=e,!0):At(r.props,t)||t[0]==="$"&&t.slice(1)in r?!1:(n[t]=e,!0)},has({_:{data:r,setupState:t,accessCache:e,ctx:i,appContext:s,propsOptions:n}},o){let a;return!!e[o]||r!==Mt&&At(r,o)||Ta(t,o)||(a=n[0])&&At(a,o)||At(i,o)||At(Ws,o)||At(s.config.globalProperties,o)},defineProperty(r,t,e){return e.get!=null?r._.accessCache[t]=0:At(e,"value")&&this.set(r,t,e.value,null),Reflect.defineProperty(r,t,e)}};function Vc(r){return ht(r)?r.reduce((t,e)=>(t[e]=null,t),{}):r}let Al=!0;function Jy(r){const t=Qh(r),e=r.proxy,i=r.ctx;Al=!1,t.beforeCreate&&Xc(t.beforeCreate,r,"bc");const{data:s,computed:n,methods:o,watch:a,provide:l,inject:h,created:c,beforeMount:u,mounted:d,beforeUpdate:f,updated:p,activated:m,deactivated:g,beforeDestroy:y,beforeUnmount:x,destroyed:_,unmounted:b,render:S,renderTracked:D,renderTriggered:M,errorCaptured:T,serverPrefetch:I,expose:F,inheritAttrs:q,components:C,directives:A,filters:O}=t;if(h&&t_(h,i,null),o)for(const z in o){const K=o[z];gt(K)&&(i[z]=K.bind(e))}if(s){const z=s.call(e,e);Pt(z)&&(r.data=Zr(z))}if(Al=!0,n)for(const z in n){const K=n[z],St=gt(K)?K.bind(e,e):gt(K.get)?K.get.bind(e,e):Oe,H=!gt(K)&&gt(K.set)?K.set.bind(e):Oe,G=ue({get:St,set:H});Object.defineProperty(i,z,{enumerable:!0,configurable:!0,get:()=>G.value,set:ut=>G.value=ut})}if(a)for(const z in a)cp(a[z],i,e,z);if(l){const z=gt(l)?l.call(e):l;Reflect.ownKeys(z).forEach(K=>{so(K,z[K])})}c&&Xc(c,r,"c");function X(z,K){ht(K)?K.forEach(St=>z(St.bind(e))):K&&z(K.bind(e))}if(X(Xy,u),X(Zh,d),X(zy,f),X(Wy,p),X(Hy,m),X($y,g),X(Ky,T),X(qy,D),X(Yy,M),X(ap,x),X(lp,b),X(jy,I),ht(F))if(F.length){const z=r.exposed||(r.exposed={});F.forEach(K=>{Object.defineProperty(z,K,{get:()=>e[K],set:St=>e[K]=St})})}else r.exposed||(r.exposed={});S&&r.render===Oe&&(r.render=S),q!=null&&(r.inheritAttrs=q),C&&(r.components=C),A&&(r.directives=A)}function t_(r,t,e=Oe){ht(r)&&(r=Sl(r));for(const i in r){const s=r[i];let n;Pt(s)?"default"in s?n=tr(s.from||i,s.default,!0):n=tr(s.from||i):n=tr(s),Gt(n)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>n.value,set:o=>n.value=o}):t[i]=n}}function Xc(r,t,e){we(ht(r)?r.map(i=>i.bind(t.proxy)):r.bind(t.proxy),t,e)}function cp(r,t,e,i){const s=i.includes(".")?rp(e,i):()=>e[i];if($t(r)){const n=t[r];gt(n)&&Xr(s,n)}else if(gt(r))Xr(s,r.bind(e));else if(Pt(r))if(ht(r))r.forEach(n=>cp(n,t,e,i));else{const n=gt(r.handler)?r.handler.bind(e):t[r.handler];gt(n)&&Xr(s,n,r)}}function Qh(r){const t=r.type,{mixins:e,extends:i}=t,{mixins:s,optionsCache:n,config:{optionMergeStrategies:o}}=r.appContext,a=n.get(t);let l;return a?l=a:!s.length&&!e&&!i?l=t:(l={},s.length&&s.forEach(h=>To(l,h,o,!0)),To(l,t,o)),Pt(t)&&n.set(t,l),l}function To(r,t,e,i=!1){const{mixins:s,extends:n}=t;n&&To(r,n,e,!0),s&&s.forEach(o=>To(r,o,e,!0));for(const o in t)if(!(i&&o==="expose")){const a=e_[o]||e&&e[o];r[o]=a?a(r[o],t[o]):t[o]}return r}const e_={data:zc,props:Wc,emits:Wc,methods:Ls,computed:Ls,beforeCreate:ne,created:ne,beforeMount:ne,mounted:ne,beforeUpdate:ne,updated:ne,beforeDestroy:ne,beforeUnmount:ne,destroyed:ne,unmounted:ne,activated:ne,deactivated:ne,errorCaptured:ne,serverPrefetch:ne,components:Ls,directives:Ls,watch:i_,provide:zc,inject:r_};function zc(r,t){return t?r?function(){return qt(gt(r)?r.call(this,this):r,gt(t)?t.call(this,this):t)}:t:r}function r_(r,t){return Ls(Sl(r),Sl(t))}function Sl(r){if(ht(r)){const t={};for(let e=0;e<r.length;e++)t[r[e]]=r[e];return t}return r}function ne(r,t){return r?[...new Set([].concat(r,t))]:t}function Ls(r,t){return r?qt(Object.create(null),r,t):t}function Wc(r,t){return r?ht(r)&&ht(t)?[...new Set([...r,...t])]:qt(Object.create(null),Vc(r),Vc(t??{})):t}function i_(r,t){if(!r)return t;if(!t)return r;const e=qt(Object.create(null),r);for(const i in t)e[i]=ne(r[i],t[i]);return e}function up(){return{app:null,config:{isNativeTag:Bg,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let s_=0;function n_(r,t){return function(i,s=null){gt(i)||(i=qt({},i)),s!=null&&!Pt(s)&&(s=null);const n=up(),o=new WeakSet;let a=!1;const l=n.app={_uid:s_++,_component:i,_props:s,_container:null,_context:n,_instance:null,version:N_,get config(){return n.config},set config(h){},use(h,...c){return o.has(h)||(h&&gt(h.install)?(o.add(h),h.install(l,...c)):gt(h)&&(o.add(h),h(l,...c))),l},mixin(h){return n.mixins.includes(h)||n.mixins.push(h),l},component(h,c){return c?(n.components[h]=c,l):n.components[h]},directive(h,c){return c?(n.directives[h]=c,l):n.directives[h]},mount(h,c,u){if(!a){const d=Lt(i,s);return d.appContext=n,c&&t?t(d,h):r(d,h,u),a=!0,l._container=h,h.__vue_app__=l,oa(d.component)||d.component.proxy}},unmount(){a&&(r(null,l._container),delete l._container.__vue_app__)},provide(h,c){return n.provides[h]=c,l},runWithContext(h){an=l;try{return h()}finally{an=null}}};return l}}let an=null;function so(r,t){if(jt){let e=jt.provides;const i=jt.parent&&jt.parent.provides;i===e&&(e=jt.provides=Object.create(i)),e[r]=t}}function tr(r,t,e=!1){const i=jt||Jt;if(i||an){const s=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:an._context.provides;if(s&&r in s)return s[r];if(arguments.length>1)return e&&gt(t)?t.call(i&&i.proxy):t}}function o_(){return!!(jt||Jt||an)}function a_(r,t,e,i=!1){const s={},n={};_o(n,na,1),r.propsDefaults=Object.create(null),dp(r,t,s,n);for(const o in r.propsOptions[0])o in s||(s[o]=void 0);e?r.props=i?s:$f(s):r.type.props?r.props=s:r.props=n,r.attrs=n}function l_(r,t,e,i){const{props:s,attrs:n,vnode:{patchFlag:o}}=r,a=yt(s),[l]=r.propsOptions;let h=!1;if((i||o>0)&&!(o&16)){if(o&8){const c=r.vnode.dynamicProps;for(let u=0;u<c.length;u++){let d=c[u];if(Jo(r.emitsOptions,d))continue;const f=t[d];if(l)if(At(n,d))f!==n[d]&&(n[d]=f,h=!0);else{const p=ir(d);s[p]=Cl(l,a,p,f,r,!1)}else f!==n[d]&&(n[d]=f,h=!0)}}}else{dp(r,t,s,n)&&(h=!0);let c;for(const u in a)(!t||!At(t,u)&&((c=xs(u))===u||!At(t,c)))&&(l?e&&(e[u]!==void 0||e[c]!==void 0)&&(s[u]=Cl(l,a,u,void 0,r,!0)):delete s[u]);if(n!==a)for(const u in n)(!t||!At(t,u))&&(delete n[u],h=!0)}h&&vr(r,"set","$attrs")}function dp(r,t,e,i){const[s,n]=r.propsOptions;let o=!1,a;if(t)for(let l in t){if(ro(l))continue;const h=t[l];let c;s&&At(s,c=ir(l))?!n||!n.includes(c)?e[c]=h:(a||(a={}))[c]=h:Jo(r.emitsOptions,l)||(!(l in i)||h!==i[l])&&(i[l]=h,o=!0)}if(n){const l=yt(e),h=a||Mt;for(let c=0;c<n.length;c++){const u=n[c];e[u]=Cl(s,l,u,h[u],r,!At(h,u))}}return o}function Cl(r,t,e,i,s,n){const o=r[e];if(o!=null){const a=At(o,"default");if(a&&i===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&gt(l)){const{propsDefaults:h}=s;e in h?i=h[e]:(fs(s),i=h[e]=l.call(null,t),Ei())}else i=l}o[0]&&(n&&!a?i=!1:o[1]&&(i===""||i===xs(e))&&(i=!0))}return i}function fp(r,t,e=!1){const i=t.propsCache,s=i.get(r);if(s)return s;const n=r.props,o={},a=[];let l=!1;if(!gt(r)){const c=u=>{l=!0;const[d,f]=fp(u,t,!0);qt(o,d),f&&a.push(...f)};!e&&t.mixins.length&&t.mixins.forEach(c),r.extends&&c(r.extends),r.mixins&&r.mixins.forEach(c)}if(!n&&!l)return Pt(r)&&i.set(r,ts),ts;if(ht(n))for(let c=0;c<n.length;c++){const u=ir(n[c]);jc(u)&&(o[u]=Mt)}else if(n)for(const c in n){const u=ir(c);if(jc(u)){const d=n[c],f=o[u]=ht(d)||gt(d)?{type:d}:qt({},d);if(f){const p=Kc(Boolean,f.type),m=Kc(String,f.type);f[0]=p>-1,f[1]=m<0||p<m,(p>-1||At(f,"default"))&&a.push(u)}}}const h=[o,a];return Pt(r)&&i.set(r,h),h}function jc(r){return r[0]!=="$"}function Yc(r){const t=r&&r.toString().match(/^\s*(function|class) (\w+)/);return t?t[2]:r===null?"null":""}function qc(r,t){return Yc(r)===Yc(t)}function Kc(r,t){return ht(t)?t.findIndex(e=>qc(e,r)):gt(t)&&qc(t,r)?0:-1}const pp=r=>r[0]==="_"||r==="$stable",Jh=r=>ht(r)?r.map(je):[je(r)],h_=(r,t,e)=>{if(t._n)return t;const i=ea((...s)=>Jh(t(...s)),e);return i._c=!1,i},mp=(r,t,e)=>{const i=r._ctx;for(const s in r){if(pp(s))continue;const n=r[s];if(gt(n))t[s]=h_(s,n,i);else if(n!=null){const o=Jh(n);t[s]=()=>o}}},gp=(r,t)=>{const e=Jh(t);r.slots.default=()=>e},c_=(r,t)=>{if(r.vnode.shapeFlag&32){const e=t._;e?(r.slots=yt(t),_o(t,"_",e)):mp(t,r.slots={})}else r.slots={},t&&gp(r,t);_o(r.slots,na,1)},u_=(r,t,e)=>{const{vnode:i,slots:s}=r;let n=!0,o=Mt;if(i.shapeFlag&32){const a=t._;a?e&&a===1?n=!1:(qt(s,t),!e&&a===1&&delete s._):(n=!t.$stable,mp(t,s)),o=t}else t&&(gp(r,t),o={default:1});if(n)for(const a in s)!pp(a)&&o[a]==null&&delete s[a]};function Il(r,t,e,i,s=!1){if(ht(r)){r.forEach((d,f)=>Il(d,t&&(ht(t)?t[f]:t),e,i,s));return}if(zs(i)&&!s)return;const n=i.shapeFlag&4?oa(i.component)||i.component.proxy:i.el,o=s?null:n,{i:a,r:l}=r,h=t&&t.r,c=a.refs===Mt?a.refs={}:a.refs,u=a.setupState;if(h!=null&&h!==l&&($t(h)?(c[h]=null,At(u,h)&&(u[h]=null)):Gt(h)&&(h.value=null)),gt(l))Vr(l,a,12,[o,c]);else{const d=$t(l),f=Gt(l);if(d||f){const p=()=>{if(r.f){const m=d?At(u,l)?u[l]:c[l]:l.value;s?ht(m)&&Nh(m,n):ht(m)?m.includes(n)||m.push(n):d?(c[l]=[n],At(u,l)&&(u[l]=c[l])):(l.value=[n],r.k&&(c[r.k]=l.value))}else d?(c[l]=o,At(u,l)&&(u[l]=o)):f&&(l.value=o,r.k&&(c[r.k]=o))};o?(p.id=-1,he(p,e)):p()}}}const he=Ny;function d_(r){return f_(r)}function f_(r,t){const e=gl();e.__VUE__=!0;const{insert:i,remove:s,patchProp:n,createElement:o,createText:a,createComment:l,setText:h,setElementText:c,parentNode:u,nextSibling:d,setScopeId:f=Oe,insertStaticContent:p}=r,m=(v,E,w,P=null,B=null,N=null,j=!1,$=null,W=!!E.dynamicChildren)=>{if(v===E)return;v&&!pi(v,E)&&(P=R(v),ut(v,B,N,!0),v=null),E.patchFlag===-2&&(W=!1,E.dynamicChildren=null);const{type:L,ref:at,shapeFlag:it}=E;switch(L){case sa:g(v,E,w,P);break;case Ae:y(v,E,w,P);break;case wa:v==null&&x(E,w,P,j);break;case re:C(v,E,w,P,B,N,j,$,W);break;default:it&1?S(v,E,w,P,B,N,j,$,W):it&6?A(v,E,w,P,B,N,j,$,W):(it&64||it&128)&&L.process(v,E,w,P,B,N,j,$,W,k)}at!=null&&B&&Il(at,v&&v.ref,N,E||v,!E)},g=(v,E,w,P)=>{if(v==null)i(E.el=a(E.children),w,P);else{const B=E.el=v.el;E.children!==v.children&&h(B,E.children)}},y=(v,E,w,P)=>{v==null?i(E.el=l(E.children||""),w,P):E.el=v.el},x=(v,E,w,P)=>{[v.el,v.anchor]=p(v.children,E,w,P,v.el,v.anchor)},_=({el:v,anchor:E},w,P)=>{let B;for(;v&&v!==E;)B=d(v),i(v,w,P),v=B;i(E,w,P)},b=({el:v,anchor:E})=>{let w;for(;v&&v!==E;)w=d(v),s(v),v=w;s(E)},S=(v,E,w,P,B,N,j,$,W)=>{j=j||E.type==="svg",v==null?D(E,w,P,B,N,j,$,W):I(v,E,B,N,j,$,W)},D=(v,E,w,P,B,N,j,$)=>{let W,L;const{type:at,props:it,shapeFlag:lt,transition:dt,dirs:xt}=v;if(W=v.el=o(v.type,N,it&&it.is,it),lt&8?c(W,v.children):lt&16&&T(v.children,W,null,P,B,N&&at!=="foreignObject",j,$),xt&&ei(v,null,P,"created"),M(W,v,v.scopeId,j,P),it){for(const It in it)It!=="value"&&!ro(It)&&n(W,It,null,it[It],N,v.children,P,B,_t);"value"in it&&n(W,"value",null,it.value),(L=it.onVnodeBeforeMount)&&He(L,P,v)}xt&&ei(v,null,P,"beforeMount");const Rt=p_(B,dt);Rt&&dt.beforeEnter(W),i(W,E,w),((L=it&&it.onVnodeMounted)||Rt||xt)&&he(()=>{L&&He(L,P,v),Rt&&dt.enter(W),xt&&ei(v,null,P,"mounted")},B)},M=(v,E,w,P,B)=>{if(w&&f(v,w),P)for(let N=0;N<P.length;N++)f(v,P[N]);if(B){let N=B.subTree;if(E===N){const j=B.vnode;M(v,j,j.scopeId,j.slotScopeIds,B.parent)}}},T=(v,E,w,P,B,N,j,$,W=0)=>{for(let L=W;L<v.length;L++){const at=v[L]=$?Fr(v[L]):je(v[L]);m(null,at,E,w,P,B,N,j,$)}},I=(v,E,w,P,B,N,j)=>{const $=E.el=v.el;let{patchFlag:W,dynamicChildren:L,dirs:at}=E;W|=v.patchFlag&16;const it=v.props||Mt,lt=E.props||Mt;let dt;w&&ri(w,!1),(dt=lt.onVnodeBeforeUpdate)&&He(dt,w,E,v),at&&ei(E,v,w,"beforeUpdate"),w&&ri(w,!0);const xt=B&&E.type!=="foreignObject";if(L?F(v.dynamicChildren,L,$,w,P,xt,N):j||K(v,E,$,null,w,P,xt,N,!1),W>0){if(W&16)q($,E,it,lt,w,P,B);else if(W&2&&it.class!==lt.class&&n($,"class",null,lt.class,B),W&4&&n($,"style",it.style,lt.style,B),W&8){const Rt=E.dynamicProps;for(let It=0;It<Rt.length;It++){const Vt=Rt[It],Se=it[Vt],Fi=lt[Vt];(Fi!==Se||Vt==="value")&&n($,Vt,Se,Fi,B,v.children,w,P,_t)}}W&1&&v.children!==E.children&&c($,E.children)}else!j&&L==null&&q($,E,it,lt,w,P,B);((dt=lt.onVnodeUpdated)||at)&&he(()=>{dt&&He(dt,w,E,v),at&&ei(E,v,w,"updated")},P)},F=(v,E,w,P,B,N,j)=>{for(let $=0;$<E.length;$++){const W=v[$],L=E[$],at=W.el&&(W.type===re||!pi(W,L)||W.shapeFlag&70)?u(W.el):w;m(W,L,at,null,P,B,N,j,!0)}},q=(v,E,w,P,B,N,j)=>{if(w!==P){if(w!==Mt)for(const $ in w)!ro($)&&!($ in P)&&n(v,$,w[$],null,j,E.children,B,N,_t);for(const $ in P){if(ro($))continue;const W=P[$],L=w[$];W!==L&&$!=="value"&&n(v,$,L,W,j,E.children,B,N,_t)}"value"in P&&n(v,"value",w.value,P.value)}},C=(v,E,w,P,B,N,j,$,W)=>{const L=E.el=v?v.el:a(""),at=E.anchor=v?v.anchor:a("");let{patchFlag:it,dynamicChildren:lt,slotScopeIds:dt}=E;dt&&($=$?$.concat(dt):dt),v==null?(i(L,w,P),i(at,w,P),T(E.children,w,at,B,N,j,$,W)):it>0&&it&64&&lt&&v.dynamicChildren?(F(v.dynamicChildren,lt,w,B,N,j,$),(E.key!=null||B&&E===B.subTree)&&tc(v,E,!0)):K(v,E,w,at,B,N,j,$,W)},A=(v,E,w,P,B,N,j,$,W)=>{E.slotScopeIds=$,v==null?E.shapeFlag&512?B.ctx.activate(E,w,P,j,W):O(E,w,P,B,N,j,W):Q(v,E,W)},O=(v,E,w,P,B,N,j)=>{const $=v.component=S_(v,P,B);if(ra(v)&&($.ctx.renderer=k),I_($),$.asyncDep){if(B&&B.registerDep($,X),!v.el){const W=$.subTree=Lt(Ae);y(null,W,E,w)}return}X($,v,E,w,B,N,j)},Q=(v,E,w)=>{const P=E.component=v.component;if(Ry(v,E,w))if(P.asyncDep&&!P.asyncResolved){z(P,E,w);return}else P.next=E,wy(P.update),P.update();else E.el=v.el,P.vnode=E},X=(v,E,w,P,B,N,j)=>{const $=()=>{if(v.isMounted){let{next:at,bu:it,u:lt,parent:dt,vnode:xt}=v,Rt=at,It;ri(v,!1),at?(at.el=xt.el,z(v,at,j)):at=xt,it&&io(it),(It=at.props&&at.props.onVnodeBeforeUpdate)&&He(It,dt,at,xt),ri(v,!0);const Vt=ba(v),Se=v.subTree;v.subTree=Vt,m(Se,Vt,u(Se.el),R(Se),v,B,N),at.el=Vt.el,Rt===null&&My(v,Vt.el),lt&&he(lt,B),(It=at.props&&at.props.onVnodeUpdated)&&he(()=>He(It,dt,at,xt),B)}else{let at;const{el:it,props:lt}=E,{bm:dt,m:xt,parent:Rt}=v,It=zs(E);if(ri(v,!1),dt&&io(dt),!It&&(at=lt&&lt.onVnodeBeforeMount)&&He(at,Rt,E),ri(v,!0),it&&ot){const Vt=()=>{v.subTree=ba(v),ot(it,v.subTree,v,B,null)};It?E.type.__asyncLoader().then(()=>!v.isUnmounted&&Vt()):Vt()}else{const Vt=v.subTree=ba(v);m(null,Vt,w,P,v,B,N),E.el=Vt.el}if(xt&&he(xt,B),!It&&(at=lt&&lt.onVnodeMounted)){const Vt=E;he(()=>He(at,Rt,Vt),B)}(E.shapeFlag&256||Rt&&zs(Rt.vnode)&&Rt.vnode.shapeFlag&256)&&v.a&&he(v.a,B),v.isMounted=!0,E=w=P=null}},W=v.effect=new Hh($,()=>Yh(L),v.scope),L=v.update=()=>W.run();L.id=v.uid,ri(v,!0),L()},z=(v,E,w)=>{E.component=v;const P=v.vnode.props;v.vnode=E,v.next=null,l_(v,E.props,P,w),u_(v,E.children,w),bs(),Uc(),Es()},K=(v,E,w,P,B,N,j,$,W=!1)=>{const L=v&&v.children,at=v?v.shapeFlag:0,it=E.children,{patchFlag:lt,shapeFlag:dt}=E;if(lt>0){if(lt&128){H(L,it,w,P,B,N,j,$,W);return}else if(lt&256){St(L,it,w,P,B,N,j,$,W);return}}dt&8?(at&16&&_t(L,B,N),it!==L&&c(w,it)):at&16?dt&16?H(L,it,w,P,B,N,j,$,W):_t(L,B,N,!0):(at&8&&c(w,""),dt&16&&T(it,w,P,B,N,j,$,W))},St=(v,E,w,P,B,N,j,$,W)=>{v=v||ts,E=E||ts;const L=v.length,at=E.length,it=Math.min(L,at);let lt;for(lt=0;lt<it;lt++){const dt=E[lt]=W?Fr(E[lt]):je(E[lt]);m(v[lt],dt,w,null,B,N,j,$,W)}L>at?_t(v,B,N,!0,!1,it):T(E,w,P,B,N,j,$,W,it)},H=(v,E,w,P,B,N,j,$,W)=>{let L=0;const at=E.length;let it=v.length-1,lt=at-1;for(;L<=it&&L<=lt;){const dt=v[L],xt=E[L]=W?Fr(E[L]):je(E[L]);if(pi(dt,xt))m(dt,xt,w,null,B,N,j,$,W);else break;L++}for(;L<=it&&L<=lt;){const dt=v[it],xt=E[lt]=W?Fr(E[lt]):je(E[lt]);if(pi(dt,xt))m(dt,xt,w,null,B,N,j,$,W);else break;it--,lt--}if(L>it){if(L<=lt){const dt=lt+1,xt=dt<at?E[dt].el:P;for(;L<=lt;)m(null,E[L]=W?Fr(E[L]):je(E[L]),w,xt,B,N,j,$,W),L++}}else if(L>lt)for(;L<=it;)ut(v[L],B,N,!0),L++;else{const dt=L,xt=L,Rt=new Map;for(L=xt;L<=lt;L++){const pe=E[L]=W?Fr(E[L]):je(E[L]);pe.key!=null&&Rt.set(pe.key,L)}let It,Vt=0;const Se=lt-xt+1;let Fi=!1,Cc=0;const Cs=new Array(Se);for(L=0;L<Se;L++)Cs[L]=0;for(L=dt;L<=it;L++){const pe=v[L];if(Vt>=Se){ut(pe,B,N,!0);continue}let Ge;if(pe.key!=null)Ge=Rt.get(pe.key);else for(It=xt;It<=lt;It++)if(Cs[It-xt]===0&&pi(pe,E[It])){Ge=It;break}Ge===void 0?ut(pe,B,N,!0):(Cs[Ge-xt]=L+1,Ge>=Cc?Cc=Ge:Fi=!0,m(pe,E[Ge],w,null,B,N,j,$,W),Vt++)}const Ic=Fi?m_(Cs):ts;for(It=Ic.length-1,L=Se-1;L>=0;L--){const pe=xt+L,Ge=E[pe],Pc=pe+1<at?E[pe+1].el:P;Cs[L]===0?m(null,Ge,w,Pc,B,N,j,$,W):Fi&&(It<0||L!==Ic[It]?G(Ge,w,Pc,2):It--)}}},G=(v,E,w,P,B=null)=>{const{el:N,type:j,transition:$,children:W,shapeFlag:L}=v;if(L&6){G(v.component.subTree,E,w,P);return}if(L&128){v.suspense.move(E,w,P);return}if(L&64){j.move(v,E,w,k);return}if(j===re){i(N,E,w);for(let it=0;it<W.length;it++)G(W[it],E,w,P);i(v.anchor,E,w);return}if(j===wa){_(v,E,w);return}if(P!==2&&L&1&&$)if(P===0)$.beforeEnter(N),i(N,E,w),he(()=>$.enter(N),B);else{const{leave:it,delayLeave:lt,afterLeave:dt}=$,xt=()=>i(N,E,w),Rt=()=>{it(N,()=>{xt(),dt&&dt()})};lt?lt(N,xt,Rt):Rt()}else i(N,E,w)},ut=(v,E,w,P=!1,B=!1)=>{const{type:N,props:j,ref:$,children:W,dynamicChildren:L,shapeFlag:at,patchFlag:it,dirs:lt}=v;if($!=null&&Il($,null,w,v,!0),at&256){E.ctx.deactivate(v);return}const dt=at&1&&lt,xt=!zs(v);let Rt;if(xt&&(Rt=j&&j.onVnodeBeforeUnmount)&&He(Rt,E,v),at&6)Ft(v.component,w,P);else{if(at&128){v.suspense.unmount(w,P);return}dt&&ei(v,null,E,"beforeUnmount"),at&64?v.type.remove(v,E,w,B,k,P):L&&(N!==re||it>0&&it&64)?_t(L,E,w,!1,!0):(N===re&&it&384||!B&&at&16)&&_t(W,E,w),P&&Et(v)}(xt&&(Rt=j&&j.onVnodeUnmounted)||dt)&&he(()=>{Rt&&He(Rt,E,v),dt&&ei(v,null,E,"unmounted")},w)},Et=v=>{const{type:E,el:w,anchor:P,transition:B}=v;if(E===re){Tt(w,P);return}if(E===wa){b(v);return}const N=()=>{s(w),B&&!B.persisted&&B.afterLeave&&B.afterLeave()};if(v.shapeFlag&1&&B&&!B.persisted){const{leave:j,delayLeave:$}=B,W=()=>j(w,N);$?$(v.el,N,W):W()}else N()},Tt=(v,E)=>{let w;for(;v!==E;)w=d(v),s(v),v=w;s(E)},Ft=(v,E,w)=>{const{bum:P,scope:B,update:N,subTree:j,um:$}=v;P&&io(P),B.stop(),N&&(N.active=!1,ut(j,v,E,w)),$&&he($,E),he(()=>{v.isUnmounted=!0},E),E&&E.pendingBranch&&!E.isUnmounted&&v.asyncDep&&!v.asyncResolved&&v.suspenseId===E.pendingId&&(E.deps--,E.deps===0&&E.resolve())},_t=(v,E,w,P=!1,B=!1,N=0)=>{for(let j=N;j<v.length;j++)ut(v[j],E,w,P,B)},R=v=>v.shapeFlag&6?R(v.component.subTree):v.shapeFlag&128?v.suspense.next():d(v.anchor||v.el),V=(v,E,w)=>{v==null?E._vnode&&ut(E._vnode,null,null,!0):m(E._vnode||null,v,E,null,null,null,w),Uc(),Zf(),E._vnode=v},k={p:m,um:ut,m:G,r:Et,mt:O,mc:T,pc:K,pbc:F,n:R,o:r};let Z,ot;return t&&([Z,ot]=t(k)),{render:V,hydrate:Z,createApp:n_(V,Z)}}function ri({effect:r,update:t},e){r.allowRecurse=t.allowRecurse=e}function p_(r,t){return(!r||r&&!r.pendingBranch)&&t&&!t.persisted}function tc(r,t,e=!1){const i=r.children,s=t.children;if(ht(i)&&ht(s))for(let n=0;n<i.length;n++){const o=i[n];let a=s[n];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[n]=Fr(s[n]),a.el=o.el),e||tc(o,a)),a.type===sa&&(a.el=o.el)}}function m_(r){const t=r.slice(),e=[0];let i,s,n,o,a;const l=r.length;for(i=0;i<l;i++){const h=r[i];if(h!==0){if(s=e[e.length-1],r[s]<h){t[i]=s,e.push(i);continue}for(n=0,o=e.length-1;n<o;)a=n+o>>1,r[e[a]]<h?n=a+1:o=a;h<r[e[n]]&&(n>0&&(t[i]=e[n-1]),e[n]=i)}}for(n=e.length,o=e[n-1];n-- >0;)e[n]=o,o=t[o];return e}const g_=r=>r.__isTeleport,js=r=>r&&(r.disabled||r.disabled===""),Zc=r=>typeof SVGElement<"u"&&r instanceof SVGElement,Pl=(r,t)=>{const e=r&&r.to;return $t(e)?t?t(e):null:e},y_={__isTeleport:!0,process(r,t,e,i,s,n,o,a,l,h){const{mc:c,pc:u,pbc:d,o:{insert:f,querySelector:p,createText:m,createComment:g}}=h,y=js(t.props);let{shapeFlag:x,children:_,dynamicChildren:b}=t;if(r==null){const S=t.el=m(""),D=t.anchor=m("");f(S,e,i),f(D,e,i);const M=t.target=Pl(t.props,p),T=t.targetAnchor=m("");M&&(f(T,M),o=o||Zc(M));const I=(F,q)=>{x&16&&c(_,F,q,s,n,o,a,l)};y?I(e,D):M&&I(M,T)}else{t.el=r.el;const S=t.anchor=r.anchor,D=t.target=r.target,M=t.targetAnchor=r.targetAnchor,T=js(r.props),I=T?e:D,F=T?S:M;if(o=o||Zc(D),b?(d(r.dynamicChildren,b,I,s,n,o,a),tc(r,t,!0)):l||u(r,t,I,F,s,n,o,a,!1),y)T?t.props&&r.props&&t.props.to!==r.props.to&&(t.props.to=r.props.to):Pn(t,e,S,h,1);else if((t.props&&t.props.to)!==(r.props&&r.props.to)){const q=t.target=Pl(t.props,p);q&&Pn(t,q,null,h,0)}else T&&Pn(t,D,M,h,1)}yp(t)},remove(r,t,e,i,{um:s,o:{remove:n}},o){const{shapeFlag:a,children:l,anchor:h,targetAnchor:c,target:u,props:d}=r;if(u&&n(c),o&&n(h),a&16){const f=o||!js(d);for(let p=0;p<l.length;p++){const m=l[p];s(m,t,e,f,!!m.dynamicChildren)}}},move:Pn,hydrate:__};function Pn(r,t,e,{o:{insert:i},m:s},n=2){n===0&&i(r.targetAnchor,t,e);const{el:o,anchor:a,shapeFlag:l,children:h,props:c}=r,u=n===2;if(u&&i(o,t,e),(!u||js(c))&&l&16)for(let d=0;d<h.length;d++)s(h[d],t,e,2);u&&i(a,t,e)}function __(r,t,e,i,s,n,{o:{nextSibling:o,parentNode:a,querySelector:l}},h){const c=t.target=Pl(t.props,l);if(c){const u=c._lpa||c.firstChild;if(t.shapeFlag&16)if(js(t.props))t.anchor=h(o(r),t,a(r),e,i,s,n),t.targetAnchor=u;else{t.anchor=o(r);let d=u;for(;d;)if(d=o(d),d&&d.nodeType===8&&d.data==="teleport anchor"){t.targetAnchor=d,c._lpa=t.targetAnchor&&o(t.targetAnchor);break}h(u,t,c,e,i,s,n)}yp(t)}return t.anchor&&o(t.anchor)}const v_=y_;function yp(r){const t=r.ctx;if(t&&t.ut){let e=r.children[0].el;for(;e&&e!==r.targetAnchor;)e.nodeType===1&&e.setAttribute("data-v-owner",t.uid),e=e.nextSibling;t.ut()}}const re=Symbol.for("v-fgt"),sa=Symbol.for("v-txt"),Ae=Symbol.for("v-cmt"),wa=Symbol.for("v-stc"),Ys=[];let Fe=null;function Wt(r=!1){Ys.push(Fe=r?null:[])}function x_(){Ys.pop(),Fe=Ys[Ys.length-1]||null}let ln=1;function Qc(r){ln+=r}function _p(r){return r.dynamicChildren=ln>0?Fe||ts:null,x_(),ln>0&&Fe&&Fe.push(r),r}function _e(r,t,e,i,s,n){return _p(pt(r,t,e,i,s,n,!0))}function Ts(r,t,e,i,s){return _p(Lt(r,t,e,i,s,!0))}function wo(r){return r?r.__v_isVNode===!0:!1}function pi(r,t){return r.type===t.type&&r.key===t.key}const na="__vInternal",vp=({key:r})=>r??null,no=({ref:r,ref_key:t,ref_for:e})=>(typeof r=="number"&&(r=""+r),r!=null?$t(r)||Gt(r)||gt(r)?{i:Jt,r,k:t,f:!!e}:r:null);function pt(r,t=null,e=null,i=0,s=null,n=r===re?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:r,props:t,key:t&&vp(t),ref:t&&no(t),scopeId:ta,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:Jt};return a?(ec(l,e),n&128&&r.normalize(l)):e&&(l.shapeFlag|=$t(e)?8:16),ln>0&&!o&&Fe&&(l.patchFlag>0||n&6)&&l.patchFlag!==32&&Fe.push(l),l}const Lt=b_;function b_(r,t=null,e=null,i=0,s=null,n=!1){if((!r||r===Dy)&&(r=Ae),wo(r)){const a=jr(r,t,!0);return e&&ec(a,e),ln>0&&!n&&Fe&&(a.shapeFlag&6?Fe[Fe.indexOf(r)]=a:Fe.push(a)),a.patchFlag|=-2,a}if(D_(r)&&(r=r.__vccOpts),t){t=E_(t);let{class:a,style:l}=t;a&&!$t(a)&&(t.class=Er(a)),Pt(l)&&(Xf(l)&&!ht(l)&&(l=qt({},l)),t.style=kh(l))}const o=$t(r)?1:Oy(r)?128:g_(r)?64:Pt(r)?4:gt(r)?2:0;return pt(r,t,e,i,s,o,n,!0)}function E_(r){return r?Xf(r)||na in r?qt({},r):r:null}function jr(r,t,e=!1){const{props:i,ref:s,patchFlag:n,children:o}=r,a=t?T_(i||{},t):i;return{__v_isVNode:!0,__v_skip:!0,type:r.type,props:a,key:a&&vp(a),ref:t&&t.ref?e&&s?ht(s)?s.concat(no(t)):[s,no(t)]:no(t):s,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:o,target:r.target,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:t&&r.type!==re?n===-1?16:n|16:n,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:r.transition,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&jr(r.ssContent),ssFallback:r.ssFallback&&jr(r.ssFallback),el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce}}function xp(r=" ",t=0){return Lt(sa,null,r,t)}function Jc(r="",t=!1){return t?(Wt(),Ts(Ae,null,r)):Lt(Ae,null,r)}function je(r){return r==null||typeof r=="boolean"?Lt(Ae):ht(r)?Lt(re,null,r.slice()):typeof r=="object"?Fr(r):Lt(sa,null,String(r))}function Fr(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:jr(r)}function ec(r,t){let e=0;const{shapeFlag:i}=r;if(t==null)t=null;else if(ht(t))e=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),ec(r,s()),s._c&&(s._d=!0));return}else{e=32;const s=t._;!s&&!(na in t)?t._ctx=Jt:s===3&&Jt&&(Jt.slots._===1?t._=1:(t._=2,r.patchFlag|=1024))}else gt(t)?(t={default:t,_ctx:Jt},e=32):(t=String(t),i&64?(e=16,t=[xp(t)]):e=8);r.children=t,r.shapeFlag|=e}function T_(...r){const t={};for(let e=0;e<r.length;e++){const i=r[e];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=Er([t.class,i.class]));else if(s==="style")t.style=kh([t.style,i.style]);else if(Wo(s)){const n=t[s],o=i[s];o&&n!==o&&!(ht(n)&&n.includes(o))&&(t[s]=n?[].concat(n,o):o)}else s!==""&&(t[s]=i[s])}return t}function He(r,t,e,i=null){we(r,t,7,[e,i])}const w_=up();let A_=0;function S_(r,t,e){const i=r.type,s=(t?t.appContext:r.appContext)||w_,n={uid:A_++,vnode:r,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new Pf(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:fp(i,s),emitsOptions:Jf(i,s),emit:null,emitted:null,propsDefaults:Mt,inheritAttrs:i.inheritAttrs,ctx:Mt,data:Mt,props:Mt,attrs:Mt,slots:Mt,refs:Mt,setupState:Mt,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=t?t.root:n,n.emit=Cy.bind(null,n),r.ce&&r.ce(n),n}let jt=null;const C_=()=>jt||Jt;let rc,Oi,tu="__VUE_INSTANCE_SETTERS__";(Oi=gl()[tu])||(Oi=gl()[tu]=[]),Oi.push(r=>jt=r),rc=r=>{Oi.length>1?Oi.forEach(t=>t(r)):Oi[0](r)};const fs=r=>{rc(r),r.scope.on()},Ei=()=>{jt&&jt.scope.off(),rc(null)};function bp(r){return r.vnode.shapeFlag&4}let hn=!1;function I_(r,t=!1){hn=t;const{props:e,children:i}=r.vnode,s=bp(r);a_(r,e,s,t),c_(r,i);const n=s?P_(r,t):void 0;return hn=!1,n}function P_(r,t){const e=r.type;r.accessCache=Object.create(null),r.proxy=Ko(new Proxy(r.ctx,Qy));const{setup:i}=e;if(i){const s=r.setupContext=i.length>1?M_(r):null;fs(r),bs();const n=Vr(i,r,0,[r.props,s]);if(Es(),Ei(),wf(n)){if(n.then(Ei,Ei),t)return n.then(o=>{eu(r,o,t)}).catch(o=>{Qo(o,r,0)});r.asyncDep=n}else eu(r,n,t)}else Ep(r,t)}function eu(r,t,e){gt(t)?r.type.__ssrInlineRender?r.ssrRender=t:r.render=t:Pt(t)&&(r.setupState=Yf(t)),Ep(r,e)}let ru;function Ep(r,t,e){const i=r.type;if(!r.render){if(!t&&ru&&!i.render){const s=i.template||Qh(r).template;if(s){const{isCustomElement:n,compilerOptions:o}=r.appContext.config,{delimiters:a,compilerOptions:l}=i,h=qt(qt({isCustomElement:n,delimiters:a},o),l);i.render=ru(s,h)}}r.render=i.render||Oe}{fs(r),bs();try{Jy(r)}finally{Es(),Ei()}}}function R_(r){return r.attrsProxy||(r.attrsProxy=new Proxy(r.attrs,{get(t,e){return fe(r,"get","$attrs"),t[e]}}))}function M_(r){const t=e=>{r.exposed=e||{}};return{get attrs(){return R_(r)},slots:r.slots,emit:r.emit,expose:t}}function oa(r){if(r.exposed)return r.exposeProxy||(r.exposeProxy=new Proxy(Yf(Ko(r.exposed)),{get(t,e){if(e in t)return t[e];if(e in Ws)return Ws[e](r)},has(t,e){return e in t||e in Ws}}))}function B_(r,t=!0){return gt(r)?r.displayName||r.name:r.name||t&&r.__name}function D_(r){return gt(r)&&"__vccOpts"in r}const ue=(r,t)=>by(r,t,hn);function ic(r,t,e){const i=arguments.length;return i===2?Pt(t)&&!ht(t)?wo(t)?Lt(r,null,[t]):Lt(r,t):Lt(r,null,t):(i>3?e=Array.prototype.slice.call(arguments,2):i===3&&wo(e)&&(e=[e]),Lt(r,t,e))}const F_=Symbol.for("v-scx"),O_=()=>tr(F_),N_="3.3.8",L_="http://www.w3.org/2000/svg",mi=typeof document<"u"?document:null,iu=mi&&mi.createElement("template"),k_={insert:(r,t,e)=>{t.insertBefore(r,e||null)},remove:r=>{const t=r.parentNode;t&&t.removeChild(r)},createElement:(r,t,e,i)=>{const s=t?mi.createElementNS(L_,r):mi.createElement(r,e?{is:e}:void 0);return r==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:r=>mi.createTextNode(r),createComment:r=>mi.createComment(r),setText:(r,t)=>{r.nodeValue=t},setElementText:(r,t)=>{r.textContent=t},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>mi.querySelector(r),setScopeId(r,t){r.setAttribute(t,"")},insertStaticContent(r,t,e,i,s,n){const o=e?e.previousSibling:t.lastChild;if(s&&(s===n||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),e),!(s===n||!(s=s.nextSibling)););else{iu.innerHTML=i?`<svg>${r}</svg>`:r;const a=iu.content;if(i){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,e)}return[o?o.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},Sr="transition",Is="animation",cn=Symbol("_vtc"),sc=(r,{slots:t})=>ic(Gy,U_(r),t);sc.displayName="Transition";const Tp={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};sc.props=qt({},ip,Tp);const ii=(r,t=[])=>{ht(r)?r.forEach(e=>e(...t)):r&&r(...t)},su=r=>r?ht(r)?r.some(t=>t.length>1):r.length>1:!1;function U_(r){const t={};for(const C in r)C in Tp||(t[C]=r[C]);if(r.css===!1)return t;const{name:e="v",type:i,duration:s,enterFromClass:n=`${e}-enter-from`,enterActiveClass:o=`${e}-enter-active`,enterToClass:a=`${e}-enter-to`,appearFromClass:l=n,appearActiveClass:h=o,appearToClass:c=a,leaveFromClass:u=`${e}-leave-from`,leaveActiveClass:d=`${e}-leave-active`,leaveToClass:f=`${e}-leave-to`}=r,p=G_(s),m=p&&p[0],g=p&&p[1],{onBeforeEnter:y,onEnter:x,onEnterCancelled:_,onLeave:b,onLeaveCancelled:S,onBeforeAppear:D=y,onAppear:M=x,onAppearCancelled:T=_}=t,I=(C,A,O)=>{si(C,A?c:a),si(C,A?h:o),O&&O()},F=(C,A)=>{C._isLeaving=!1,si(C,u),si(C,f),si(C,d),A&&A()},q=C=>(A,O)=>{const Q=C?M:x,X=()=>I(A,C,O);ii(Q,[A,X]),nu(()=>{si(A,C?l:n),Cr(A,C?c:a),su(Q)||ou(A,i,m,X)})};return qt(t,{onBeforeEnter(C){ii(y,[C]),Cr(C,n),Cr(C,o)},onBeforeAppear(C){ii(D,[C]),Cr(C,l),Cr(C,h)},onEnter:q(!1),onAppear:q(!0),onLeave(C,A){C._isLeaving=!0;const O=()=>F(C,A);Cr(C,u),V_(),Cr(C,d),nu(()=>{C._isLeaving&&(si(C,u),Cr(C,f),su(b)||ou(C,i,g,O))}),ii(b,[C,O])},onEnterCancelled(C){I(C,!1),ii(_,[C])},onAppearCancelled(C){I(C,!0),ii(T,[C])},onLeaveCancelled(C){F(C),ii(S,[C])}})}function G_(r){if(r==null)return null;if(Pt(r))return[Aa(r.enter),Aa(r.leave)];{const t=Aa(r);return[t,t]}}function Aa(r){return kg(r)}function Cr(r,t){t.split(/\s+/).forEach(e=>e&&r.classList.add(e)),(r[cn]||(r[cn]=new Set)).add(t)}function si(r,t){t.split(/\s+/).forEach(i=>i&&r.classList.remove(i));const e=r[cn];e&&(e.delete(t),e.size||(r[cn]=void 0))}function nu(r){requestAnimationFrame(()=>{requestAnimationFrame(r)})}let H_=0;function ou(r,t,e,i){const s=r._endId=++H_,n=()=>{s===r._endId&&i()};if(e)return setTimeout(n,e);const{type:o,timeout:a,propCount:l}=$_(r,t);if(!o)return i();const h=o+"end";let c=0;const u=()=>{r.removeEventListener(h,d),n()},d=f=>{f.target===r&&++c>=l&&u()};setTimeout(()=>{c<l&&u()},a+1),r.addEventListener(h,d)}function $_(r,t){const e=window.getComputedStyle(r),i=p=>(e[p]||"").split(", "),s=i(`${Sr}Delay`),n=i(`${Sr}Duration`),o=au(s,n),a=i(`${Is}Delay`),l=i(`${Is}Duration`),h=au(a,l);let c=null,u=0,d=0;t===Sr?o>0&&(c=Sr,u=o,d=n.length):t===Is?h>0&&(c=Is,u=h,d=l.length):(u=Math.max(o,h),c=u>0?o>h?Sr:Is:null,d=c?c===Sr?n.length:l.length:0);const f=c===Sr&&/\b(transform|all)(,|$)/.test(i(`${Sr}Property`).toString());return{type:c,timeout:u,propCount:d,hasTransform:f}}function au(r,t){for(;r.length<t.length;)r=r.concat(r);return Math.max(...t.map((e,i)=>lu(e)+lu(r[i])))}function lu(r){return r==="auto"?0:Number(r.slice(0,-1).replace(",","."))*1e3}function V_(){return document.body.offsetHeight}function X_(r,t,e){const i=r[cn];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?r.removeAttribute("class"):e?r.setAttribute("class",t):r.className=t}const nc=Symbol("_vod"),hu={beforeMount(r,{value:t},{transition:e}){r[nc]=r.style.display==="none"?"":r.style.display,e&&t?e.beforeEnter(r):Ps(r,t)},mounted(r,{value:t},{transition:e}){e&&t&&e.enter(r)},updated(r,{value:t,oldValue:e},{transition:i}){!t!=!e&&(i?t?(i.beforeEnter(r),Ps(r,!0),i.enter(r)):i.leave(r,()=>{Ps(r,!1)}):Ps(r,t))},beforeUnmount(r,{value:t}){Ps(r,t)}};function Ps(r,t){r.style.display=t?r[nc]:"none"}function z_(r,t,e){const i=r.style,s=$t(e);if(e&&!s){if(t&&!$t(t))for(const n in t)e[n]==null&&Rl(i,n,"");for(const n in e)Rl(i,n,e[n])}else{const n=i.display;s?t!==e&&(i.cssText=e):t&&r.removeAttribute("style"),nc in r&&(i.display=n)}}const cu=/\s*!important$/;function Rl(r,t,e){if(ht(e))e.forEach(i=>Rl(r,t,i));else if(e==null&&(e=""),t.startsWith("--"))r.setProperty(t,e);else{const i=W_(r,t);cu.test(e)?r.setProperty(xs(i),e.replace(cu,""),"important"):r[i]=e}}const uu=["Webkit","Moz","ms"],Sa={};function W_(r,t){const e=Sa[t];if(e)return e;let i=ir(t);if(i!=="filter"&&i in r)return Sa[t]=i;i=Yo(i);for(let s=0;s<uu.length;s++){const n=uu[s]+i;if(n in r)return Sa[t]=n}return t}const du="http://www.w3.org/1999/xlink";function j_(r,t,e,i,s){if(i&&t.startsWith("xlink:"))e==null?r.removeAttributeNS(du,t.slice(6,t.length)):r.setAttributeNS(du,t,e);else{const n=Xg(t);e==null||n&&!Cf(e)?r.removeAttribute(t):r.setAttribute(t,n?"":e)}}function Y_(r,t,e,i,s,n,o){if(t==="innerHTML"||t==="textContent"){i&&o(i,s,n),r[t]=e??"";return}const a=r.tagName;if(t==="value"&&a!=="PROGRESS"&&!a.includes("-")){r._value=e;const h=a==="OPTION"?r.getAttribute("value"):r.value,c=e??"";h!==c&&(r.value=c),e==null&&r.removeAttribute(t);return}let l=!1;if(e===""||e==null){const h=typeof r[t];h==="boolean"?e=Cf(e):e==null&&h==="string"?(e="",l=!0):h==="number"&&(e=0,l=!0)}try{r[t]=e}catch{}l&&r.removeAttribute(t)}function gi(r,t,e,i){r.addEventListener(t,e,i)}function q_(r,t,e,i){r.removeEventListener(t,e,i)}const fu=Symbol("_vei");function K_(r,t,e,i,s=null){const n=r[fu]||(r[fu]={}),o=n[t];if(i&&o)o.value=i;else{const[a,l]=Z_(t);if(i){const h=n[t]=t0(i,s);gi(r,a,h,l)}else o&&(q_(r,a,o,l),n[t]=void 0)}}const pu=/(?:Once|Passive|Capture)$/;function Z_(r){let t;if(pu.test(r)){t={};let i;for(;i=r.match(pu);)r=r.slice(0,r.length-i[0].length),t[i[0].toLowerCase()]=!0}return[r[2]===":"?r.slice(3):xs(r.slice(2)),t]}let Ca=0;const Q_=Promise.resolve(),J_=()=>Ca||(Q_.then(()=>Ca=0),Ca=Date.now());function t0(r,t){const e=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=e.attached)return;we(e0(i,e.value),t,5,[i])};return e.value=r,e.attached=J_(),e}function e0(r,t){if(ht(t)){const e=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{e.call(r),r._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const mu=/^on[a-z]/,r0=(r,t,e,i,s=!1,n,o,a,l)=>{t==="class"?X_(r,i,s):t==="style"?z_(r,e,i):Wo(t)?Oh(t)||K_(r,t,e,i,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):i0(r,t,i,s))?Y_(r,t,i,n,o,a,l):(t==="true-value"?r._trueValue=i:t==="false-value"&&(r._falseValue=i),j_(r,t,i,s))};function i0(r,t,e,i){return i?!!(t==="innerHTML"||t==="textContent"||t in r&&mu.test(t)&&gt(e)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&r.tagName==="INPUT"||t==="type"&&r.tagName==="TEXTAREA"||mu.test(t)&&$t(e)?!1:t in r}const Ao=r=>{const t=r.props["onUpdate:modelValue"]||!1;return ht(t)?e=>io(t,e):t};function s0(r){r.target.composing=!0}function gu(r){const t=r.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const is=Symbol("_assign"),Ml={created(r,{modifiers:{lazy:t,trim:e,number:i}},s){r[is]=Ao(s);const n=i||s.props&&s.props.type==="number";gi(r,t?"change":"input",o=>{if(o.target.composing)return;let a=r.value;e&&(a=a.trim()),n&&(a=ml(a)),r[is](a)}),e&&gi(r,"change",()=>{r.value=r.value.trim()}),t||(gi(r,"compositionstart",s0),gi(r,"compositionend",gu),gi(r,"change",gu))},mounted(r,{value:t}){r.value=t??""},beforeUpdate(r,{value:t,modifiers:{lazy:e,trim:i,number:s}},n){if(r[is]=Ao(n),r.composing||document.activeElement===r&&r.type!=="range"&&(e||i&&r.value.trim()===t||(s||r.type==="number")&&ml(r.value)===t))return;const o=t??"";r.value!==o&&(r.value=o)}},n0={created(r,{value:t},e){r.checked=vo(t,e.props.value),r[is]=Ao(e),gi(r,"change",()=>{r[is](o0(r))})},beforeUpdate(r,{value:t,oldValue:e},i){r[is]=Ao(i),t!==e&&(r.checked=vo(t,i.props.value))}};function o0(r){return"_value"in r?r._value:r.value}const a0=qt({patchProp:r0},k_);let yu;function l0(){return yu||(yu=d_(a0))}const h0=(...r)=>{const t=l0().createApp(...r),{mount:e}=t;return t.mount=i=>{const s=c0(i);if(!s)return;const n=t._component;!gt(n)&&!n.render&&!n.template&&(n.template=s.innerHTML),s.innerHTML="";const o=e(s,!1,s instanceof SVGElement);return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},t};function c0(r){return $t(r)?document.querySelector(r):r}var u0=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let wp;const aa=r=>wp=r,Ap=Symbol();function Bl(r){return r&&typeof r=="object"&&Object.prototype.toString.call(r)==="[object Object]"&&typeof r.toJSON!="function"}var qs;(function(r){r.direct="direct",r.patchObject="patch object",r.patchFunction="patch function"})(qs||(qs={}));function d0(){const r=Rf(!0),t=r.run(()=>oe({}));let e=[],i=[];const s=Ko({install(n){aa(s),s._a=n,n.provide(Ap,s),n.config.globalProperties.$pinia=s,i.forEach(o=>e.push(o)),i=[]},use(n){return!this._a&&!u0?i.push(n):e.push(n),this},_p:e,_a:null,_e:r,_s:new Map,state:t});return s}const Sp=()=>{};function _u(r,t,e,i=Sp){r.push(t);const s=()=>{const n=r.indexOf(t);n>-1&&(r.splice(n,1),i())};return!e&&Mf()&&jg(s),s}function Ni(r,...t){r.slice().forEach(e=>{e(...t)})}const f0=r=>r();function Dl(r,t){r instanceof Map&&t instanceof Map&&t.forEach((e,i)=>r.set(i,e)),r instanceof Set&&t instanceof Set&&t.forEach(r.add,r);for(const e in t){if(!t.hasOwnProperty(e))continue;const i=t[e],s=r[e];Bl(s)&&Bl(i)&&r.hasOwnProperty(e)&&!Gt(i)&&!$r(i)?r[e]=Dl(s,i):r[e]=i}return r}const p0=Symbol();function m0(r){return!Bl(r)||!r.hasOwnProperty(p0)}const{assign:Rr}=Object;function g0(r){return!!(Gt(r)&&r.effect)}function y0(r,t,e,i){const{state:s,actions:n,getters:o}=t,a=e.state.value[r];let l;function h(){a||(e.state.value[r]=s?s():{});const c=Zo(e.state.value[r]);return Rr(c,n,Object.keys(o||{}).reduce((u,d)=>(u[d]=Ko(ue(()=>{aa(e);const f=e._s.get(r);return o[d].call(f,f)})),u),{}))}return l=Cp(r,h,t,e,i,!0),l}function Cp(r,t,e={},i,s,n){let o;const a=Rr({actions:{}},e),l={deep:!0};let h,c,u=[],d=[],f;const p=i.state.value[r];!n&&!p&&(i.state.value[r]={}),oe({});let m;function g(T){let I;h=c=!1,typeof T=="function"?(T(i.state.value[r]),I={type:qs.patchFunction,storeId:r,events:f}):(Dl(i.state.value[r],T),I={type:qs.patchObject,payload:T,storeId:r,events:f});const F=m=Symbol();jh().then(()=>{m===F&&(h=!0)}),c=!0,Ni(u,I,i.state.value[r])}const y=n?function(){const{state:I}=e,F=I?I():{};this.$patch(q=>{Rr(q,F)})}:Sp;function x(){o.stop(),u=[],d=[],i._s.delete(r)}function _(T,I){return function(){aa(i);const F=Array.from(arguments),q=[],C=[];function A(X){q.push(X)}function O(X){C.push(X)}Ni(d,{args:F,name:T,store:S,after:A,onError:O});let Q;try{Q=I.apply(this&&this.$id===r?this:S,F)}catch(X){throw Ni(C,X),X}return Q instanceof Promise?Q.then(X=>(Ni(q,X),X)).catch(X=>(Ni(C,X),Promise.reject(X))):(Ni(q,Q),Q)}}const b={_p:i,$id:r,$onAction:_u.bind(null,d),$patch:g,$reset:y,$subscribe(T,I={}){const F=_u(u,T,I.detached,()=>q()),q=o.run(()=>Xr(()=>i.state.value[r],C=>{(I.flush==="sync"?c:h)&&T({storeId:r,type:qs.direct,events:f},C)},Rr({},l,I)));return F},$dispose:x},S=Zr(b);i._s.set(r,S);const M=(i._a&&i._a.runWithContext||f0)(()=>i._e.run(()=>(o=Rf()).run(t)));for(const T in M){const I=M[T];if(Gt(I)&&!g0(I)||$r(I))n||(p&&m0(I)&&(Gt(I)?I.value=p[T]:Dl(I,p[T])),i.state.value[r][T]=I);else if(typeof I=="function"){const F=_(T,I);M[T]=F,a.actions[T]=I}}return Rr(S,M),Rr(yt(S),M),Object.defineProperty(S,"$state",{get:()=>i.state.value[r],set:T=>{g(I=>{Rr(I,T)})}}),i._p.forEach(T=>{Rr(S,o.run(()=>T({store:S,app:i._a,pinia:i,options:a})))}),p&&n&&e.hydrate&&e.hydrate(S.$state,p),h=!0,c=!0,S}function _0(r,t,e){let i,s;const n=typeof t=="function";typeof r=="string"?(i=r,s=n?e:t):(s=r,i=r.id);function o(a,l){const h=o_();return a=a||(h?tr(Ap,null):null),a&&aa(a),a=wp,a._s.has(i)||(n?Cp(i,t,s,a):y0(i,s,a)),a._s.get(i)}return o.$id=i,o}const v0=d0();const Qr=(r,t)=>{const e=r.__vccOpts||r;for(const[i,s]of t)e[i]=s;return e},x0={};function b0(r,t){const e=By("RouterView");return Wt(),Ts(e)}const E0=Qr(x0,[["render",b0],["__scopeId","data-v-dc6606a4"]]);/*!
  * vue-router v4.2.5
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const Vi=typeof window<"u";function T0(r){return r.__esModule||r[Symbol.toStringTag]==="Module"}const Ct=Object.assign;function Ia(r,t){const e={};for(const i in t){const s=t[i];e[i]=ke(s)?s.map(r):r(s)}return e}const Ks=()=>{},ke=Array.isArray,w0=/\/$/,A0=r=>r.replace(w0,"");function Pa(r,t,e="/"){let i,s={},n="",o="";const a=t.indexOf("#");let l=t.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(i=t.slice(0,l),n=t.slice(l+1,a>-1?a:t.length),s=r(n)),a>-1&&(i=i||t.slice(0,a),o=t.slice(a,t.length)),i=P0(i??t,e),{fullPath:i+(n&&"?")+n+o,path:i,query:s,hash:o}}function S0(r,t){const e=t.query?r(t.query):"";return t.path+(e&&"?")+e+(t.hash||"")}function vu(r,t){return!t||!r.toLowerCase().startsWith(t.toLowerCase())?r:r.slice(t.length)||"/"}function C0(r,t,e){const i=t.matched.length-1,s=e.matched.length-1;return i>-1&&i===s&&ps(t.matched[i],e.matched[s])&&Ip(t.params,e.params)&&r(t.query)===r(e.query)&&t.hash===e.hash}function ps(r,t){return(r.aliasOf||r)===(t.aliasOf||t)}function Ip(r,t){if(Object.keys(r).length!==Object.keys(t).length)return!1;for(const e in r)if(!I0(r[e],t[e]))return!1;return!0}function I0(r,t){return ke(r)?xu(r,t):ke(t)?xu(t,r):r===t}function xu(r,t){return ke(t)?r.length===t.length&&r.every((e,i)=>e===t[i]):r.length===1&&r[0]===t}function P0(r,t){if(r.startsWith("/"))return r;if(!r)return t;const e=t.split("/"),i=r.split("/"),s=i[i.length-1];(s===".."||s===".")&&i.push("");let n=e.length-1,o,a;for(o=0;o<i.length;o++)if(a=i[o],a!==".")if(a==="..")n>1&&n--;else break;return e.slice(0,n).join("/")+"/"+i.slice(o-(o===i.length?1:0)).join("/")}var un;(function(r){r.pop="pop",r.push="push"})(un||(un={}));var Zs;(function(r){r.back="back",r.forward="forward",r.unknown=""})(Zs||(Zs={}));function R0(r){if(!r)if(Vi){const t=document.querySelector("base");r=t&&t.getAttribute("href")||"/",r=r.replace(/^\w+:\/\/[^\/]+/,"")}else r="/";return r[0]!=="/"&&r[0]!=="#"&&(r="/"+r),A0(r)}const M0=/^[^#]+#/;function B0(r,t){return r.replace(M0,"#")+t}function D0(r,t){const e=document.documentElement.getBoundingClientRect(),i=r.getBoundingClientRect();return{behavior:t.behavior,left:i.left-e.left-(t.left||0),top:i.top-e.top-(t.top||0)}}const la=()=>({left:window.pageXOffset,top:window.pageYOffset});function F0(r){let t;if("el"in r){const e=r.el,i=typeof e=="string"&&e.startsWith("#"),s=typeof e=="string"?i?document.getElementById(e.slice(1)):document.querySelector(e):e;if(!s)return;t=D0(s,r)}else t=r;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function bu(r,t){return(history.state?history.state.position-t:-1)+r}const Fl=new Map;function O0(r,t){Fl.set(r,t)}function N0(r){const t=Fl.get(r);return Fl.delete(r),t}let L0=()=>location.protocol+"//"+location.host;function Pp(r,t){const{pathname:e,search:i,hash:s}=t,n=r.indexOf("#");if(n>-1){let a=s.includes(r.slice(n))?r.slice(n).length:1,l=s.slice(a);return l[0]!=="/"&&(l="/"+l),vu(l,"")}return vu(e,r)+i+s}function k0(r,t,e,i){let s=[],n=[],o=null;const a=({state:d})=>{const f=Pp(r,location),p=e.value,m=t.value;let g=0;if(d){if(e.value=f,t.value=d,o&&o===p){o=null;return}g=m?d.position-m.position:0}else i(f);s.forEach(y=>{y(e.value,p,{delta:g,type:un.pop,direction:g?g>0?Zs.forward:Zs.back:Zs.unknown})})};function l(){o=e.value}function h(d){s.push(d);const f=()=>{const p=s.indexOf(d);p>-1&&s.splice(p,1)};return n.push(f),f}function c(){const{history:d}=window;d.state&&d.replaceState(Ct({},d.state,{scroll:la()}),"")}function u(){for(const d of n)d();n=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",c,{passive:!0}),{pauseListeners:l,listen:h,destroy:u}}function Eu(r,t,e,i=!1,s=!1){return{back:r,current:t,forward:e,replaced:i,position:window.history.length,scroll:s?la():null}}function U0(r){const{history:t,location:e}=window,i={value:Pp(r,e)},s={value:t.state};s.value||n(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function n(l,h,c){const u=r.indexOf("#"),d=u>-1?(e.host&&document.querySelector("base")?r:r.slice(u))+l:L0()+r+l;try{t[c?"replaceState":"pushState"](h,"",d),s.value=h}catch(f){console.error(f),e[c?"replace":"assign"](d)}}function o(l,h){const c=Ct({},t.state,Eu(s.value.back,l,s.value.forward,!0),h,{position:s.value.position});n(l,c,!0),i.value=l}function a(l,h){const c=Ct({},s.value,t.state,{forward:l,scroll:la()});n(c.current,c,!0);const u=Ct({},Eu(i.value,l,null),{position:c.position+1},h);n(l,u,!1),i.value=l}return{location:i,state:s,push:a,replace:o}}function G0(r){r=R0(r);const t=U0(r),e=k0(r,t.state,t.location,t.replace);function i(n,o=!0){o||e.pauseListeners(),history.go(n)}const s=Ct({location:"",base:r,go:i,createHref:B0.bind(null,r)},t,e);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function H0(r){return typeof r=="string"||r&&typeof r=="object"}function Rp(r){return typeof r=="string"||typeof r=="symbol"}const Ir={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Mp=Symbol("");var Tu;(function(r){r[r.aborted=4]="aborted",r[r.cancelled=8]="cancelled",r[r.duplicated=16]="duplicated"})(Tu||(Tu={}));function ms(r,t){return Ct(new Error,{type:r,[Mp]:!0},t)}function lr(r,t){return r instanceof Error&&Mp in r&&(t==null||!!(r.type&t))}const wu="[^/]+?",$0={sensitive:!1,strict:!1,start:!0,end:!0},V0=/[.+*?^${}()[\]/\\]/g;function X0(r,t){const e=Ct({},$0,t),i=[];let s=e.start?"^":"";const n=[];for(const h of r){const c=h.length?[]:[90];e.strict&&!h.length&&(s+="/");for(let u=0;u<h.length;u++){const d=h[u];let f=40+(e.sensitive?.25:0);if(d.type===0)u||(s+="/"),s+=d.value.replace(V0,"\\$&"),f+=40;else if(d.type===1){const{value:p,repeatable:m,optional:g,regexp:y}=d;n.push({name:p,repeatable:m,optional:g});const x=y||wu;if(x!==wu){f+=10;try{new RegExp(`(${x})`)}catch(b){throw new Error(`Invalid custom RegExp for param "${p}" (${x}): `+b.message)}}let _=m?`((?:${x})(?:/(?:${x}))*)`:`(${x})`;u||(_=g&&h.length<2?`(?:/${_})`:"/"+_),g&&(_+="?"),s+=_,f+=20,g&&(f+=-8),m&&(f+=-20),x===".*"&&(f+=-50)}c.push(f)}i.push(c)}if(e.strict&&e.end){const h=i.length-1;i[h][i[h].length-1]+=.7000000000000001}e.strict||(s+="/?"),e.end?s+="$":e.strict&&(s+="(?:/|$)");const o=new RegExp(s,e.sensitive?"":"i");function a(h){const c=h.match(o),u={};if(!c)return null;for(let d=1;d<c.length;d++){const f=c[d]||"",p=n[d-1];u[p.name]=f&&p.repeatable?f.split("/"):f}return u}function l(h){let c="",u=!1;for(const d of r){(!u||!c.endsWith("/"))&&(c+="/"),u=!1;for(const f of d)if(f.type===0)c+=f.value;else if(f.type===1){const{value:p,repeatable:m,optional:g}=f,y=p in h?h[p]:"";if(ke(y)&&!m)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const x=ke(y)?y.join("/"):y;if(!x)if(g)d.length<2&&(c.endsWith("/")?c=c.slice(0,-1):u=!0);else throw new Error(`Missing required param "${p}"`);c+=x}}return c||"/"}return{re:o,score:i,keys:n,parse:a,stringify:l}}function z0(r,t){let e=0;for(;e<r.length&&e<t.length;){const i=t[e]-r[e];if(i)return i;e++}return r.length<t.length?r.length===1&&r[0]===40+40?-1:1:r.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function W0(r,t){let e=0;const i=r.score,s=t.score;for(;e<i.length&&e<s.length;){const n=z0(i[e],s[e]);if(n)return n;e++}if(Math.abs(s.length-i.length)===1){if(Au(i))return 1;if(Au(s))return-1}return s.length-i.length}function Au(r){const t=r[r.length-1];return r.length>0&&t[t.length-1]<0}const j0={type:0,value:""},Y0=/[a-zA-Z0-9_]/;function q0(r){if(!r)return[[]];if(r==="/")return[[j0]];if(!r.startsWith("/"))throw new Error(`Invalid path "${r}"`);function t(f){throw new Error(`ERR (${e})/"${h}": ${f}`)}let e=0,i=e;const s=[];let n;function o(){n&&s.push(n),n=[]}let a=0,l,h="",c="";function u(){h&&(e===0?n.push({type:0,value:h}):e===1||e===2||e===3?(n.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${h}) must be alone in its segment. eg: '/:ids+.`),n.push({type:1,value:h,regexp:c,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),h="")}function d(){h+=l}for(;a<r.length;){if(l=r[a++],l==="\\"&&e!==2){i=e,e=4;continue}switch(e){case 0:l==="/"?(h&&u(),o()):l===":"?(u(),e=1):d();break;case 4:d(),e=i;break;case 1:l==="("?e=2:Y0.test(l)?d():(u(),e=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+l:e=3:c+=l;break;case 3:u(),e=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,c="";break;default:t("Unknown state");break}}return e===2&&t(`Unfinished custom RegExp for param "${h}"`),u(),o(),s}function K0(r,t,e){const i=X0(q0(r.path),e),s=Ct(i,{record:r,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function Z0(r,t){const e=[],i=new Map;t=Iu({strict:!1,end:!0,sensitive:!1},t);function s(c){return i.get(c)}function n(c,u,d){const f=!d,p=Q0(c);p.aliasOf=d&&d.record;const m=Iu(t,c),g=[p];if("alias"in c){const _=typeof c.alias=="string"?[c.alias]:c.alias;for(const b of _)g.push(Ct({},p,{components:d?d.record.components:p.components,path:b,aliasOf:d?d.record:p}))}let y,x;for(const _ of g){const{path:b}=_;if(u&&b[0]!=="/"){const S=u.record.path,D=S[S.length-1]==="/"?"":"/";_.path=u.record.path+(b&&D+b)}if(y=K0(_,u,m),d?d.alias.push(y):(x=x||y,x!==y&&x.alias.push(y),f&&c.name&&!Cu(y)&&o(c.name)),p.children){const S=p.children;for(let D=0;D<S.length;D++)n(S[D],y,d&&d.children[D])}d=d||y,(y.record.components&&Object.keys(y.record.components).length||y.record.name||y.record.redirect)&&l(y)}return x?()=>{o(x)}:Ks}function o(c){if(Rp(c)){const u=i.get(c);u&&(i.delete(c),e.splice(e.indexOf(u),1),u.children.forEach(o),u.alias.forEach(o))}else{const u=e.indexOf(c);u>-1&&(e.splice(u,1),c.record.name&&i.delete(c.record.name),c.children.forEach(o),c.alias.forEach(o))}}function a(){return e}function l(c){let u=0;for(;u<e.length&&W0(c,e[u])>=0&&(c.record.path!==e[u].record.path||!Bp(c,e[u]));)u++;e.splice(u,0,c),c.record.name&&!Cu(c)&&i.set(c.record.name,c)}function h(c,u){let d,f={},p,m;if("name"in c&&c.name){if(d=i.get(c.name),!d)throw ms(1,{location:c});m=d.record.name,f=Ct(Su(u.params,d.keys.filter(x=>!x.optional).map(x=>x.name)),c.params&&Su(c.params,d.keys.map(x=>x.name))),p=d.stringify(f)}else if("path"in c)p=c.path,d=e.find(x=>x.re.test(p)),d&&(f=d.parse(p),m=d.record.name);else{if(d=u.name?i.get(u.name):e.find(x=>x.re.test(u.path)),!d)throw ms(1,{location:c,currentLocation:u});m=d.record.name,f=Ct({},u.params,c.params),p=d.stringify(f)}const g=[];let y=d;for(;y;)g.unshift(y.record),y=y.parent;return{name:m,path:p,params:f,matched:g,meta:tv(g)}}return r.forEach(c=>n(c)),{addRoute:n,resolve:h,removeRoute:o,getRoutes:a,getRecordMatcher:s}}function Su(r,t){const e={};for(const i of t)i in r&&(e[i]=r[i]);return e}function Q0(r){return{path:r.path,redirect:r.redirect,name:r.name,meta:r.meta||{},aliasOf:void 0,beforeEnter:r.beforeEnter,props:J0(r),children:r.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in r?r.components||null:r.component&&{default:r.component}}}function J0(r){const t={},e=r.props||!1;if("component"in r)t.default=e;else for(const i in r.components)t[i]=typeof e=="object"?e[i]:e;return t}function Cu(r){for(;r;){if(r.record.aliasOf)return!0;r=r.parent}return!1}function tv(r){return r.reduce((t,e)=>Ct(t,e.meta),{})}function Iu(r,t){const e={};for(const i in r)e[i]=i in t?t[i]:r[i];return e}function Bp(r,t){return t.children.some(e=>e===r||Bp(r,e))}const Dp=/#/g,ev=/&/g,rv=/\//g,iv=/=/g,sv=/\?/g,Fp=/\+/g,nv=/%5B/g,ov=/%5D/g,Op=/%5E/g,av=/%60/g,Np=/%7B/g,lv=/%7C/g,Lp=/%7D/g,hv=/%20/g;function oc(r){return encodeURI(""+r).replace(lv,"|").replace(nv,"[").replace(ov,"]")}function cv(r){return oc(r).replace(Np,"{").replace(Lp,"}").replace(Op,"^")}function Ol(r){return oc(r).replace(Fp,"%2B").replace(hv,"+").replace(Dp,"%23").replace(ev,"%26").replace(av,"`").replace(Np,"{").replace(Lp,"}").replace(Op,"^")}function uv(r){return Ol(r).replace(iv,"%3D")}function dv(r){return oc(r).replace(Dp,"%23").replace(sv,"%3F")}function fv(r){return r==null?"":dv(r).replace(rv,"%2F")}function So(r){try{return decodeURIComponent(""+r)}catch{}return""+r}function pv(r){const t={};if(r===""||r==="?")return t;const i=(r[0]==="?"?r.slice(1):r).split("&");for(let s=0;s<i.length;++s){const n=i[s].replace(Fp," "),o=n.indexOf("="),a=So(o<0?n:n.slice(0,o)),l=o<0?null:So(n.slice(o+1));if(a in t){let h=t[a];ke(h)||(h=t[a]=[h]),h.push(l)}else t[a]=l}return t}function Pu(r){let t="";for(let e in r){const i=r[e];if(e=uv(e),i==null){i!==void 0&&(t+=(t.length?"&":"")+e);continue}(ke(i)?i.map(n=>n&&Ol(n)):[i&&Ol(i)]).forEach(n=>{n!==void 0&&(t+=(t.length?"&":"")+e,n!=null&&(t+="="+n))})}return t}function mv(r){const t={};for(const e in r){const i=r[e];i!==void 0&&(t[e]=ke(i)?i.map(s=>s==null?null:""+s):i==null?i:""+i)}return t}const gv=Symbol(""),Ru=Symbol(""),ac=Symbol(""),kp=Symbol(""),Nl=Symbol("");function Rs(){let r=[];function t(i){return r.push(i),()=>{const s=r.indexOf(i);s>-1&&r.splice(s,1)}}function e(){r=[]}return{add:t,list:()=>r.slice(),reset:e}}function Or(r,t,e,i,s){const n=i&&(i.enterCallbacks[s]=i.enterCallbacks[s]||[]);return()=>new Promise((o,a)=>{const l=u=>{u===!1?a(ms(4,{from:e,to:t})):u instanceof Error?a(u):H0(u)?a(ms(2,{from:t,to:u})):(n&&i.enterCallbacks[s]===n&&typeof u=="function"&&n.push(u),o())},h=r.call(i&&i.instances[s],t,e,l);let c=Promise.resolve(h);r.length<3&&(c=c.then(l)),c.catch(u=>a(u))})}function Ra(r,t,e,i){const s=[];for(const n of r)for(const o in n.components){let a=n.components[o];if(!(t!=="beforeRouteEnter"&&!n.instances[o]))if(yv(a)){const h=(a.__vccOpts||a)[t];h&&s.push(Or(h,e,i,n,o))}else{let l=a();s.push(()=>l.then(h=>{if(!h)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${n.path}"`));const c=T0(h)?h.default:h;n.components[o]=c;const d=(c.__vccOpts||c)[t];return d&&Or(d,e,i,n,o)()}))}}return s}function yv(r){return typeof r=="object"||"displayName"in r||"props"in r||"__vccOpts"in r}function Mu(r){const t=tr(ac),e=tr(kp),i=ue(()=>t.resolve(Ut(r.to))),s=ue(()=>{const{matched:l}=i.value,{length:h}=l,c=l[h-1],u=e.matched;if(!c||!u.length)return-1;const d=u.findIndex(ps.bind(null,c));if(d>-1)return d;const f=Bu(l[h-2]);return h>1&&Bu(c)===f&&u[u.length-1].path!==f?u.findIndex(ps.bind(null,l[h-2])):d}),n=ue(()=>s.value>-1&&bv(e.params,i.value.params)),o=ue(()=>s.value>-1&&s.value===e.matched.length-1&&Ip(e.params,i.value.params));function a(l={}){return xv(l)?t[Ut(r.replace)?"replace":"push"](Ut(r.to)).catch(Ks):Promise.resolve()}return{route:i,href:ue(()=>i.value.href),isActive:n,isExactActive:o,navigate:a}}const _v=nr({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Mu,setup(r,{slots:t}){const e=Zr(Mu(r)),{options:i}=tr(ac),s=ue(()=>({[Du(r.activeClass,i.linkActiveClass,"router-link-active")]:e.isActive,[Du(r.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:e.isExactActive}));return()=>{const n=t.default&&t.default(e);return r.custom?n:ic("a",{"aria-current":e.isExactActive?r.ariaCurrentValue:null,href:e.href,onClick:e.navigate,class:s.value},n)}}}),vv=_v;function xv(r){if(!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)&&!r.defaultPrevented&&!(r.button!==void 0&&r.button!==0)){if(r.currentTarget&&r.currentTarget.getAttribute){const t=r.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return r.preventDefault&&r.preventDefault(),!0}}function bv(r,t){for(const e in t){const i=t[e],s=r[e];if(typeof i=="string"){if(i!==s)return!1}else if(!ke(s)||s.length!==i.length||i.some((n,o)=>n!==s[o]))return!1}return!0}function Bu(r){return r?r.aliasOf?r.aliasOf.path:r.path:""}const Du=(r,t,e)=>r??t??e,Ev=nr({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(r,{attrs:t,slots:e}){const i=tr(Nl),s=ue(()=>r.route||i.value),n=tr(Ru,0),o=ue(()=>{let h=Ut(n);const{matched:c}=s.value;let u;for(;(u=c[h])&&!u.components;)h++;return h}),a=ue(()=>s.value.matched[o.value]);so(Ru,ue(()=>o.value+1)),so(gv,a),so(Nl,s);const l=oe();return Xr(()=>[l.value,a.value,r.name],([h,c,u],[d,f,p])=>{c&&(c.instances[u]=h,f&&f!==c&&h&&h===d&&(c.leaveGuards.size||(c.leaveGuards=f.leaveGuards),c.updateGuards.size||(c.updateGuards=f.updateGuards))),h&&c&&(!f||!ps(c,f)||!d)&&(c.enterCallbacks[u]||[]).forEach(m=>m(h))},{flush:"post"}),()=>{const h=s.value,c=r.name,u=a.value,d=u&&u.components[c];if(!d)return Fu(e.default,{Component:d,route:h});const f=u.props[c],p=f?f===!0?h.params:typeof f=="function"?f(h):f:null,g=ic(d,Ct({},p,t,{onVnodeUnmounted:y=>{y.component.isUnmounted&&(u.instances[c]=null)},ref:l}));return Fu(e.default,{Component:g,route:h})||g}}});function Fu(r,t){if(!r)return null;const e=r(t);return e.length===1?e[0]:e}const Tv=Ev;function wv(r){const t=Z0(r.routes,r),e=r.parseQuery||pv,i=r.stringifyQuery||Pu,s=r.history,n=Rs(),o=Rs(),a=Rs(),l=my(Ir);let h=Ir;Vi&&r.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=Ia.bind(null,R=>""+R),u=Ia.bind(null,fv),d=Ia.bind(null,So);function f(R,V){let k,Z;return Rp(R)?(k=t.getRecordMatcher(R),Z=V):Z=R,t.addRoute(Z,k)}function p(R){const V=t.getRecordMatcher(R);V&&t.removeRoute(V)}function m(){return t.getRoutes().map(R=>R.record)}function g(R){return!!t.getRecordMatcher(R)}function y(R,V){if(V=Ct({},V||l.value),typeof R=="string"){const w=Pa(e,R,V.path),P=t.resolve({path:w.path},V),B=s.createHref(w.fullPath);return Ct(w,P,{params:d(P.params),hash:So(w.hash),redirectedFrom:void 0,href:B})}let k;if("path"in R)k=Ct({},R,{path:Pa(e,R.path,V.path).path});else{const w=Ct({},R.params);for(const P in w)w[P]==null&&delete w[P];k=Ct({},R,{params:u(w)}),V.params=u(V.params)}const Z=t.resolve(k,V),ot=R.hash||"";Z.params=c(d(Z.params));const v=S0(i,Ct({},R,{hash:cv(ot),path:Z.path})),E=s.createHref(v);return Ct({fullPath:v,hash:ot,query:i===Pu?mv(R.query):R.query||{}},Z,{redirectedFrom:void 0,href:E})}function x(R){return typeof R=="string"?Pa(e,R,l.value.path):Ct({},R)}function _(R,V){if(h!==R)return ms(8,{from:V,to:R})}function b(R){return M(R)}function S(R){return b(Ct(x(R),{replace:!0}))}function D(R){const V=R.matched[R.matched.length-1];if(V&&V.redirect){const{redirect:k}=V;let Z=typeof k=="function"?k(R):k;return typeof Z=="string"&&(Z=Z.includes("?")||Z.includes("#")?Z=x(Z):{path:Z},Z.params={}),Ct({query:R.query,hash:R.hash,params:"path"in Z?{}:R.params},Z)}}function M(R,V){const k=h=y(R),Z=l.value,ot=R.state,v=R.force,E=R.replace===!0,w=D(k);if(w)return M(Ct(x(w),{state:typeof w=="object"?Ct({},ot,w.state):ot,force:v,replace:E}),V||k);const P=k;P.redirectedFrom=V;let B;return!v&&C0(i,Z,k)&&(B=ms(16,{to:P,from:Z}),G(Z,Z,!0,!1)),(B?Promise.resolve(B):F(P,Z)).catch(N=>lr(N)?lr(N,2)?N:H(N):K(N,P,Z)).then(N=>{if(N){if(lr(N,2))return M(Ct({replace:E},x(N.to),{state:typeof N.to=="object"?Ct({},ot,N.to.state):ot,force:v}),V||P)}else N=C(P,Z,!0,E,ot);return q(P,Z,N),N})}function T(R,V){const k=_(R,V);return k?Promise.reject(k):Promise.resolve()}function I(R){const V=Tt.values().next().value;return V&&typeof V.runWithContext=="function"?V.runWithContext(R):R()}function F(R,V){let k;const[Z,ot,v]=Av(R,V);k=Ra(Z.reverse(),"beforeRouteLeave",R,V);for(const w of Z)w.leaveGuards.forEach(P=>{k.push(Or(P,R,V))});const E=T.bind(null,R,V);return k.push(E),_t(k).then(()=>{k=[];for(const w of n.list())k.push(Or(w,R,V));return k.push(E),_t(k)}).then(()=>{k=Ra(ot,"beforeRouteUpdate",R,V);for(const w of ot)w.updateGuards.forEach(P=>{k.push(Or(P,R,V))});return k.push(E),_t(k)}).then(()=>{k=[];for(const w of v)if(w.beforeEnter)if(ke(w.beforeEnter))for(const P of w.beforeEnter)k.push(Or(P,R,V));else k.push(Or(w.beforeEnter,R,V));return k.push(E),_t(k)}).then(()=>(R.matched.forEach(w=>w.enterCallbacks={}),k=Ra(v,"beforeRouteEnter",R,V),k.push(E),_t(k))).then(()=>{k=[];for(const w of o.list())k.push(Or(w,R,V));return k.push(E),_t(k)}).catch(w=>lr(w,8)?w:Promise.reject(w))}function q(R,V,k){a.list().forEach(Z=>I(()=>Z(R,V,k)))}function C(R,V,k,Z,ot){const v=_(R,V);if(v)return v;const E=V===Ir,w=Vi?history.state:{};k&&(Z||E?s.replace(R.fullPath,Ct({scroll:E&&w&&w.scroll},ot)):s.push(R.fullPath,ot)),l.value=R,G(R,V,k,E),H()}let A;function O(){A||(A=s.listen((R,V,k)=>{if(!Ft.listening)return;const Z=y(R),ot=D(Z);if(ot){M(Ct(ot,{replace:!0}),Z).catch(Ks);return}h=Z;const v=l.value;Vi&&O0(bu(v.fullPath,k.delta),la()),F(Z,v).catch(E=>lr(E,12)?E:lr(E,2)?(M(E.to,Z).then(w=>{lr(w,20)&&!k.delta&&k.type===un.pop&&s.go(-1,!1)}).catch(Ks),Promise.reject()):(k.delta&&s.go(-k.delta,!1),K(E,Z,v))).then(E=>{E=E||C(Z,v,!1),E&&(k.delta&&!lr(E,8)?s.go(-k.delta,!1):k.type===un.pop&&lr(E,20)&&s.go(-1,!1)),q(Z,v,E)}).catch(Ks)}))}let Q=Rs(),X=Rs(),z;function K(R,V,k){H(R);const Z=X.list();return Z.length?Z.forEach(ot=>ot(R,V,k)):console.error(R),Promise.reject(R)}function St(){return z&&l.value!==Ir?Promise.resolve():new Promise((R,V)=>{Q.add([R,V])})}function H(R){return z||(z=!R,O(),Q.list().forEach(([V,k])=>R?k(R):V()),Q.reset()),R}function G(R,V,k,Z){const{scrollBehavior:ot}=r;if(!Vi||!ot)return Promise.resolve();const v=!k&&N0(bu(R.fullPath,0))||(Z||!k)&&history.state&&history.state.scroll||null;return jh().then(()=>ot(R,V,v)).then(E=>E&&F0(E)).catch(E=>K(E,R,V))}const ut=R=>s.go(R);let Et;const Tt=new Set,Ft={currentRoute:l,listening:!0,addRoute:f,removeRoute:p,hasRoute:g,getRoutes:m,resolve:y,options:r,push:b,replace:S,go:ut,back:()=>ut(-1),forward:()=>ut(1),beforeEach:n.add,beforeResolve:o.add,afterEach:a.add,onError:X.add,isReady:St,install(R){const V=this;R.component("RouterLink",vv),R.component("RouterView",Tv),R.config.globalProperties.$router=V,Object.defineProperty(R.config.globalProperties,"$route",{enumerable:!0,get:()=>Ut(l)}),Vi&&!Et&&l.value===Ir&&(Et=!0,b(s.location).catch(ot=>{}));const k={};for(const ot in Ir)Object.defineProperty(k,ot,{get:()=>l.value[ot],enumerable:!0});R.provide(ac,V),R.provide(kp,$f(k)),R.provide(Nl,l);const Z=R.unmount;Tt.add(R),R.unmount=function(){Tt.delete(R),Tt.size<1&&(h=Ir,A&&A(),A=null,l.value=Ir,Et=!1,z=!1),Z()}}};function _t(R){return R.reduce((V,k)=>V.then(()=>I(k)),Promise.resolve())}return Ft}function Av(r,t){const e=[],i=[],s=[],n=Math.max(t.matched.length,r.matched.length);for(let o=0;o<n;o++){const a=t.matched[o];a&&(r.matched.find(h=>ps(h,a))?i.push(a):e.push(a));const l=r.matched[o];l&&(t.matched.find(h=>ps(h,l))||s.push(l))}return[e,i,s]}const ws=_0("config",()=>{const t=oe(2),e=oe(!0),i=oe("select"),s=oe("#ffffff"),n=Zr({width:1,color:"#000000",style:"solid",alpha:1,type:"stroke",fillColor:"transparent",fillStyle:"simple",extremePoint_left:"none",extremePoint_right:"arrow",horn:"right"});return{pixiApp:null,scale:t,isCollapsed:e,drawType:i,bgColor:s,styleConfig:n}}),Sv={class:"header"},Cv=["title","onClick"],Iv={class:"tips"},Pv=nr({__name:"Tabbar",setup(r){const t={select:"滚动或空格+鼠标左键移动画布"},e=ws(),i=oe(t.select),s=Zr([{title:"选择",name:"icon-zhizhen",action:"select"},{title:"矩形",name:"icon-dantupailie",action:"rect"},{title:"菱形",name:"icon-lingxing",action:"diamond"},{title:"圆",name:"icon-luyin",action:"arc"},{title:"箭头",name:"icon-xiangshangjiantoucuxiao",action:"mark"},{title:"线段",name:"icon-xian",action:"straightLine"},{title:"画笔",name:"icon-Icon_huabi",action:"paintingBrush"},{title:"文本",name:"icon-ziti",action:"text"},{title:"图片",name:"icon-tupian",action:"image"}]);Xr(()=>e.drawType,o=>{o!=="select"&&(e.isCollapsed=!1,e.pixiApp.removeSelected()),i.value=t[o],e.pixiApp.graphicsConfig={...e.pixiApp.graphicsConfig,drawType:o},document.body.style.cursor=o==="select"?"default":"crosshair"});const n=o=>{if(e.drawType=o,o==="image"){const a=document.createElement("input");a.setAttribute("type","file"),a.setAttribute("multiple","false"),a.onchange=()=>{const l=a.files[0],h=URL.createObjectURL(l);yt(e.pixiApp).drawImage(h),e.drawType="select"},a.click()}};return(o,a)=>(Wt(),_e("header",Sv,[(Wt(!0),_e(re,null,Tl(s,l=>(Wt(),_e("span",{key:l.name,class:Er(["item iconfont",[l.name,l.action===Ut(e).drawType&&"active"]]),title:l.title,onClick:h=>n(l.action)},null,10,Cv))),128)),pt("div",Iv,Uh(i.value),1)]))}});const Rv=Qr(Pv,[["__scopeId","data-v-5646ecf2"]]),Mv=r=>(qh("data-v-2987371d"),r=r(),Kh(),r),Bv={class:"grid grid-flow-col auto-cols-min gap-1"},Dv={class:"input-container"},Fv=Mv(()=>pt("div",{class:"shrink-0 w-8 h-full leading-8 text-center bg-theme-color-deep"},"#",-1)),Ov=nr({__name:"InputColor",props:{modelValue:{}},emits:["update:modelValue"],setup(r,{emit:t}){const e=r,i=t,s=ue({get(){return e.modelValue},set(o){i("update:modelValue",o)}}),n=ue({get(){return/^#/.test(e.modelValue)?e.modelValue.slice(1):e.modelValue},set(o){o.length<6||i("update:modelValue",`#${o}`)}});return(o,a)=>(Wt(),_e("div",Bv,[ds(pt("input",{type:"color","onUpdate:modelValue":a[0]||(a[0]=l=>s.value=l),class:Er(["w-8 h-8",n.value==="transparent"&&n.value])},null,2),[[Ml,s.value]]),pt("div",Dv,[Fv,ds(pt("input",{"onUpdate:modelValue":a[1]||(a[1]=l=>n.value=l),type:"text",class:"w-full outline-0 flex-1 indent-2"},null,512),[[Ml,n.value]])])]))}});const Ll=Qr(Ov,[["__scopeId","data-v-2987371d"]]),ha=r=>(qh("data-v-77e05ce9"),r=r(),Kh(),r),Nv={class:"w-full bg-white p-2 md:mt-4 shadow-design rounded"},Lv={class:"item"},kv=ha(()=>pt("h3",{class:"title mt-0"},"描边",-1)),Uv={key:0,class:"item"},Gv=ha(()=>pt("h3",{class:"title"},"背景",-1)),Hv={key:0,class:"item"},$v={class:"title"},Vv={class:"flex"},Xv=["for","title"],zv=["onUpdate:modelValue","value","name","id"],Wv={class:"item"},jv=ha(()=>pt("h3",{class:"title"},"透明度",-1)),Yv=ha(()=>pt("h3",{class:"title"},"操作",-1)),qv=nr({__name:"Config",setup(r){const t=ws(),{drawType:e,styleConfig:i}=Zo(t),s=Zr([{title:"填充",model:"fillStyle",display:["rect","diamond","arc"],radioGroup:[{title:"实心",type:"simple",classes:"icon-yuanjiaochangfangxing"},{title:"线条",type:"line",classes:"icon-legend-45"},{title:"网格",type:"grid",classes:"icon-xian1"}]},{title:"描边宽度",model:"width",radioGroup:[{title:"细",type:1,classes:"icon-xian3"},{title:"适中",type:2,classes:"icon-xian3 font-bold"},{title:"粗",type:4,classes:"icon-zhixiancu font-bold"}]},{title:"描边样式",model:"style",radioGroup:[{title:"实线",type:"solid",classes:"icon-xian3"},{title:"虚线",type:"dashed",classes:"icon-xuxian font-bold"}]},{title:"线条风格",model:"type",display:["rect","diamond","arc","arrow","line"],radioGroup:[{title:"朴素",type:"simple",classes:"icon-jurassic_curve"},{title:"手绘",type:"stroke",classes:"icon-duoquxianqiehuan"}]},{title:"端点左",model:"extremePoint_left",display:["mark"],radioGroup:[{title:"无",type:"none",classes:"icon-toubuduandian"},{title:"箭头",type:"arrow",classes:"icon-jiantou-copy-copy"},{title:"线段",type:"line",classes:"icon-icon_07"}]},{title:"端点右",model:"extremePoint_right",display:["mark"],radioGroup:[{title:"无",type:"none",classes:"icon-toubuduandian"},{title:"箭头",type:"arrow",classes:"icon-jiantou-copy"},{title:"线段",type:"line",classes:"icon-icon_-1"}]},{title:"边角",model:"horn",display:["rect"],radioGroup:[{title:"直角",type:"right",classes:"icon-zhijiao"},{title:"圆角",type:"round",classes:"icon-yuanjiao"}]}]),n=()=>{yt(t.pixiApp).copy()},o=()=>{yt(t.pixiApp).clear(!0)};return(a,l)=>(Wt(),_e("main",Nv,[pt("div",Lv,[kv,Lt(Ll,{modelValue:Ut(i).color,"onUpdate:modelValue":l[0]||(l[0]=h=>Ut(i).color=h)},null,8,["modelValue"])]),["rect","diamond","arc"].includes(Ut(e))?(Wt(),_e("div",Uv,[Gv,Lt(Ll,{modelValue:Ut(i).fillColor,"onUpdate:modelValue":l[1]||(l[1]=h=>Ut(i).fillColor=h)},null,8,["modelValue"])])):Jc("",!0),(Wt(!0),_e(re,null,Tl(s,h=>(Wt(),_e(re,{key:h.model},[!h.display||h.display.includes(Ut(e))?(Wt(),_e("div",Hv,[pt("h3",$v,Uh(h.title),1),pt("div",Vv,[(Wt(!0),_e(re,null,Tl(h.radioGroup,(c,u)=>(Wt(),_e("label",{key:u,for:h.model+u,title:c.title,class:Er(["label",Ut(i)[h.model]===c.type&&"active"])},[ds(pt("input",{"onUpdate:modelValue":d=>Ut(i)[h.model]=d,type:"radio",value:c.type,name:h.model,id:h.model+u,class:"hidden"},null,8,zv),[[n0,Ut(i)[h.model]]]),pt("div",{class:Er(["iconfont",c.classes])},null,2)],10,Xv))),128))])])):Jc("",!0)],64))),128)),pt("div",Wv,[jv,ds(pt("input",{"onUpdate:modelValue":l[2]||(l[2]=h=>Ut(i).alpha=h),step:"0.1",type:"range",min:"0",max:"1",class:"w-10/12"},null,512),[[Ml,Ut(i).alpha]])]),pt("div",{class:"item"},[Yv,pt("div",{class:"flex"},[pt("div",{title:"复制(ctrl+c)",onClick:n,class:"action iconfont icon-fuzhi_copy cursor-pointer hover:bg-theme-color-deep"}),pt("div",{title:"删除(backspace | delete)",onClick:o,class:"action iconfont icon-weibiaoti544 cursor-pointer hover:bg-theme-color-deep"})])])]))}});const Kv=Qr(qv,[["__scopeId","data-v-77e05ce9"]]),Zv={class:"modal"},Qv={class:"modal-content"},Jv={class:"title"},tx=nr({__name:"Pop",props:{title:{}},emits:["statusChange"],setup(r,{expose:t,emit:e}){const i=r,s=e,n=oe(!1);return Xr(n,o=>{s("statusChange",o)}),t({visible:n}),(o,a)=>(Wt(),Ts(v_,{to:"body"},[ds(pt("div",Zv,[Lt(sc,{name:"slide-fade"},{default:ea(()=>[ds(pt("div",Qv,[pt("h3",Jv,[xp(Uh(i.title)+" ",1),pt("i",{class:"iconfont icon-colse close",onClick:a[0]||(a[0]=l=>n.value=!1)})]),Zy(o.$slots,"default",{},void 0,!0)],512),[[hu,n.value]])]),_:3})],512),[[hu,n.value]])]))}});const Up=Qr(tx,[["__scopeId","data-v-c94a08a1"]]),ex=r=>(qh("data-v-361874c1"),r=r(),Kh(),r),rx=ex(()=>pt("p",{class:"my-2.5 px-3"},"这将清空整个画布。是否继续?",-1)),ix={class:"footer"},sx=nr({__name:"ClearPop",setup(r,{expose:t}){const{pixiApp:e}=Zo(ws()),i=oe(),s=()=>{e.value.clear(),i.value.visible=!1};return t({popModal:i}),(n,o)=>(Wt(),Ts(Up,{ref_key:"popModal",ref:i,title:"清空画布"},{default:ea(()=>[rx,pt("div",ix,[pt("button",{onClick:o[0]||(o[0]=a=>i.value.visible=!1)},"取消"),pt("button",{onClick:s},"确定")])]),_:1},512))}});const nx=Qr(sx,[["__scopeId","data-v-361874c1"]]),ox={class:"container-img"},ax=["src"],lx={class:"footer"},hx=nr({__name:"toImagePop",setup(r,{expose:t}){const e=ws(),i=oe(),s=oe(""),n=async a=>{if(a){const l=yt(e.pixiApp);s.value=await l.canvas2Base64()}},o=async a=>{const h=await yt(e.pixiApp).canvas2Base64(a),c=document.createElement("a"),u=Math.random().toString(16).slice(-6);c.setAttribute("href",h),c.setAttribute("download",u),c.click(),URL.revokeObjectURL(h),i.value.visible=!1};return t({popModal:i}),(a,l)=>(Wt(),Ts(Up,{ref_key:"popModal",ref:i,title:"保存图片",onStatusChange:n},{default:ea(()=>[pt("div",ox,[pt("img",{src:s.value,class:"w-full h-full object-contain"},null,8,ax)]),pt("div",lx,[pt("button",{onClick:l[0]||(l[0]=h=>o("image/png"))},"PNG"),pt("button",{onClick:l[1]||(l[1]=h=>o("image/jpeg"))},"JPEG")])]),_:1},512))}});const cx=Qr(hx,[["__scopeId","data-v-dc75a9ae"]]),ux={class:"top"},dx={class:"item bg-transparent hover:bg-transparent text-base p-0"},fx=nr({__name:"Side",setup(r){const{isCollapsed:t,bgColor:e}=Zo(ws()),i=oe(),s=oe();return(n,o)=>(Wt(),_e("aside",{class:Er(["mobile md:pc",[!Ut(t)&&"active"]])},[pt("section",ux,[pt("div",{title:"清空",class:"item iconfont icon-weibiaoti544",onClick:o[0]||(o[0]=a=>i.value.popModal.visible=!0)}),pt("div",{title:"保存图片",class:"item iconfont icon-export-img",onClick:o[1]||(o[1]=a=>s.value.popModal.visible=!0)}),pt("div",{class:"item iconfont icon-dongtaitiaosepan md:hidden",onClick:o[2]||(o[2]=a=>t.value=!Ut(t))}),pt("div",dx,[Lt(Ll,{modelValue:Ut(e),"onUpdate:modelValue":o[3]||(o[3]=a=>Gt(e)?e.value=a:null)},null,8,["modelValue"])])]),pt("section",{class:Er(["middle",[!Ut(t)&&"active"]])},[Lt(Kv)],2),Lt(nx,{ref_key:"clearpop",ref:i},null,512),Lt(cx,{ref_key:"toImagePop",ref:s},null,512)],2))}});const px=Qr(fx,[["__scopeId","data-v-4e43dd7b"]]);var Ri=(r=>(r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2",r))(Ri||{}),Gp=(r=>(r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS",r))(Gp||{}),kl=(r=>(r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL",r))(kl||{}),ct=(r=>(r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR",r))(ct||{}),Qe=(r=>(r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN",r))(Qe||{}),U=(r=>(r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL",r))(U||{}),ss=(r=>(r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",r))(ss||{}),nt=(r=>(r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT",r))(nt||{}),J=(r=>(r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT",r))(J||{}),pr=(r=>(r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR",r))(pr||{}),zr=(r=>(r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",r))(zr||{}),sr=(r=>(r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL",r))(sr||{}),de=(r=>(r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",r))(de||{}),Ye=(r=>(r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT",r))(Ye||{}),lc=(r=>(r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL",r))(lc||{}),Ee=(r=>(r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp",r))(Ee||{}),zt=(r=>(r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE",r[r.COLOR=4]="COLOR",r))(zt||{}),Xt=(r=>(r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH",r))(Xt||{}),er=(r=>(r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",r))(er||{});const mx={createCanvas:(r,t)=>{const e=document.createElement("canvas");return e.width=r,e.height=t,e},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(r,t)=>fetch(r,t),parseXML:r=>new DOMParser().parseFromString(r,"text/xml")},tt={ADAPTER:mx,RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var Ma=/iPhone/i,Ou=/iPod/i,Nu=/iPad/i,Lu=/\biOS-universal(?:.+)Mac\b/i,Ba=/\bAndroid(?:.+)Mobile\b/i,ku=/Android/i,Li=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Rn=/Silk/i,hr=/Windows Phone/i,Uu=/\bWindows(?:.+)ARM\b/i,Gu=/BlackBerry/i,Hu=/BB10/i,$u=/Opera Mini/i,Vu=/\b(CriOS|Chrome)(?:.+)Mobile/i,Xu=/Mobile(?:.+)Firefox\b/i,zu=function(r){return typeof r<"u"&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream>"u"};function gx(r){return function(t){return t.test(r)}}function Wu(r){var t={userAgent:"",platform:"",maxTouchPoints:0};!r&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof r=="string"?t.userAgent=r:r&&r.userAgent&&(t={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0});var e=t.userAgent,i=e.split("[FBAN");typeof i[1]<"u"&&(e=i[0]),i=e.split("Twitter"),typeof i[1]<"u"&&(e=i[0]);var s=gx(e),n={apple:{phone:s(Ma)&&!s(hr),ipod:s(Ou),tablet:!s(Ma)&&(s(Nu)||zu(t))&&!s(hr),universal:s(Lu),device:(s(Ma)||s(Ou)||s(Nu)||s(Lu)||zu(t))&&!s(hr)},amazon:{phone:s(Li),tablet:!s(Li)&&s(Rn),device:s(Li)||s(Rn)},android:{phone:!s(hr)&&s(Li)||!s(hr)&&s(Ba),tablet:!s(hr)&&!s(Li)&&!s(Ba)&&(s(Rn)||s(ku)),device:!s(hr)&&(s(Li)||s(Rn)||s(Ba)||s(ku))||s(/\bokhttp\b/i)},windows:{phone:s(hr),tablet:s(Uu),device:s(hr)||s(Uu)},other:{blackberry:s(Gu),blackberry10:s(Hu),opera:s($u),firefox:s(Xu),chrome:s(Vu),device:s(Gu)||s(Hu)||s($u)||s(Xu)||s(Vu)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}const yx=Wu.default??Wu,mr=yx(globalThis.navigator);tt.RETINA_PREFIX=/@([0-9\.]+)x/;tt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var oo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hp(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function _x(r){if(r.__esModule)return r;var t=r.default;if(typeof t=="function"){var e=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var s=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:function(){return r[i]}})}),e}var $p={exports:{}};(function(r){var t=Object.prototype.hasOwnProperty,e="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(e=!1));function s(l,h,c){this.fn=l,this.context=h,this.once=c||!1}function n(l,h,c,u,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new s(c,u||l,d),p=e?e+h:h;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,h){--l._eventsCount===0?l._events=new i:delete l._events[h]}function a(){this._events=new i,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],c,u;if(this._eventsCount===0)return h;for(u in c=this._events)t.call(c,u)&&h.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(c)):h},a.prototype.listeners=function(h){var c=e?e+h:h,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,p=new Array(f);d<f;d++)p[d]=u[d].fn;return p},a.prototype.listenerCount=function(h){var c=e?e+h:h,u=this._events[c];return u?u.fn?1:u.length:0},a.prototype.emit=function(h,c,u,d,f,p){var m=e?e+h:h;if(!this._events[m])return!1;var g=this._events[m],y=arguments.length,x,_;if(g.fn){switch(g.once&&this.removeListener(h,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,c),!0;case 3:return g.fn.call(g.context,c,u),!0;case 4:return g.fn.call(g.context,c,u,d),!0;case 5:return g.fn.call(g.context,c,u,d,f),!0;case 6:return g.fn.call(g.context,c,u,d,f,p),!0}for(_=1,x=new Array(y-1);_<y;_++)x[_-1]=arguments[_];g.fn.apply(g.context,x)}else{var b=g.length,S;for(_=0;_<b;_++)switch(g[_].once&&this.removeListener(h,g[_].fn,void 0,!0),y){case 1:g[_].fn.call(g[_].context);break;case 2:g[_].fn.call(g[_].context,c);break;case 3:g[_].fn.call(g[_].context,c,u);break;case 4:g[_].fn.call(g[_].context,c,u,d);break;default:if(!x)for(S=1,x=new Array(y-1);S<y;S++)x[S-1]=arguments[S];g[_].fn.apply(g[_].context,x)}}return!0},a.prototype.on=function(h,c,u){return n(this,h,c,u,!1)},a.prototype.once=function(h,c,u){return n(this,h,c,u,!0)},a.prototype.removeListener=function(h,c,u,d){var f=e?e+h:h;if(!this._events[f])return this;if(!c)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===c&&(!d||p.once)&&(!u||p.context===u)&&o(this,f);else{for(var m=0,g=[],y=p.length;m<y;m++)(p[m].fn!==c||d&&!p[m].once||u&&p[m].context!==u)&&g.push(p[m]);g.length?this._events[f]=g.length===1?g[0]:g:o(this,f)}return this},a.prototype.removeAllListeners=function(h){var c;return h?(c=e?e+h:h,this._events[c]&&o(this,c)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,r.exports=a})($p);var vx=$p.exports;const yn=Hp(vx);var hc={exports:{}};hc.exports=ca;hc.exports.default=ca;function ca(r,t,e){e=e||2;var i=t&&t.length,s=i?t[0]*e:r.length,n=Vp(r,0,s,e,!0),o=[];if(!n||n.next===n.prev)return o;var a,l,h,c,u,d,f;if(i&&(n=wx(r,t,n,e)),r.length>80*e){a=h=r[0],l=c=r[1];for(var p=e;p<s;p+=e)u=r[p],d=r[p+1],u<a&&(a=u),d<l&&(l=d),u>h&&(h=u),d>c&&(c=d);f=Math.max(h-a,c-l),f=f!==0?32767/f:0}return dn(n,o,e,a,l,f,0),o}function Vp(r,t,e,i,s){var n,o;if(s===Hl(r,t,e,i)>0)for(n=t;n<e;n+=i)o=ju(n,r[n],r[n+1],o);else for(n=e-i;n>=t;n-=i)o=ju(n,r[n],r[n+1],o);return o&&ua(o,o.next)&&(pn(o),o=o.next),o}function Ci(r,t){if(!r)return r;t||(t=r);var e=r,i;do if(i=!1,!e.steiner&&(ua(e,e.next)||Nt(e.prev,e,e.next)===0)){if(pn(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function dn(r,t,e,i,s,n,o){if(r){!o&&n&&Px(r,i,s,n);for(var a=r,l,h;r.prev!==r.next;){if(l=r.prev,h=r.next,n?bx(r,i,s,n):xx(r)){t.push(l.i/e|0),t.push(r.i/e|0),t.push(h.i/e|0),pn(r),r=h.next,a=h.next;continue}if(r=h,r===a){o?o===1?(r=Ex(Ci(r),t,e),dn(r,t,e,i,s,n,2)):o===2&&Tx(r,t,e,i,s,n):dn(Ci(r),t,e,i,s,n,1);break}}}}function xx(r){var t=r.prev,e=r,i=r.next;if(Nt(t,e,i)>=0)return!1;for(var s=t.x,n=e.x,o=i.x,a=t.y,l=e.y,h=i.y,c=s<n?s<o?s:o:n<o?n:o,u=a<l?a<h?a:h:l<h?l:h,d=s>n?s>o?s:o:n>o?n:o,f=a>l?a>h?a:h:l>h?l:h,p=i.next;p!==t;){if(p.x>=c&&p.x<=d&&p.y>=u&&p.y<=f&&Qi(s,a,n,l,o,h,p.x,p.y)&&Nt(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function bx(r,t,e,i){var s=r.prev,n=r,o=r.next;if(Nt(s,n,o)>=0)return!1;for(var a=s.x,l=n.x,h=o.x,c=s.y,u=n.y,d=o.y,f=a<l?a<h?a:h:l<h?l:h,p=c<u?c<d?c:d:u<d?u:d,m=a>l?a>h?a:h:l>h?l:h,g=c>u?c>d?c:d:u>d?u:d,y=Ul(f,p,t,e,i),x=Ul(m,g,t,e,i),_=r.prevZ,b=r.nextZ;_&&_.z>=y&&b&&b.z<=x;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==s&&_!==o&&Qi(a,c,l,u,h,d,_.x,_.y)&&Nt(_.prev,_,_.next)>=0||(_=_.prevZ,b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==s&&b!==o&&Qi(a,c,l,u,h,d,b.x,b.y)&&Nt(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;_&&_.z>=y;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==s&&_!==o&&Qi(a,c,l,u,h,d,_.x,_.y)&&Nt(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=x;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==s&&b!==o&&Qi(a,c,l,u,h,d,b.x,b.y)&&Nt(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Ex(r,t,e){var i=r;do{var s=i.prev,n=i.next.next;!ua(s,n)&&Xp(s,i,i.next,n)&&fn(s,n)&&fn(n,s)&&(t.push(s.i/e|0),t.push(i.i/e|0),t.push(n.i/e|0),pn(i),pn(i.next),i=r=n),i=i.next}while(i!==r);return Ci(i)}function Tx(r,t,e,i,s,n){var o=r;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&Bx(o,a)){var l=zp(o,a);o=Ci(o,o.next),l=Ci(l,l.next),dn(o,t,e,i,s,n,0),dn(l,t,e,i,s,n,0);return}a=a.next}o=o.next}while(o!==r)}function wx(r,t,e,i){var s=[],n,o,a,l,h;for(n=0,o=t.length;n<o;n++)a=t[n]*i,l=n<o-1?t[n+1]*i:r.length,h=Vp(r,a,l,i,!1),h===h.next&&(h.steiner=!0),s.push(Mx(h));for(s.sort(Ax),n=0;n<s.length;n++)e=Sx(s[n],e);return e}function Ax(r,t){return r.x-t.x}function Sx(r,t){var e=Cx(r,t);if(!e)return t;var i=zp(e,r);return Ci(i,i.next),Ci(e,e.next)}function Cx(r,t){var e=t,i=r.x,s=r.y,n=-1/0,o;do{if(s<=e.y&&s>=e.next.y&&e.next.y!==e.y){var a=e.x+(s-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(a<=i&&a>n&&(n=a,o=e.x<e.next.x?e:e.next,a===i))return o}e=e.next}while(e!==t);if(!o)return null;var l=o,h=o.x,c=o.y,u=1/0,d;e=o;do i>=e.x&&e.x>=h&&i!==e.x&&Qi(s<c?i:n,s,h,c,s<c?n:i,s,e.x,e.y)&&(d=Math.abs(s-e.y)/(i-e.x),fn(e,r)&&(d<u||d===u&&(e.x>o.x||e.x===o.x&&Ix(o,e)))&&(o=e,u=d)),e=e.next;while(e!==l);return o}function Ix(r,t){return Nt(r.prev,r,t.prev)<0&&Nt(t.next,r,r.next)<0}function Px(r,t,e,i){var s=r;do s.z===0&&(s.z=Ul(s.x,s.y,t,e,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==r);s.prevZ.nextZ=null,s.prevZ=null,Rx(s)}function Rx(r){var t,e,i,s,n,o,a,l,h=1;do{for(e=r,r=null,n=null,o=0;e;){for(o++,i=e,a=0,t=0;t<h&&(a++,i=i.nextZ,!!i);t++);for(l=h;a>0||l>0&&i;)a!==0&&(l===0||!i||e.z<=i.z)?(s=e,e=e.nextZ,a--):(s=i,i=i.nextZ,l--),n?n.nextZ=s:r=s,s.prevZ=n,n=s;e=i}n.nextZ=null,h*=2}while(o>1);return r}function Ul(r,t,e,i,s){return r=(r-e)*s|0,t=(t-i)*s|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1}function Mx(r){var t=r,e=r;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==r);return e}function Qi(r,t,e,i,s,n,o,a){return(s-o)*(t-a)>=(r-o)*(n-a)&&(r-o)*(i-a)>=(e-o)*(t-a)&&(e-o)*(n-a)>=(s-o)*(i-a)}function Bx(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!Dx(r,t)&&(fn(r,t)&&fn(t,r)&&Fx(r,t)&&(Nt(r.prev,r,t.prev)||Nt(r,t.prev,t))||ua(r,t)&&Nt(r.prev,r,r.next)>0&&Nt(t.prev,t,t.next)>0)}function Nt(r,t,e){return(t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y)}function ua(r,t){return r.x===t.x&&r.y===t.y}function Xp(r,t,e,i){var s=Bn(Nt(r,t,e)),n=Bn(Nt(r,t,i)),o=Bn(Nt(e,i,r)),a=Bn(Nt(e,i,t));return!!(s!==n&&o!==a||s===0&&Mn(r,e,t)||n===0&&Mn(r,i,t)||o===0&&Mn(e,r,i)||a===0&&Mn(e,t,i))}function Mn(r,t,e){return t.x<=Math.max(r.x,e.x)&&t.x>=Math.min(r.x,e.x)&&t.y<=Math.max(r.y,e.y)&&t.y>=Math.min(r.y,e.y)}function Bn(r){return r>0?1:r<0?-1:0}function Dx(r,t){var e=r;do{if(e.i!==r.i&&e.next.i!==r.i&&e.i!==t.i&&e.next.i!==t.i&&Xp(e,e.next,r,t))return!0;e=e.next}while(e!==r);return!1}function fn(r,t){return Nt(r.prev,r,r.next)<0?Nt(r,t,r.next)>=0&&Nt(r,r.prev,t)>=0:Nt(r,t,r.prev)<0||Nt(r,r.next,t)<0}function Fx(r,t){var e=r,i=!1,s=(r.x+t.x)/2,n=(r.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&s<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==r);return i}function zp(r,t){var e=new Gl(r.i,r.x,r.y),i=new Gl(t.i,t.x,t.y),s=r.next,n=t.prev;return r.next=t,t.prev=r,e.next=s,s.prev=e,i.next=e,e.prev=i,n.next=i,i.prev=n,i}function ju(r,t,e,i){var s=new Gl(r,t,e);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function pn(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Gl(r,t,e){this.i=r,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}ca.deviation=function(r,t,e,i){var s=t&&t.length,n=s?t[0]*e:r.length,o=Math.abs(Hl(r,0,n,e));if(s)for(var a=0,l=t.length;a<l;a++){var h=t[a]*e,c=a<l-1?t[a+1]*e:r.length;o-=Math.abs(Hl(r,h,c,e))}var u=0;for(a=0;a<i.length;a+=3){var d=i[a]*e,f=i[a+1]*e,p=i[a+2]*e;u+=Math.abs((r[d]-r[p])*(r[f+1]-r[d+1])-(r[d]-r[f])*(r[p+1]-r[d+1]))}return o===0&&u===0?0:Math.abs((u-o)/o)};function Hl(r,t,e,i){for(var s=0,n=t,o=e-i;n<e;n+=i)s+=(r[o]-r[n])*(r[n+1]+r[o+1]),o=n;return s}ca.flatten=function(r){for(var t=r[0][0].length,e={vertices:[],holes:[],dimensions:t},i=0,s=0;s<r.length;s++){for(var n=0;n<r[s].length;n++)for(var o=0;o<t;o++)e.vertices.push(r[s][n][o]);s>0&&(i+=r[s-1].length,e.holes.push(i))}return e};var Ox=hc.exports;const Nx=Hp(Ox);var Co={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Co.exports;(function(r,t){(function(e){var i=t&&!t.nodeType&&t,s=r&&!r.nodeType&&r,n=typeof oo=="object"&&oo;(n.global===n||n.window===n||n.self===n)&&(e=n);var o,a=2147483647,l=36,h=1,c=26,u=38,d=700,f=72,p=128,m="-",g=/^xn--/,y=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=l-h,S=Math.floor,D=String.fromCharCode,M;function T(H){throw new RangeError(_[H])}function I(H,G){for(var ut=H.length,Et=[];ut--;)Et[ut]=G(H[ut]);return Et}function F(H,G){var ut=H.split("@"),Et="";ut.length>1&&(Et=ut[0]+"@",H=ut[1]),H=H.replace(x,".");var Tt=H.split("."),Ft=I(Tt,G).join(".");return Et+Ft}function q(H){for(var G=[],ut=0,Et=H.length,Tt,Ft;ut<Et;)Tt=H.charCodeAt(ut++),Tt>=55296&&Tt<=56319&&ut<Et?(Ft=H.charCodeAt(ut++),(Ft&64512)==56320?G.push(((Tt&1023)<<10)+(Ft&1023)+65536):(G.push(Tt),ut--)):G.push(Tt);return G}function C(H){return I(H,function(G){var ut="";return G>65535&&(G-=65536,ut+=D(G>>>10&1023|55296),G=56320|G&1023),ut+=D(G),ut}).join("")}function A(H){return H-48<10?H-22:H-65<26?H-65:H-97<26?H-97:l}function O(H,G){return H+22+75*(H<26)-((G!=0)<<5)}function Q(H,G,ut){var Et=0;for(H=ut?S(H/d):H>>1,H+=S(H/G);H>b*c>>1;Et+=l)H=S(H/b);return S(Et+(b+1)*H/(H+u))}function X(H){var G=[],ut=H.length,Et,Tt=0,Ft=p,_t=f,R,V,k,Z,ot,v,E,w,P;for(R=H.lastIndexOf(m),R<0&&(R=0),V=0;V<R;++V)H.charCodeAt(V)>=128&&T("not-basic"),G.push(H.charCodeAt(V));for(k=R>0?R+1:0;k<ut;){for(Z=Tt,ot=1,v=l;k>=ut&&T("invalid-input"),E=A(H.charCodeAt(k++)),(E>=l||E>S((a-Tt)/ot))&&T("overflow"),Tt+=E*ot,w=v<=_t?h:v>=_t+c?c:v-_t,!(E<w);v+=l)P=l-w,ot>S(a/P)&&T("overflow"),ot*=P;Et=G.length+1,_t=Q(Tt-Z,Et,Z==0),S(Tt/Et)>a-Ft&&T("overflow"),Ft+=S(Tt/Et),Tt%=Et,G.splice(Tt++,0,Ft)}return C(G)}function z(H){var G,ut,Et,Tt,Ft,_t,R,V,k,Z,ot,v=[],E,w,P,B;for(H=q(H),E=H.length,G=p,ut=0,Ft=f,_t=0;_t<E;++_t)ot=H[_t],ot<128&&v.push(D(ot));for(Et=Tt=v.length,Tt&&v.push(m);Et<E;){for(R=a,_t=0;_t<E;++_t)ot=H[_t],ot>=G&&ot<R&&(R=ot);for(w=Et+1,R-G>S((a-ut)/w)&&T("overflow"),ut+=(R-G)*w,G=R,_t=0;_t<E;++_t)if(ot=H[_t],ot<G&&++ut>a&&T("overflow"),ot==G){for(V=ut,k=l;Z=k<=Ft?h:k>=Ft+c?c:k-Ft,!(V<Z);k+=l)B=V-Z,P=l-Z,v.push(D(O(Z+B%P,0))),V=S(B/P);v.push(D(O(V,0))),Ft=Q(ut,w,Et==Tt),ut=0,++Et}++ut,++G}return v.join("")}function K(H){return F(H,function(G){return g.test(G)?X(G.slice(4).toLowerCase()):G})}function St(H){return F(H,function(G){return y.test(G)?"xn--"+z(G):G})}if(o={version:"1.4.1",ucs2:{decode:q,encode:C},decode:X,encode:z,toASCII:St,toUnicode:K},i&&s)if(r.exports==i)s.exports=o;else for(M in o)o.hasOwnProperty(M)&&(i[M]=o[M]);else e.punycode=o})(oo)})(Co,Co.exports);var Lx=Co.exports,kx=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),i=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var s=42;t[e]=s;for(e in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var n=Object.getOwnPropertySymbols(t);if(n.length!==1||n[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(t,e);if(o.value!==s||o.enumerable!==!0)return!1}return!0},Yu=typeof Symbol<"u"&&Symbol,Ux=kx,Gx=function(){return typeof Yu!="function"||typeof Symbol!="function"||typeof Yu("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Ux()},qu={foo:{}},Hx=Object,$x=function(){return{__proto__:qu}.foo===qu.foo&&!({__proto__:null}instanceof Hx)},Vx="Function.prototype.bind called on incompatible ",Xx=Object.prototype.toString,zx=Math.max,Wx="[object Function]",Ku=function(t,e){for(var i=[],s=0;s<t.length;s+=1)i[s]=t[s];for(var n=0;n<e.length;n+=1)i[n+t.length]=e[n];return i},jx=function(t,e){for(var i=[],s=e||0,n=0;s<t.length;s+=1,n+=1)i[n]=t[s];return i},Yx=function(r,t){for(var e="",i=0;i<r.length;i+=1)e+=r[i],i+1<r.length&&(e+=t);return e},qx=function(t){var e=this;if(typeof e!="function"||Xx.apply(e)!==Wx)throw new TypeError(Vx+e);for(var i=jx(arguments,1),s,n=function(){if(this instanceof s){var c=e.apply(this,Ku(i,arguments));return Object(c)===c?c:this}return e.apply(t,Ku(i,arguments))},o=zx(0,e.length-i.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(s=Function("binder","return function ("+Yx(a,",")+"){ return binder.apply(this,arguments); }")(n),e.prototype){var h=function(){};h.prototype=e.prototype,s.prototype=new h,h.prototype=null}return s},Kx=qx,cc=Function.prototype.bind||Kx,Zx=Function.prototype.call,Qx=Object.prototype.hasOwnProperty,Jx=cc,tb=Jx.call(Zx,Qx),bt,gs=SyntaxError,Wp=Function,ns=TypeError,Da=function(r){try{return Wp('"use strict"; return ('+r+").constructor;")()}catch{}},Ti=Object.getOwnPropertyDescriptor;if(Ti)try{Ti({},"")}catch{Ti=null}var Fa=function(){throw new ns},eb=Ti?function(){try{return arguments.callee,Fa}catch{try{return Ti(arguments,"callee").get}catch{return Fa}}}():Fa,ki=Gx(),rb=$x(),Zt=Object.getPrototypeOf||(rb?function(r){return r.__proto__}:null),Xi={},ib=typeof Uint8Array>"u"||!Zt?bt:Zt(Uint8Array),wi={"%AggregateError%":typeof AggregateError>"u"?bt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?bt:ArrayBuffer,"%ArrayIteratorPrototype%":ki&&Zt?Zt([][Symbol.iterator]()):bt,"%AsyncFromSyncIteratorPrototype%":bt,"%AsyncFunction%":Xi,"%AsyncGenerator%":Xi,"%AsyncGeneratorFunction%":Xi,"%AsyncIteratorPrototype%":Xi,"%Atomics%":typeof Atomics>"u"?bt:Atomics,"%BigInt%":typeof BigInt>"u"?bt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?bt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?bt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?bt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?bt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?bt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?bt:FinalizationRegistry,"%Function%":Wp,"%GeneratorFunction%":Xi,"%Int8Array%":typeof Int8Array>"u"?bt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?bt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?bt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ki&&Zt?Zt(Zt([][Symbol.iterator]())):bt,"%JSON%":typeof JSON=="object"?JSON:bt,"%Map%":typeof Map>"u"?bt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!ki||!Zt?bt:Zt(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?bt:Promise,"%Proxy%":typeof Proxy>"u"?bt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?bt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?bt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!ki||!Zt?bt:Zt(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?bt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ki&&Zt?Zt(""[Symbol.iterator]()):bt,"%Symbol%":ki?Symbol:bt,"%SyntaxError%":gs,"%ThrowTypeError%":eb,"%TypedArray%":ib,"%TypeError%":ns,"%Uint8Array%":typeof Uint8Array>"u"?bt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?bt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?bt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?bt:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?bt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?bt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?bt:WeakSet};if(Zt)try{null.error}catch(r){var sb=Zt(Zt(r));wi["%Error.prototype%"]=sb}var nb=function r(t){var e;if(t==="%AsyncFunction%")e=Da("async function () {}");else if(t==="%GeneratorFunction%")e=Da("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=Da("async function* () {}");else if(t==="%AsyncGenerator%"){var i=r("%AsyncGeneratorFunction%");i&&(e=i.prototype)}else if(t==="%AsyncIteratorPrototype%"){var s=r("%AsyncGenerator%");s&&Zt&&(e=Zt(s.prototype))}return wi[t]=e,e},Zu={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},_n=cc,Io=tb,ob=_n.call(Function.call,Array.prototype.concat),ab=_n.call(Function.apply,Array.prototype.splice),Qu=_n.call(Function.call,String.prototype.replace),Po=_n.call(Function.call,String.prototype.slice),lb=_n.call(Function.call,RegExp.prototype.exec),hb=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,cb=/\\(\\)?/g,ub=function(t){var e=Po(t,0,1),i=Po(t,-1);if(e==="%"&&i!=="%")throw new gs("invalid intrinsic syntax, expected closing `%`");if(i==="%"&&e!=="%")throw new gs("invalid intrinsic syntax, expected opening `%`");var s=[];return Qu(t,hb,function(n,o,a,l){s[s.length]=a?Qu(l,cb,"$1"):o||n}),s},db=function(t,e){var i=t,s;if(Io(Zu,i)&&(s=Zu[i],i="%"+s[0]+"%"),Io(wi,i)){var n=wi[i];if(n===Xi&&(n=nb(i)),typeof n>"u"&&!e)throw new ns("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:s,name:i,value:n}}throw new gs("intrinsic "+t+" does not exist!")},Mi=function(t,e){if(typeof t!="string"||t.length===0)throw new ns("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new ns('"allowMissing" argument must be a boolean');if(lb(/^%?[^%]*%?$/,t)===null)throw new gs("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=ub(t),s=i.length>0?i[0]:"",n=db("%"+s+"%",e),o=n.name,a=n.value,l=!1,h=n.alias;h&&(s=h[0],ab(i,ob([0,1],h)));for(var c=1,u=!0;c<i.length;c+=1){var d=i[c],f=Po(d,0,1),p=Po(d,-1);if((f==='"'||f==="'"||f==="`"||p==='"'||p==="'"||p==="`")&&f!==p)throw new gs("property names with quotes must have matching quotes");if((d==="constructor"||!u)&&(l=!0),s+="."+d,o="%"+s+"%",Io(wi,o))a=wi[o];else if(a!=null){if(!(d in a)){if(!e)throw new ns("base intrinsic for "+t+" exists, but the property is not available.");return}if(Ti&&c+1>=i.length){var m=Ti(a,d);u=!!m,u&&"get"in m&&!("originalValue"in m.get)?a=m.get:a=a[d]}else u=Io(a,d),a=a[d];u&&!l&&(wi[o]=a)}}return a},jp={exports:{}},fb=Mi,$l=fb("%Object.defineProperty%",!0),Vl=function(){if($l)try{return $l({},"a",{value:1}),!0}catch{return!1}return!1};Vl.hasArrayLengthDefineBug=function(){if(!Vl())return null;try{return $l([],"length",{value:1}).length!==1}catch{return!0}};var Yp=Vl,pb=Mi,ao=pb("%Object.getOwnPropertyDescriptor%",!0);if(ao)try{ao([],"length")}catch{ao=null}var qp=ao,mb=Yp(),uc=Mi,Qs=mb&&uc("%Object.defineProperty%",!0);if(Qs)try{Qs({},"a",{value:1})}catch{Qs=!1}var gb=uc("%SyntaxError%"),Ui=uc("%TypeError%"),Ju=qp,yb=function(t,e,i){if(!t||typeof t!="object"&&typeof t!="function")throw new Ui("`obj` must be an object or a function`");if(typeof e!="string"&&typeof e!="symbol")throw new Ui("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Ui("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Ui("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Ui("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Ui("`loose`, if provided, must be a boolean");var s=arguments.length>3?arguments[3]:null,n=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,l=!!Ju&&Ju(t,e);if(Qs)Qs(t,e,{configurable:o===null&&l?l.configurable:!o,enumerable:s===null&&l?l.enumerable:!s,value:i,writable:n===null&&l?l.writable:!n});else if(a||!s&&!n&&!o)t[e]=i;else throw new gb("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Kp=Mi,td=yb,_b=Yp(),ed=qp,rd=Kp("%TypeError%"),vb=Kp("%Math.floor%"),xb=function(t,e){if(typeof t!="function")throw new rd("`fn` is not a function");if(typeof e!="number"||e<0||e>4294967295||vb(e)!==e)throw new rd("`length` must be a positive 32-bit integer");var i=arguments.length>2&&!!arguments[2],s=!0,n=!0;if("length"in t&&ed){var o=ed(t,"length");o&&!o.configurable&&(s=!1),o&&!o.writable&&(n=!1)}return(s||n||!i)&&(_b?td(t,"length",e,!0,!0):td(t,"length",e)),t};(function(r){var t=cc,e=Mi,i=xb,s=e("%TypeError%"),n=e("%Function.prototype.apply%"),o=e("%Function.prototype.call%"),a=e("%Reflect.apply%",!0)||t.call(o,n),l=e("%Object.defineProperty%",!0),h=e("%Math.max%");if(l)try{l({},"a",{value:1})}catch{l=null}r.exports=function(d){if(typeof d!="function")throw new s("a function is required");var f=a(t,o,arguments);return i(f,1+h(0,d.length-(arguments.length-1)),!0)};var c=function(){return a(t,n,arguments)};l?l(r.exports,"apply",{value:c}):r.exports.apply=c})(jp);var bb=jp.exports,Zp=Mi,Qp=bb,Eb=Qp(Zp("String.prototype.indexOf")),Tb=function(t,e){var i=Zp(t,!!e);return typeof i=="function"&&Eb(t,".prototype.")>-1?Qp(i):i};const wb={},Ab=Object.freeze(Object.defineProperty({__proto__:null,default:wb},Symbol.toStringTag,{value:"Module"})),Sb=_x(Ab);var dc=typeof Map=="function"&&Map.prototype,Oa=Object.getOwnPropertyDescriptor&&dc?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Ro=dc&&Oa&&typeof Oa.get=="function"?Oa.get:null,id=dc&&Map.prototype.forEach,fc=typeof Set=="function"&&Set.prototype,Na=Object.getOwnPropertyDescriptor&&fc?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Mo=fc&&Na&&typeof Na.get=="function"?Na.get:null,sd=fc&&Set.prototype.forEach,Cb=typeof WeakMap=="function"&&WeakMap.prototype,Js=Cb?WeakMap.prototype.has:null,Ib=typeof WeakSet=="function"&&WeakSet.prototype,tn=Ib?WeakSet.prototype.has:null,Pb=typeof WeakRef=="function"&&WeakRef.prototype,nd=Pb?WeakRef.prototype.deref:null,Rb=Boolean.prototype.valueOf,Mb=Object.prototype.toString,Bb=Function.prototype.toString,Db=String.prototype.match,pc=String.prototype.slice,Ur=String.prototype.replace,Fb=String.prototype.toUpperCase,od=String.prototype.toLowerCase,Jp=RegExp.prototype.test,ad=Array.prototype.concat,qe=Array.prototype.join,Ob=Array.prototype.slice,ld=Math.floor,Xl=typeof BigInt=="function"?BigInt.prototype.valueOf:null,La=Object.getOwnPropertySymbols,zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,ys=typeof Symbol=="function"&&typeof Symbol.iterator=="object",se=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===ys||"symbol")?Symbol.toStringTag:null,tm=Object.prototype.propertyIsEnumerable,hd=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(r){return r.__proto__}:null);function cd(r,t){if(r===1/0||r===-1/0||r!==r||r&&r>-1e3&&r<1e3||Jp.call(/e/,t))return t;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof r=="number"){var i=r<0?-ld(-r):ld(r);if(i!==r){var s=String(i),n=pc.call(t,s.length+1);return Ur.call(s,e,"$&_")+"."+Ur.call(Ur.call(n,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Ur.call(t,e,"$&_")}var Wl=Sb,ud=Wl.custom,dd=rm(ud)?ud:null,Nb=function r(t,e,i,s){var n=e||{};if(Nr(n,"quoteStyle")&&n.quoteStyle!=="single"&&n.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Nr(n,"maxStringLength")&&(typeof n.maxStringLength=="number"?n.maxStringLength<0&&n.maxStringLength!==1/0:n.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=Nr(n,"customInspect")?n.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Nr(n,"indent")&&n.indent!==null&&n.indent!=="	"&&!(parseInt(n.indent,10)===n.indent&&n.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Nr(n,"numericSeparator")&&typeof n.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=n.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return sm(t,n);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var l=String(t);return a?cd(t,l):l}if(typeof t=="bigint"){var h=String(t)+"n";return a?cd(t,h):h}var c=typeof n.depth>"u"?5:n.depth;if(typeof i>"u"&&(i=0),i>=c&&c>0&&typeof t=="object")return jl(t)?"[Array]":"[Object]";var u=t1(n,i);if(typeof s>"u")s=[];else if(im(s,t)>=0)return"[Circular]";function d(A,O,Q){if(O&&(s=Ob.call(s),s.push(O)),Q){var X={depth:n.depth};return Nr(n,"quoteStyle")&&(X.quoteStyle=n.quoteStyle),r(A,X,i+1,s)}return r(A,n,i+1,s)}if(typeof t=="function"&&!fd(t)){var f=zb(t),p=Dn(t,d);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(p.length>0?" { "+qe.call(p,", ")+" }":"")}if(rm(t)){var m=ys?Ur.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):zl.call(t);return typeof t=="object"&&!ys?Ms(m):m}if(Zb(t)){for(var g="<"+od.call(String(t.nodeName)),y=t.attributes||[],x=0;x<y.length;x++)g+=" "+y[x].name+"="+em(Lb(y[x].value),"double",n);return g+=">",t.childNodes&&t.childNodes.length&&(g+="..."),g+="</"+od.call(String(t.nodeName))+">",g}if(jl(t)){if(t.length===0)return"[]";var _=Dn(t,d);return u&&!Jb(_)?"["+Yl(_,u)+"]":"[ "+qe.call(_,", ")+" ]"}if(Ub(t)){var b=Dn(t,d);return!("cause"in Error.prototype)&&"cause"in t&&!tm.call(t,"cause")?"{ ["+String(t)+"] "+qe.call(ad.call("[cause]: "+d(t.cause),b),", ")+" }":b.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+qe.call(b,", ")+" }"}if(typeof t=="object"&&o){if(dd&&typeof t[dd]=="function"&&Wl)return Wl(t,{depth:c-i});if(o!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(Wb(t)){var S=[];return id&&id.call(t,function(A,O){S.push(d(O,t,!0)+" => "+d(A,t))}),pd("Map",Ro.call(t),S,u)}if(qb(t)){var D=[];return sd&&sd.call(t,function(A){D.push(d(A,t))}),pd("Set",Mo.call(t),D,u)}if(jb(t))return ka("WeakMap");if(Kb(t))return ka("WeakSet");if(Yb(t))return ka("WeakRef");if(Hb(t))return Ms(d(Number(t)));if(Vb(t))return Ms(d(Xl.call(t)));if($b(t))return Ms(Rb.call(t));if(Gb(t))return Ms(d(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(t===oo)return"{ [object globalThis] }";if(!kb(t)&&!fd(t)){var M=Dn(t,d),T=hd?hd(t)===Object.prototype:t instanceof Object||t.constructor===Object,I=t instanceof Object?"":"null prototype",F=!T&&se&&Object(t)===t&&se in t?pc.call(Jr(t),8,-1):I?"Object":"",q=T||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",C=q+(F||I?"["+qe.call(ad.call([],F||[],I||[]),": ")+"] ":"");return M.length===0?C+"{}":u?C+"{"+Yl(M,u)+"}":C+"{ "+qe.call(M,", ")+" }"}return String(t)};function em(r,t,e){var i=(e.quoteStyle||t)==="double"?'"':"'";return i+r+i}function Lb(r){return Ur.call(String(r),/"/g,"&quot;")}function jl(r){return Jr(r)==="[object Array]"&&(!se||!(typeof r=="object"&&se in r))}function kb(r){return Jr(r)==="[object Date]"&&(!se||!(typeof r=="object"&&se in r))}function fd(r){return Jr(r)==="[object RegExp]"&&(!se||!(typeof r=="object"&&se in r))}function Ub(r){return Jr(r)==="[object Error]"&&(!se||!(typeof r=="object"&&se in r))}function Gb(r){return Jr(r)==="[object String]"&&(!se||!(typeof r=="object"&&se in r))}function Hb(r){return Jr(r)==="[object Number]"&&(!se||!(typeof r=="object"&&se in r))}function $b(r){return Jr(r)==="[object Boolean]"&&(!se||!(typeof r=="object"&&se in r))}function rm(r){if(ys)return r&&typeof r=="object"&&r instanceof Symbol;if(typeof r=="symbol")return!0;if(!r||typeof r!="object"||!zl)return!1;try{return zl.call(r),!0}catch{}return!1}function Vb(r){if(!r||typeof r!="object"||!Xl)return!1;try{return Xl.call(r),!0}catch{}return!1}var Xb=Object.prototype.hasOwnProperty||function(r){return r in this};function Nr(r,t){return Xb.call(r,t)}function Jr(r){return Mb.call(r)}function zb(r){if(r.name)return r.name;var t=Db.call(Bb.call(r),/^function\s*([\w$]+)/);return t?t[1]:null}function im(r,t){if(r.indexOf)return r.indexOf(t);for(var e=0,i=r.length;e<i;e++)if(r[e]===t)return e;return-1}function Wb(r){if(!Ro||!r||typeof r!="object")return!1;try{Ro.call(r);try{Mo.call(r)}catch{return!0}return r instanceof Map}catch{}return!1}function jb(r){if(!Js||!r||typeof r!="object")return!1;try{Js.call(r,Js);try{tn.call(r,tn)}catch{return!0}return r instanceof WeakMap}catch{}return!1}function Yb(r){if(!nd||!r||typeof r!="object")return!1;try{return nd.call(r),!0}catch{}return!1}function qb(r){if(!Mo||!r||typeof r!="object")return!1;try{Mo.call(r);try{Ro.call(r)}catch{return!0}return r instanceof Set}catch{}return!1}function Kb(r){if(!tn||!r||typeof r!="object")return!1;try{tn.call(r,tn);try{Js.call(r,Js)}catch{return!0}return r instanceof WeakSet}catch{}return!1}function Zb(r){return!r||typeof r!="object"?!1:typeof HTMLElement<"u"&&r instanceof HTMLElement?!0:typeof r.nodeName=="string"&&typeof r.getAttribute=="function"}function sm(r,t){if(r.length>t.maxStringLength){var e=r.length-t.maxStringLength,i="... "+e+" more character"+(e>1?"s":"");return sm(pc.call(r,0,t.maxStringLength),t)+i}var s=Ur.call(Ur.call(r,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,Qb);return em(s,"single",t)}function Qb(r){var t=r.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+Fb.call(t.toString(16))}function Ms(r){return"Object("+r+")"}function ka(r){return r+" { ? }"}function pd(r,t,e,i){var s=i?Yl(e,i):qe.call(e,", ");return r+" ("+t+") {"+s+"}"}function Jb(r){for(var t=0;t<r.length;t++)if(im(r[t],`
`)>=0)return!1;return!0}function t1(r,t){var e;if(r.indent==="	")e="	";else if(typeof r.indent=="number"&&r.indent>0)e=qe.call(Array(r.indent+1)," ");else return null;return{base:e,prev:qe.call(Array(t+1),e)}}function Yl(r,t){if(r.length===0)return"";var e=`
`+t.prev+t.base;return e+qe.call(r,","+e)+`
`+t.prev}function Dn(r,t){var e=jl(r),i=[];if(e){i.length=r.length;for(var s=0;s<r.length;s++)i[s]=Nr(r,s)?t(r[s],r):""}var n=typeof La=="function"?La(r):[],o;if(ys){o={};for(var a=0;a<n.length;a++)o["$"+n[a]]=n[a]}for(var l in r)Nr(r,l)&&(e&&String(Number(l))===l&&l<r.length||ys&&o["$"+l]instanceof Symbol||(Jp.call(/[^\w$]/,l)?i.push(t(l,r)+": "+t(r[l],r)):i.push(l+": "+t(r[l],r))));if(typeof La=="function")for(var h=0;h<n.length;h++)tm.call(r,n[h])&&i.push("["+t(n[h])+"]: "+t(r[n[h]],r));return i}var mc=Mi,As=Tb,e1=Nb,r1=mc("%TypeError%"),Fn=mc("%WeakMap%",!0),On=mc("%Map%",!0),i1=As("WeakMap.prototype.get",!0),s1=As("WeakMap.prototype.set",!0),n1=As("WeakMap.prototype.has",!0),o1=As("Map.prototype.get",!0),a1=As("Map.prototype.set",!0),l1=As("Map.prototype.has",!0),gc=function(r,t){for(var e=r,i;(i=e.next)!==null;e=i)if(i.key===t)return e.next=i.next,i.next=r.next,r.next=i,i},h1=function(r,t){var e=gc(r,t);return e&&e.value},c1=function(r,t,e){var i=gc(r,t);i?i.value=e:r.next={key:t,next:r.next,value:e}},u1=function(r,t){return!!gc(r,t)},d1=function(){var t,e,i,s={assert:function(n){if(!s.has(n))throw new r1("Side channel does not contain "+e1(n))},get:function(n){if(Fn&&n&&(typeof n=="object"||typeof n=="function")){if(t)return i1(t,n)}else if(On){if(e)return o1(e,n)}else if(i)return h1(i,n)},has:function(n){if(Fn&&n&&(typeof n=="object"||typeof n=="function")){if(t)return n1(t,n)}else if(On){if(e)return l1(e,n)}else if(i)return u1(i,n);return!1},set:function(n,o){Fn&&n&&(typeof n=="object"||typeof n=="function")?(t||(t=new Fn),s1(t,n,o)):On?(e||(e=new On),a1(e,n,o)):(i||(i={key:{},next:null}),c1(i,n,o))}};return s},f1=String.prototype.replace,p1=/%20/g,Ua={RFC1738:"RFC1738",RFC3986:"RFC3986"},yc={default:Ua.RFC3986,formatters:{RFC1738:function(r){return f1.call(r,p1,"+")},RFC3986:function(r){return String(r)}},RFC1738:Ua.RFC1738,RFC3986:Ua.RFC3986},m1=yc,Ga=Object.prototype.hasOwnProperty,yi=Array.isArray,$e=function(){for(var r=[],t=0;t<256;++t)r.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return r}(),g1=function(t){for(;t.length>1;){var e=t.pop(),i=e.obj[e.prop];if(yi(i)){for(var s=[],n=0;n<i.length;++n)typeof i[n]<"u"&&s.push(i[n]);e.obj[e.prop]=s}}},nm=function(t,e){for(var i=e&&e.plainObjects?Object.create(null):{},s=0;s<t.length;++s)typeof t[s]<"u"&&(i[s]=t[s]);return i},y1=function r(t,e,i){if(!e)return t;if(typeof e!="object"){if(yi(t))t.push(e);else if(t&&typeof t=="object")(i&&(i.plainObjects||i.allowPrototypes)||!Ga.call(Object.prototype,e))&&(t[e]=!0);else return[t,e];return t}if(!t||typeof t!="object")return[t].concat(e);var s=t;return yi(t)&&!yi(e)&&(s=nm(t,i)),yi(t)&&yi(e)?(e.forEach(function(n,o){if(Ga.call(t,o)){var a=t[o];a&&typeof a=="object"&&n&&typeof n=="object"?t[o]=r(a,n,i):t.push(n)}else t[o]=n}),t):Object.keys(e).reduce(function(n,o){var a=e[o];return Ga.call(n,o)?n[o]=r(n[o],a,i):n[o]=a,n},s)},_1=function(t,e){return Object.keys(e).reduce(function(i,s){return i[s]=e[s],i},t)},v1=function(r,t,e){var i=r.replace(/\+/g," ");if(e==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},x1=function(t,e,i,s,n){if(t.length===0)return t;var o=t;if(typeof t=="symbol"?o=Symbol.prototype.toString.call(t):typeof t!="string"&&(o=String(t)),i==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;++l){var h=o.charCodeAt(l);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||n===m1.RFC1738&&(h===40||h===41)){a+=o.charAt(l);continue}if(h<128){a=a+$e[h];continue}if(h<2048){a=a+($e[192|h>>6]+$e[128|h&63]);continue}if(h<55296||h>=57344){a=a+($e[224|h>>12]+$e[128|h>>6&63]+$e[128|h&63]);continue}l+=1,h=65536+((h&1023)<<10|o.charCodeAt(l)&1023),a+=$e[240|h>>18]+$e[128|h>>12&63]+$e[128|h>>6&63]+$e[128|h&63]}return a},b1=function(t){for(var e=[{obj:{o:t},prop:"o"}],i=[],s=0;s<e.length;++s)for(var n=e[s],o=n.obj[n.prop],a=Object.keys(o),l=0;l<a.length;++l){var h=a[l],c=o[h];typeof c=="object"&&c!==null&&i.indexOf(c)===-1&&(e.push({obj:o,prop:h}),i.push(c))}return g1(e),t},E1=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},T1=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},w1=function(t,e){return[].concat(t,e)},A1=function(t,e){if(yi(t)){for(var i=[],s=0;s<t.length;s+=1)i.push(e(t[s]));return i}return e(t)},om={arrayToObject:nm,assign:_1,combine:w1,compact:b1,decode:v1,encode:x1,isBuffer:T1,isRegExp:E1,maybeMap:A1,merge:y1},am=d1,lo=om,en=yc,S1=Object.prototype.hasOwnProperty,md={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},fr=Array.isArray,C1=Array.prototype.push,lm=function(r,t){C1.apply(r,fr(t)?t:[t])},I1=Date.prototype.toISOString,gd=en.default,ee={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:lo.encode,encodeValuesOnly:!1,format:gd,formatter:en.formatters[gd],indices:!1,serializeDate:function(t){return I1.call(t)},skipNulls:!1,strictNullHandling:!1},P1=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},Ha={},R1=function r(t,e,i,s,n,o,a,l,h,c,u,d,f,p,m,g){for(var y=t,x=g,_=0,b=!1;(x=x.get(Ha))!==void 0&&!b;){var S=x.get(t);if(_+=1,typeof S<"u"){if(S===_)throw new RangeError("Cyclic object value");b=!0}typeof x.get(Ha)>"u"&&(_=0)}if(typeof l=="function"?y=l(e,y):y instanceof Date?y=u(y):i==="comma"&&fr(y)&&(y=lo.maybeMap(y,function(X){return X instanceof Date?u(X):X})),y===null){if(n)return a&&!p?a(e,ee.encoder,m,"key",d):e;y=""}if(P1(y)||lo.isBuffer(y)){if(a){var D=p?e:a(e,ee.encoder,m,"key",d);return[f(D)+"="+f(a(y,ee.encoder,m,"value",d))]}return[f(e)+"="+f(String(y))]}var M=[];if(typeof y>"u")return M;var T;if(i==="comma"&&fr(y))p&&a&&(y=lo.maybeMap(y,a)),T=[{value:y.length>0?y.join(",")||null:void 0}];else if(fr(l))T=l;else{var I=Object.keys(y);T=h?I.sort(h):I}for(var F=s&&fr(y)&&y.length===1?e+"[]":e,q=0;q<T.length;++q){var C=T[q],A=typeof C=="object"&&typeof C.value<"u"?C.value:y[C];if(!(o&&A===null)){var O=fr(y)?typeof i=="function"?i(F,C):F:F+(c?"."+C:"["+C+"]");g.set(t,_);var Q=am();Q.set(Ha,g),lm(M,r(A,O,i,s,n,o,i==="comma"&&p&&fr(y)?null:a,l,h,c,u,d,f,p,m,Q))}}return M},M1=function(t){if(!t)return ee;if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var e=t.charset||ee.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=en.default;if(typeof t.format<"u"){if(!S1.call(en.formatters,t.format))throw new TypeError("Unknown format option provided.");i=t.format}var s=en.formatters[i],n=ee.filter;return(typeof t.filter=="function"||fr(t.filter))&&(n=t.filter),{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:ee.addQueryPrefix,allowDots:typeof t.allowDots>"u"?ee.allowDots:!!t.allowDots,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:ee.charsetSentinel,delimiter:typeof t.delimiter>"u"?ee.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:ee.encode,encoder:typeof t.encoder=="function"?t.encoder:ee.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:ee.encodeValuesOnly,filter:n,format:i,formatter:s,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:ee.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:ee.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:ee.strictNullHandling}},B1=function(r,t){var e=r,i=M1(t),s,n;typeof i.filter=="function"?(n=i.filter,e=n("",e)):fr(i.filter)&&(n=i.filter,s=n);var o=[];if(typeof e!="object"||e===null)return"";var a;t&&t.arrayFormat in md?a=t.arrayFormat:t&&"indices"in t?a=t.indices?"indices":"repeat":a="indices";var l=md[a];if(t&&"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var h=l==="comma"&&t&&t.commaRoundTrip;s||(s=Object.keys(e)),i.sort&&s.sort(i.sort);for(var c=am(),u=0;u<s.length;++u){var d=s[u];i.skipNulls&&e[d]===null||lm(o,R1(e[d],d,l,h,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,c))}var f=o.join(i.delimiter),p=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),f.length>0?p+f:""},_s=om,ql=Object.prototype.hasOwnProperty,D1=Array.isArray,Kt={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:_s.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},F1=function(r){return r.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},hm=function(r,t){return r&&typeof r=="string"&&t.comma&&r.indexOf(",")>-1?r.split(","):r},O1="utf8=%26%2310003%3B",N1="utf8=%E2%9C%93",L1=function(t,e){var i={__proto__:null},s=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,n=e.parameterLimit===1/0?void 0:e.parameterLimit,o=s.split(e.delimiter,n),a=-1,l,h=e.charset;if(e.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===N1?h="utf-8":o[l]===O1&&(h="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var c=o[l],u=c.indexOf("]="),d=u===-1?c.indexOf("="):u+1,f,p;d===-1?(f=e.decoder(c,Kt.decoder,h,"key"),p=e.strictNullHandling?null:""):(f=e.decoder(c.slice(0,d),Kt.decoder,h,"key"),p=_s.maybeMap(hm(c.slice(d+1),e),function(m){return e.decoder(m,Kt.decoder,h,"value")})),p&&e.interpretNumericEntities&&h==="iso-8859-1"&&(p=F1(p)),c.indexOf("[]=")>-1&&(p=D1(p)?[p]:p),ql.call(i,f)?i[f]=_s.combine(i[f],p):i[f]=p}return i},k1=function(r,t,e,i){for(var s=i?t:hm(t,e),n=r.length-1;n>=0;--n){var o,a=r[n];if(a==="[]"&&e.parseArrays)o=[].concat(s);else{o=e.plainObjects?Object.create(null):{};var l=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,h=parseInt(l,10);!e.parseArrays&&l===""?o={0:s}:!isNaN(h)&&a!==l&&String(h)===l&&h>=0&&e.parseArrays&&h<=e.arrayLimit?(o=[],o[h]=s):l!=="__proto__"&&(o[l]=s)}s=o}return s},U1=function(t,e,i,s){if(t){var n=i.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,l=i.depth>0&&o.exec(n),h=l?n.slice(0,l.index):n,c=[];if(h){if(!i.plainObjects&&ql.call(Object.prototype,h)&&!i.allowPrototypes)return;c.push(h)}for(var u=0;i.depth>0&&(l=a.exec(n))!==null&&u<i.depth;){if(u+=1,!i.plainObjects&&ql.call(Object.prototype,l[1].slice(1,-1))&&!i.allowPrototypes)return;c.push(l[1])}return l&&c.push("["+n.slice(l.index)+"]"),k1(c,e,i,s)}},G1=function(t){if(!t)return Kt;if(t.decoder!==null&&t.decoder!==void 0&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=typeof t.charset>"u"?Kt.charset:t.charset;return{allowDots:typeof t.allowDots>"u"?Kt.allowDots:!!t.allowDots,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:Kt.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:Kt.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:Kt.arrayLimit,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Kt.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:Kt.comma,decoder:typeof t.decoder=="function"?t.decoder:Kt.decoder,delimiter:typeof t.delimiter=="string"||_s.isRegExp(t.delimiter)?t.delimiter:Kt.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:Kt.depth,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:Kt.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:Kt.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:Kt.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Kt.strictNullHandling}},H1=function(r,t){var e=G1(t);if(r===""||r===null||typeof r>"u")return e.plainObjects?Object.create(null):{};for(var i=typeof r=="string"?L1(r,e):r,s=e.plainObjects?Object.create(null):{},n=Object.keys(i),o=0;o<n.length;++o){var a=n[o],l=U1(a,i[a],e,typeof r=="string");s=_s.merge(s,l,e)}return e.allowSparse===!0?s:_s.compact(s)},$1=B1,V1=H1,X1=yc,z1={formats:X1,parse:V1,stringify:$1},W1=Lx;function xr(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var j1=/^([a-z0-9.+-]+:)/i,Y1=/:[0-9]*$/,q1=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,K1=["<",">",'"',"`"," ","\r",`
`,"	"],Z1=["{","}","|","\\","^","`"].concat(K1),Kl=["'"].concat(Z1),yd=["%","/","?",";","#"].concat(Kl),_d=["/","?","#"],Q1=255,vd=/^[+a-z0-9A-Z_-]{0,63}$/,J1=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,tE={javascript:!0,"javascript:":!0},Zl={javascript:!0,"javascript:":!0},os={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Ql=z1;function eE(r,t,e){if(r&&typeof r=="object"&&r instanceof xr)return r;var i=new xr;return i.parse(r,t,e),i}xr.prototype.parse=function(r,t,e){if(typeof r!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof r);var i=r.indexOf("?"),s=i!==-1&&i<r.indexOf("#")?"?":"#",n=r.split(s),o=/\\/g;n[0]=n[0].replace(o,"/"),r=n.join(s);var a=r;if(a=a.trim(),!e&&r.split("#").length===1){var l=q1.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],t?this.query=Ql.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=j1.exec(a);if(h){h=h[0];var c=h.toLowerCase();this.protocol=c,a=a.substr(h.length)}if(e||h||a.match(/^\/\/[^@/]+@[^@/]+/)){var u=a.substr(0,2)==="//";u&&!(h&&Zl[h])&&(a=a.substr(2),this.slashes=!0)}if(!Zl[h]&&(u||h&&!os[h])){for(var d=-1,f=0;f<_d.length;f++){var p=a.indexOf(_d[f]);p!==-1&&(d===-1||p<d)&&(d=p)}var m,g;d===-1?g=a.lastIndexOf("@"):g=a.lastIndexOf("@",d),g!==-1&&(m=a.slice(0,g),a=a.slice(g+1),this.auth=decodeURIComponent(m)),d=-1;for(var f=0;f<yd.length;f++){var p=a.indexOf(yd[f]);p!==-1&&(d===-1||p<d)&&(d=p)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var x=this.hostname.split(/\./),f=0,_=x.length;f<_;f++){var b=x[f];if(b&&!b.match(vd)){for(var S="",D=0,M=b.length;D<M;D++)b.charCodeAt(D)>127?S+="x":S+=b[D];if(!S.match(vd)){var T=x.slice(0,f),I=x.slice(f+1),F=b.match(J1);F&&(T.push(F[1]),I.unshift(F[2])),I.length&&(a="/"+I.join(".")+a),this.hostname=T.join(".");break}}}this.hostname.length>Q1?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=W1.toASCII(this.hostname));var q=this.port?":"+this.port:"",C=this.hostname||"";this.host=C+q,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!tE[c])for(var f=0,_=Kl.length;f<_;f++){var A=Kl[f];if(a.indexOf(A)!==-1){var O=encodeURIComponent(A);O===A&&(O=escape(A)),a=a.split(A).join(O)}}var Q=a.indexOf("#");Q!==-1&&(this.hash=a.substr(Q),a=a.slice(0,Q));var X=a.indexOf("?");if(X!==-1?(this.search=a.substr(X),this.query=a.substr(X+1),t&&(this.query=Ql.parse(this.query)),a=a.slice(0,X)):t&&(this.search="",this.query={}),a&&(this.pathname=a),os[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var q=this.pathname||"",z=this.search||"";this.path=q+z}return this.href=this.format(),this};xr.prototype.format=function(){var r=this.auth||"";r&&(r=encodeURIComponent(r),r=r.replace(/%3A/i,":"),r+="@");var t=this.protocol||"",e=this.pathname||"",i=this.hash||"",s=!1,n="";this.host?s=r+this.host:this.hostname&&(s=r+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(n=Ql.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||os[t])&&s!==!1?(s="//"+(s||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):s||(s=""),i&&i.charAt(0)!=="#"&&(i="#"+i),o&&o.charAt(0)!=="?"&&(o="?"+o),e=e.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),t+s+e+o+i};xr.prototype.resolve=function(r){return this.resolveObject(eE(r,!1,!0)).format()};xr.prototype.resolveObject=function(r){if(typeof r=="string"){var t=new xr;t.parse(r,!1,!0),r=t}for(var e=new xr,i=Object.keys(this),s=0;s<i.length;s++){var n=i[s];e[n]=this[n]}if(e.hash=r.hash,r.href==="")return e.href=e.format(),e;if(r.slashes&&!r.protocol){for(var o=Object.keys(r),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(e[l]=r[l])}return os[e.protocol]&&e.hostname&&!e.pathname&&(e.pathname="/",e.path=e.pathname),e.href=e.format(),e}if(r.protocol&&r.protocol!==e.protocol){if(!os[r.protocol]){for(var h=Object.keys(r),c=0;c<h.length;c++){var u=h[c];e[u]=r[u]}return e.href=e.format(),e}if(e.protocol=r.protocol,!r.host&&!Zl[r.protocol]){for(var _=(r.pathname||"").split("/");_.length&&!(r.host=_.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),e.pathname=_.join("/")}else e.pathname=r.pathname;if(e.search=r.search,e.query=r.query,e.host=r.host||"",e.auth=r.auth,e.hostname=r.hostname||r.host,e.port=r.port,e.pathname||e.search){var d=e.pathname||"",f=e.search||"";e.path=d+f}return e.slashes=e.slashes||r.slashes,e.href=e.format(),e}var p=e.pathname&&e.pathname.charAt(0)==="/",m=r.host||r.pathname&&r.pathname.charAt(0)==="/",g=m||p||e.host&&r.pathname,y=g,x=e.pathname&&e.pathname.split("/")||[],_=r.pathname&&r.pathname.split("/")||[],b=e.protocol&&!os[e.protocol];if(b&&(e.hostname="",e.port=null,e.host&&(x[0]===""?x[0]=e.host:x.unshift(e.host)),e.host="",r.protocol&&(r.hostname=null,r.port=null,r.host&&(_[0]===""?_[0]=r.host:_.unshift(r.host)),r.host=null),g=g&&(_[0]===""||x[0]==="")),m)e.host=r.host||r.host===""?r.host:e.host,e.hostname=r.hostname||r.hostname===""?r.hostname:e.hostname,e.search=r.search,e.query=r.query,x=_;else if(_.length)x||(x=[]),x.pop(),x=x.concat(_),e.search=r.search,e.query=r.query;else if(r.search!=null){if(b){e.host=x.shift(),e.hostname=e.host;var S=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;S&&(e.auth=S.shift(),e.hostname=S.shift(),e.host=e.hostname)}return e.search=r.search,e.query=r.query,(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!x.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var D=x.slice(-1)[0],M=(e.host||r.host||x.length>1)&&(D==="."||D==="..")||D==="",T=0,I=x.length;I>=0;I--)D=x[I],D==="."?x.splice(I,1):D===".."?(x.splice(I,1),T++):T&&(x.splice(I,1),T--);if(!g&&!y)for(;T--;T)x.unshift("..");g&&x[0]!==""&&(!x[0]||x[0].charAt(0)!=="/")&&x.unshift(""),M&&x.join("/").substr(-1)!=="/"&&x.push("");var F=x[0]===""||x[0]&&x[0].charAt(0)==="/";if(b){e.hostname=F?"":x.length?x.shift():"",e.host=e.hostname;var S=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;S&&(e.auth=S.shift(),e.hostname=S.shift(),e.host=e.hostname)}return g=g||e.host&&x.length,g&&!F&&x.unshift(""),x.length>0?e.pathname=x.join("/"):(e.pathname=null,e.path=null),(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=r.auth||e.auth,e.slashes=e.slashes||r.slashes,e.href=e.format(),e};xr.prototype.parseHost=function(){var r=this.host,t=Y1.exec(r);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),r=r.substr(0,r.length-t.length)),r&&(this.hostname=r)};const xd={};function vt(r,t,e=3){if(xd[t])return;let i=new Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`):(i=i.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${r}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${r}`),console.warn(i))),xd[t]=!0}function Ce(r){if(typeof r!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(r)}`)}function Bs(r){return r.split("?")[0].split("#")[0]}function rE(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function iE(r,t,e){return r.replace(new RegExp(rE(t),"g"),e)}function sE(r,t){let e="",i=0,s=-1,n=0,o=-1;for(let a=0;a<=r.length;++a){if(a<r.length)o=r.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(s===a-1||n===1))if(s!==a-1&&n===2){if(e.length<2||i!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const l=e.lastIndexOf("/");if(l!==e.length-1){l===-1?(e="",i=0):(e=e.slice(0,l),i=e.length-1-e.lastIndexOf("/")),s=a,n=0;continue}}else if(e.length===2||e.length===1){e="",i=0,s=a,n=0;continue}}t&&(e.length>0?e+="/..":e="..",i=2)}else e.length>0?e+=`/${r.slice(s+1,a)}`:e=r.slice(s+1,a),i=a-s-1;s=a,n=0}else o===46&&n!==-1?++n:n=-1}return e}const Yt={toPosix(r){return iE(r,"\\","/")},isUrl(r){return/^https?:/.test(this.toPosix(r))},isDataUrl(r){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(r)},isBlobUrl(r){return r.startsWith("blob:")},hasProtocol(r){return/^[^/:]+:/.test(this.toPosix(r))},getProtocol(r){Ce(r),r=this.toPosix(r);const t=/^file:\/\/\//.exec(r);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(r);return e?e[0]:""},toAbsolute(r,t,e){if(Ce(r),this.isDataUrl(r)||this.isBlobUrl(r))return r;const i=Bs(this.toPosix(t??tt.ADAPTER.getBaseUrl())),s=Bs(this.toPosix(e??this.rootname(i)));return r=this.toPosix(r),r.startsWith("/")?Yt.join(s,r.slice(1)):this.isAbsolute(r)?r:this.join(i,r)},normalize(r){if(Ce(r),r.length===0)return".";if(this.isDataUrl(r)||this.isBlobUrl(r))return r;r=this.toPosix(r);let t="";const e=r.startsWith("/");this.hasProtocol(r)&&(t=this.rootname(r),r=r.slice(t.length));const i=r.endsWith("/");return r=sE(r,!1),r.length>0&&i&&(r+="/"),e?`/${r}`:t+r},isAbsolute(r){return Ce(r),r=this.toPosix(r),this.hasProtocol(r)?!0:r.startsWith("/")},join(...r){if(r.length===0)return".";let t;for(let e=0;e<r.length;++e){const i=r[e];if(Ce(i),i.length>0)if(t===void 0)t=i;else{const s=r[e-1]??"";this.extname(s)?t+=`/../${i}`:t+=`/${i}`}}return t===void 0?".":this.normalize(t)},dirname(r){if(Ce(r),r.length===0)return".";r=this.toPosix(r);let t=r.charCodeAt(0);const e=t===47;let i=-1,s=!0;const n=this.getProtocol(r),o=r;r=r.slice(n.length);for(let a=r.length-1;a>=1;--a)if(t=r.charCodeAt(a),t===47){if(!s){i=a;break}}else s=!1;return i===-1?e?"/":this.isUrl(o)?n+r:n:e&&i===1?"//":n+r.slice(0,i)},rootname(r){Ce(r),r=this.toPosix(r);let t="";if(r.startsWith("/")?t="/":t=this.getProtocol(r),this.isUrl(r)){const e=r.indexOf("/",t.length);e!==-1?t=r.slice(0,e):t=r,t.endsWith("/")||(t+="/")}return t},basename(r,t){Ce(r),t&&Ce(t),r=Bs(this.toPosix(r));let e=0,i=-1,s=!0,n;if(t!==void 0&&t.length>0&&t.length<=r.length){if(t.length===r.length&&t===r)return"";let o=t.length-1,a=-1;for(n=r.length-1;n>=0;--n){const l=r.charCodeAt(n);if(l===47){if(!s){e=n+1;break}}else a===-1&&(s=!1,a=n+1),o>=0&&(l===t.charCodeAt(o)?--o===-1&&(i=n):(o=-1,i=a))}return e===i?i=a:i===-1&&(i=r.length),r.slice(e,i)}for(n=r.length-1;n>=0;--n)if(r.charCodeAt(n)===47){if(!s){e=n+1;break}}else i===-1&&(s=!1,i=n+1);return i===-1?"":r.slice(e,i)},extname(r){Ce(r),r=Bs(this.toPosix(r));let t=-1,e=0,i=-1,s=!0,n=0;for(let o=r.length-1;o>=0;--o){const a=r.charCodeAt(o);if(a===47){if(!s){e=o+1;break}continue}i===-1&&(s=!1,i=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||i===-1||n===0||n===1&&t===i-1&&t===e+1?"":r.slice(t,i)},parse(r){Ce(r);const t={root:"",dir:"",base:"",ext:"",name:""};if(r.length===0)return t;r=Bs(this.toPosix(r));let e=r.charCodeAt(0);const i=this.isAbsolute(r);let s;t.root=this.rootname(r),i||this.hasProtocol(r)?s=1:s=0;let n=-1,o=0,a=-1,l=!0,h=r.length-1,c=0;for(;h>=s;--h){if(e=r.charCodeAt(h),e===47){if(!l){o=h+1;break}continue}a===-1&&(l=!1,a=h+1),e===46?n===-1?n=h:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||a===-1||c===0||c===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&i?t.base=t.name=r.slice(1,a):t.base=t.name=r.slice(o,a)):(o===0&&i?(t.name=r.slice(1,n),t.base=r.slice(1,a)):(t.name=r.slice(o,n),t.base=r.slice(o,a)),t.ext=r.slice(n,a)),t.dir=this.dirname(r),t},sep:"/",delimiter:":"};let $a;async function nE(){return $a??($a=(async()=>{var n;const r=document.createElement("canvas").getContext("webgl");if(!r)return de.UNPACK;const t=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!t)return de.UNPACK;const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);const i=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,i),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.NONE),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t);const s=new Uint8Array(4);return r.readPixels(0,0,1,1,r.RGBA,r.UNSIGNED_BYTE,s),r.deleteFramebuffer(i),r.deleteTexture(e),(n=r.getExtension("WEBGL_lose_context"))==null||n.loseContext(),s[0]<=s[3]?de.PMA:de.UNPACK})()),$a}let Va;function oE(){return typeof Va>"u"&&(Va=function(){var t;const r={stencil:!0,failIfMajorPerformanceCaveat:tt.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!tt.ADAPTER.getWebGLRenderingContext())return!1;const e=tt.ADAPTER.createCanvas();let i=e.getContext("webgl",r)||e.getContext("experimental-webgl",r);const s=!!((t=i==null?void 0:i.getContextAttributes())!=null&&t.stencil);if(i){const n=i.getExtension("WEBGL_lose_context");n&&n.loseContext()}return i=null,s}catch{return!1}}()),Va}var aE={grad:.9,turn:360,rad:360/(2*Math.PI)},cr=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},Qt=function(r,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*r)/e+0},Te=function(r,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),r>e?e:r>t?r:t},cm=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},bd=function(r){return{r:Te(r.r,0,255),g:Te(r.g,0,255),b:Te(r.b,0,255),a:Te(r.a)}},Xa=function(r){return{r:Qt(r.r),g:Qt(r.g),b:Qt(r.b),a:Qt(r.a,3)}},lE=/^#([0-9a-f]{3,8})$/i,Nn=function(r){var t=r.toString(16);return t.length<2?"0"+t:t},um=function(r){var t=r.r,e=r.g,i=r.b,s=r.a,n=Math.max(t,e,i),o=n-Math.min(t,e,i),a=o?n===t?(e-i)/o:n===e?2+(i-t)/o:4+(t-e)/o:0;return{h:60*(a<0?a+6:a),s:n?o/n*100:0,v:n/255*100,a:s}},dm=function(r){var t=r.h,e=r.s,i=r.v,s=r.a;t=t/360*6,e/=100,i/=100;var n=Math.floor(t),o=i*(1-e),a=i*(1-(t-n)*e),l=i*(1-(1-t+n)*e),h=n%6;return{r:255*[i,a,o,o,l,i][h],g:255*[l,i,i,a,o,o][h],b:255*[o,o,l,i,i,a][h],a:s}},Ed=function(r){return{h:cm(r.h),s:Te(r.s,0,100),l:Te(r.l,0,100),a:Te(r.a)}},Td=function(r){return{h:Qt(r.h),s:Qt(r.s),l:Qt(r.l),a:Qt(r.a,3)}},wd=function(r){return dm((e=(t=r).s,{h:t.h,s:(e*=((i=t.l)<50?i:100-i)/100)>0?2*e/(i+e)*100:0,v:i+e,a:t.a}));var t,e,i},rn=function(r){return{h:(t=um(r)).h,s:(s=(200-(e=t.s))*(i=t.v)/100)>0&&s<200?e*i/100/(s<=100?s:200-s)*100:0,l:s/2,a:t.a};var t,e,i,s},hE=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,cE=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,uE=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,dE=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,Jl={string:[[function(r){var t=lE.exec(r);return t?(r=t[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?Qt(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?Qt(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var t=uE.exec(r)||dE.exec(r);return t?t[2]!==t[4]||t[4]!==t[6]?null:bd({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(r){var t=hE.exec(r)||cE.exec(r);if(!t)return null;var e,i,s=Ed({h:(e=t[1],i=t[2],i===void 0&&(i="deg"),Number(e)*(aE[i]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return wd(s)},"hsl"]],object:[[function(r){var t=r.r,e=r.g,i=r.b,s=r.a,n=s===void 0?1:s;return cr(t)&&cr(e)&&cr(i)?bd({r:Number(t),g:Number(e),b:Number(i),a:Number(n)}):null},"rgb"],[function(r){var t=r.h,e=r.s,i=r.l,s=r.a,n=s===void 0?1:s;if(!cr(t)||!cr(e)||!cr(i))return null;var o=Ed({h:Number(t),s:Number(e),l:Number(i),a:Number(n)});return wd(o)},"hsl"],[function(r){var t=r.h,e=r.s,i=r.v,s=r.a,n=s===void 0?1:s;if(!cr(t)||!cr(e)||!cr(i))return null;var o=function(a){return{h:cm(a.h),s:Te(a.s,0,100),v:Te(a.v,0,100),a:Te(a.a)}}({h:Number(t),s:Number(e),v:Number(i),a:Number(n)});return dm(o)},"hsv"]]},Ad=function(r,t){for(var e=0;e<t.length;e++){var i=t[e][0](r);if(i)return[i,t[e][1]]}return[null,void 0]},fE=function(r){return typeof r=="string"?Ad(r.trim(),Jl.string):typeof r=="object"&&r!==null?Ad(r,Jl.object):[null,void 0]},za=function(r,t){var e=rn(r);return{h:e.h,s:Te(e.s+100*t,0,100),l:e.l,a:e.a}},Wa=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},Sd=function(r,t){var e=rn(r);return{h:e.h,s:e.s,l:Te(e.l+100*t,0,100),a:e.a}},th=function(){function r(t){this.parsed=fE(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return Qt(Wa(this.rgba),2)},r.prototype.isDark=function(){return Wa(this.rgba)<.5},r.prototype.isLight=function(){return Wa(this.rgba)>=.5},r.prototype.toHex=function(){return t=Xa(this.rgba),e=t.r,i=t.g,s=t.b,o=(n=t.a)<1?Nn(Qt(255*n)):"","#"+Nn(e)+Nn(i)+Nn(s)+o;var t,e,i,s,n,o},r.prototype.toRgb=function(){return Xa(this.rgba)},r.prototype.toRgbString=function(){return t=Xa(this.rgba),e=t.r,i=t.g,s=t.b,(n=t.a)<1?"rgba("+e+", "+i+", "+s+", "+n+")":"rgb("+e+", "+i+", "+s+")";var t,e,i,s,n},r.prototype.toHsl=function(){return Td(rn(this.rgba))},r.prototype.toHslString=function(){return t=Td(rn(this.rgba)),e=t.h,i=t.s,s=t.l,(n=t.a)<1?"hsla("+e+", "+i+"%, "+s+"%, "+n+")":"hsl("+e+", "+i+"%, "+s+"%)";var t,e,i,s,n},r.prototype.toHsv=function(){return t=um(this.rgba),{h:Qt(t.h),s:Qt(t.s),v:Qt(t.v),a:Qt(t.a,3)};var t},r.prototype.invert=function(){return Ve({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},r.prototype.saturate=function(t){return t===void 0&&(t=.1),Ve(za(this.rgba,t))},r.prototype.desaturate=function(t){return t===void 0&&(t=.1),Ve(za(this.rgba,-t))},r.prototype.grayscale=function(){return Ve(za(this.rgba,-1))},r.prototype.lighten=function(t){return t===void 0&&(t=.1),Ve(Sd(this.rgba,t))},r.prototype.darken=function(t){return t===void 0&&(t=.1),Ve(Sd(this.rgba,-t))},r.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},r.prototype.alpha=function(t){return typeof t=="number"?Ve({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):Qt(this.rgba.a,3);var e},r.prototype.hue=function(t){var e=rn(this.rgba);return typeof t=="number"?Ve({h:t,s:e.s,l:e.l,a:e.a}):Qt(e.h)},r.prototype.isEqual=function(t){return this.toHex()===Ve(t).toHex()},r}(),Ve=function(r){return r instanceof th?r:new th(r)},Cd=[],pE=function(r){r.forEach(function(t){Cd.indexOf(t)<0&&(t(th,Jl),Cd.push(t))})};function mE(r,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var s in e)i[e[s]]=s;var n={};r.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,h=i[this.toHex()];if(h)return h;if(o!=null&&o.closest){var c=this.toRgb(),u=1/0,d="black";if(!n.length)for(var f in e)n[f]=new r(e[f]).toRgb();for(var p in e){var m=(a=c,l=n[p],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));m<u&&(u=m,d=p)}return d}},t.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":e[a];return l?new r(l).toRgb():null},"name"])}pE([mE]);const zi=class ho{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof ho)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set PIXI.Color#value to null");(this._value===null||!this.isSourceEqual(this._value,t))&&(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}isSourceEqual(t,e){const i=typeof t;if(i!==typeof e)return!1;if(i==="number"||i==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((s,n)=>s===e[n]);if(t!==null&&e!==null){const s=Object.keys(t),n=Object.keys(e);return s.length!==n.length?!1:s.every(o=>t[o]===e[o])}return t===e}toRgba(){const[t,e,i,s]=this._components;return{r:t,g:e,b:i,a:s}}toRgb(){const[t,e,i]=this._components;return{r:t,g:e,b:i}}toRgbaString(){const[t,e,i]=this.toUint8RgbArray();return`rgba(${t},${e},${i},${this.alpha})`}toUint8RgbArray(t){const[e,i,s]=this._components;return t=t??[],t[0]=Math.round(e*255),t[1]=Math.round(i*255),t[2]=Math.round(s*255),t}toRgbArray(t){t=t??[];const[e,i,s]=this._components;return t[0]=e,t[1]=i,t[2]=s,t}toNumber(){return this._int}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,i,s,n]=ho.temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=i,this._components[2]*=s,this._components[3]*=n,this.refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this.refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let i=this._int>>16&255,s=this._int>>8&255,n=this._int&255;return e&&(i=i*t+.5|0,s=s*t+.5|0,n=n*t+.5|0),(t*255<<24)+(i<<16)+(s<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}round(t){const[e,i,s]=this._components;return this._components[0]=Math.round(e*t)/t,this._components[1]=Math.round(i*t)/t,this._components[2]=Math.round(s*t)/t,this.refreshInt(),this._value=null,this}toArray(t){t=t??[];const[e,i,s,n]=this._components;return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t}normalize(t){let e,i,s,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,i=(o>>8&255)/255,s=(o&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,i,s,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,i,s,n=255]=t,e/=255,i/=255,s/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=ho.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const o=Ve(t);o.isValid()&&({r:e,g:i,b:s,a:n}=o.rgba,e/=255,i/=255,s/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=i,this._components[2]=s,this._components[3]=n,this.refreshInt();else throw new Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);const[t,e,i]=this._components;this._int=(t*255<<16)+(e*255<<8)+(i*255|0)}_clamp(t,e=0,i=1){return typeof t=="number"?Math.min(Math.max(t,e),i):(t.forEach((s,n)=>{t[n]=Math.min(Math.max(s,e),i)}),t)}};zi.shared=new zi,zi.temp=new zi,zi.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Bt=zi;function gE(r){return vt("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),Bt.shared.setValue(r).toHex()}function yE(r){return vt("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),Bt.shared.setValue(r).toNumber()}function _E(){const r=[],t=[];for(let i=0;i<32;i++)r[i]=i,t[i]=i;r[ct.NORMAL_NPM]=ct.NORMAL,r[ct.ADD_NPM]=ct.ADD,r[ct.SCREEN_NPM]=ct.SCREEN,t[ct.NORMAL]=ct.NORMAL_NPM,t[ct.ADD]=ct.ADD_NPM,t[ct.SCREEN]=ct.SCREEN_NPM;const e=[];return e.push(t),e.push(r),e}const fm=_E();function pm(r,t){return fm[t?1:0][r]}function vE(r,t=null){const e=r*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${e}`);for(let i=0,s=0;i<e;i+=6,s+=4)t[i+0]=s+0,t[i+1]=s+1,t[i+2]=s+2,t[i+3]=s+0,t[i+4]=s+2,t[i+5]=s+3;return t}function mm(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}function Bo(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function Id(r){return!(r&r-1)&&!!r}function Pd(r){let t=(r>65535?1:0)<<4;r>>>=t;let e=(r>255?1:0)<<3;return r>>>=e,t|=e,e=(r>15?1:0)<<2,r>>>=e,t|=e,e=(r>3?1:0)<<1,r>>>=e,t|=e,t|r>>1}function as(r,t,e){const i=r.length;let s;if(t>=i||e===0)return;e=t+e>i?i-t:e;const n=i-e;for(s=t;s<n;++s)r[s]=r[s+e];r.length=n}function Gr(r){return r===0?0:r<0?-1:1}let xE=0;function Ii(){return++xE}const eh=class{constructor(r,t,e,i){this.left=r,this.top=t,this.right=e,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};eh.EMPTY=new eh(0,0,0,0);let Rd=eh;const Md={},Xe=Object.create(null),Pr=Object.create(null);class bE{constructor(t,e,i){this._canvas=tt.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=i||tt.RESOLUTION,this.resize(t,e)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(t,e){this._checkDestroyed(),this._canvas.width=Math.round(t*this.resolution),this._canvas.height=Math.round(e*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(t){this._checkDestroyed(),this._canvas.width=Math.round(t)}get height(){return this._checkDestroyed(),this._canvas.height}set height(t){this._checkDestroyed(),this._canvas.height=Math.round(t)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(this._canvas===null)throw new TypeError("The CanvasRenderTarget has already been destroyed")}}function Bd(r,t,e){for(let i=0,s=4*e*t;i<t;++i,s+=4)if(r[s+3]!==0)return!1;return!0}function Dd(r,t,e,i,s){const n=4*t;for(let o=i,a=i*n+4*e;o<=s;++o,a+=n)if(r[a+3]!==0)return!1;return!0}function EE(r){const{width:t,height:e}=r,i=r.getContext("2d",{willReadFrequently:!0});if(i===null)throw new TypeError("Failed to get canvas 2D context");const s=i.getImageData(0,0,t,e).data;let n=0,o=0,a=t-1,l=e-1;for(;o<e&&Bd(s,t,o);)++o;if(o===e)return Rd.EMPTY;for(;Bd(s,t,l);)--l;for(;Dd(s,t,n,o,l);)++n;for(;Dd(s,t,a,o,l);)--a;return++a,++l,new Rd(n,o,a,l)}function TE(r){const t=EE(r),{width:e,height:i}=t;let s=null;if(!t.isEmpty()){const n=r.getContext("2d");if(n===null)throw new TypeError("Failed to get canvas 2D context");s=n.getImageData(t.left,t.top,e,i)}return{width:e,height:i,data:s}}function wE(r,t=globalThis.location){if(r.startsWith("data:"))return"";t=t||globalThis.location;const e=new URL(r,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function Tr(r,t=1){var i;const e=(i=tt.RETINA_PREFIX)==null?void 0:i.exec(r);return e?parseFloat(e[1]):t}var Y=(r=>(r.Renderer="renderer",r.Application="application",r.RendererSystem="renderer-webgl-system",r.RendererPlugin="renderer-webgl-plugin",r.CanvasRendererSystem="renderer-canvas-system",r.CanvasRendererPlugin="renderer-canvas-plugin",r.Asset="asset",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser",r))(Y||{});const rh=r=>{if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");r={...typeof r.extension!="object"?{type:r.extension}:r.extension,ref:r}}if(typeof r=="object")r={...r};else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},Fd=(r,t)=>rh(r).priority??t,rt={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...r){return r.map(rh).forEach(t=>{t.type.forEach(e=>{var i,s;return(s=(i=this._removeHandlers)[e])==null?void 0:s.call(i,t)})}),this},add(...r){return r.map(rh).forEach(t=>{t.type.forEach(e=>{const i=this._addHandlers,s=this._queue;i[e]?i[e](t):(s[e]=s[e]||[],s[e].push(t))})}),this},handle(r,t,e){const i=this._addHandlers,s=this._removeHandlers;if(i[r]||s[r])throw new Error(`Extension type ${r} already has a handler`);i[r]=t,s[r]=e;const n=this._queue;return n[r]&&(n[r].forEach(o=>t(o)),delete n[r]),this},handleByMap(r,t){return this.handle(r,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(r,t,e=-1){return this.handle(r,i=>{t.includes(i.ref)||(t.push(i.ref),t.sort((s,n)=>Fd(n,e)-Fd(s,e)))},i=>{const s=t.indexOf(i.ref);s!==-1&&t.splice(s,1)})}};class ih{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const AE=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function SE(r){let t="";for(let e=0;e<r;++e)e>0&&(t+=`
else `),e<r-1&&(t+=`if(test == ${e}.0){}`);return t}function CE(r,t){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);for(;;){const i=AE.replace(/%forloop%/gi,SE(r));if(t.shaderSource(e,i),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))r=r/2|0;else break}return r}const ja=0,Ya=1,qa=2,Ka=3,Za=4,Qa=5;class or{constructor(){this.data=0,this.blendMode=ct.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<ja)}set blend(t){!!(this.data&1<<ja)!==t&&(this.data^=1<<ja)}get offsets(){return!!(this.data&1<<Ya)}set offsets(t){!!(this.data&1<<Ya)!==t&&(this.data^=1<<Ya)}get culling(){return!!(this.data&1<<qa)}set culling(t){!!(this.data&1<<qa)!==t&&(this.data^=1<<qa)}get depthTest(){return!!(this.data&1<<Ka)}set depthTest(t){!!(this.data&1<<Ka)!==t&&(this.data^=1<<Ka)}get depthMask(){return!!(this.data&1<<Qa)}set depthMask(t){!!(this.data&1<<Qa)!==t&&(this.data^=1<<Qa)}get clockwiseFrontFace(){return!!(this.data&1<<Za)}set clockwiseFrontFace(t){!!(this.data&1<<Za)!==t&&(this.data^=1<<Za)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!==ct.NONE,this._blendMode=t}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}static for2d(){const t=new or;return t.depthTest=!1,t.blend=!0,t}}or.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const sh=[];function gm(r,t){if(!r)return null;let e="";if(typeof r=="string"){const i=/\.(\w{3,4})(?:$|\?|#)/i.exec(r);i&&(e=i[1].toLowerCase())}for(let i=sh.length-1;i>=0;--i){const s=sh[i];if(s.test&&s.test(r,e))return new s(r,t)}throw new Error("Unrecognized source type to auto-detect Resource")}class Ne{constructor(t){this.items=[],this._name=t,this._aliasCount=0}emit(t,e,i,s,n,o,a,l){if(arguments.length>8)throw new Error("max arguments reached");const{name:h,items:c}=this;this._aliasCount++;for(let u=0,d=c.length;u<d;u++)c[u][h](t,e,i,s,n,o,a,l);return c===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this}contains(t){return this.items.includes(t)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}Object.defineProperties(Ne.prototype,{dispatch:{value:Ne.prototype.emit},run:{value:Ne.prototype.emit}});class mn{constructor(t=0,e=0){this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Ne("setRealSize"),this.onUpdate=new Ne("update"),this.onError=new Ne("onError")}bind(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)}resize(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(t,e,i){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(t,e){return!1}}class da extends mn{constructor(t,e){const{width:i,height:s}=e||{};if(!i||!s)throw new Error("BufferResource width or height invalid");super(i,s),this.data=t,this.unpackAlignment=e.unpackAlignment??4}upload(t,e,i){const s=t.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,this.unpackAlignment),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===de.UNPACK);const n=e.realWidth,o=e.realHeight;return i.width===n&&i.height===o?s.texSubImage2D(e.target,0,0,0,n,o,e.format,i.type,this.data):(i.width=n,i.height=o,s.texImage2D(e.target,0,i.internalFormat,n,o,0,e.format,i.type,this.data)),!0}dispose(){this.data=null}static test(t){return t===null||t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}const IE={scaleMode:pr.NEAREST,alphaMode:de.NPM},nh=class Wi extends yn{constructor(t=null,e=null){super(),e=Object.assign({},Wi.defaultOptions,e);const{alphaMode:i,mipmap:s,anisotropicLevel:n,scaleMode:o,width:a,height:l,wrapMode:h,format:c,type:u,target:d,resolution:f,resourceOptions:p}=e;t&&!(t instanceof mn)&&(t=gm(t,p),t.internal=!0),this.resolution=f||tt.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=s,this.anisotropicLevel=n,this._wrapMode=h,this._scaleMode=o,this.format=c,this.type=u,this.target=d,this.alphaMode=i,this.uid=Ii(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)}setStyle(t,e){let i;return t!==void 0&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),e!==void 0&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this}setSize(t,e,i){return i=i||this.resolution,this.setRealSize(t*i,e*i,i)}setRealSize(t,e,i){return this.resolution=i||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=Id(this.realWidth)&&Id(this.realHeight)}setResolution(t){const e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT(),this)}setResource(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(t){this.emit("error",this,t)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Pr[this.cacheId],delete Xe[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),Wi.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,e,i=tt.STRICT_TEXTURE_CACHE){const s=typeof t=="string";let n=null;if(s)n=t;else{if(!t._pixiId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${Ii()}`}n=t._pixiId}let o=Pr[n];if(s&&i&&!o)throw new Error(`The cacheId "${n}" does not exist in BaseTextureCache.`);return o||(o=new Wi(t,e),o.cacheId=n,Wi.addToCache(o,n)),o}static fromBuffer(t,e,i,s){t=t||new Float32Array(e*i*4);const n=new da(t,{width:e,height:i,...s==null?void 0:s.resourceOptions});let o,a;return t instanceof Float32Array?(o=U.RGBA,a=nt.FLOAT):t instanceof Int32Array?(o=U.RGBA_INTEGER,a=nt.INT):t instanceof Uint32Array?(o=U.RGBA_INTEGER,a=nt.UNSIGNED_INT):t instanceof Int16Array?(o=U.RGBA_INTEGER,a=nt.SHORT):t instanceof Uint16Array?(o=U.RGBA_INTEGER,a=nt.UNSIGNED_SHORT):t instanceof Int8Array?(o=U.RGBA,a=nt.BYTE):(o=U.RGBA,a=nt.UNSIGNED_BYTE),n.internal=!0,new Wi(n,Object.assign({},IE,{type:a,format:o},s))}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Pr[e]&&Pr[e]!==t&&console.warn(`BaseTexture added to the cache with an id [${e}] that already had an entry`),Pr[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=Pr[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete Pr[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)delete Pr[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}};nh.defaultOptions={mipmap:sr.POW2,anisotropicLevel:0,scaleMode:pr.LINEAR,wrapMode:zr.CLAMP,alphaMode:de.UNPACK,target:ss.TEXTURE_2D,format:U.RGBA,type:nt.UNSIGNED_BYTE},nh._globalBatch=0;let ft=nh;class oh{constructor(){this.texArray=null,this.blend=0,this.type=Qe.TRIANGLES,this.start=0,this.size=0,this.data=null}}let PE=0;class Ht{constructor(t,e=!0,i=!1){this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=PE++,this.disposeRunner=new Ne("disposeBuffer")}update(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(t){this.type=t?er.ELEMENT_ARRAY_BUFFER:er.ARRAY_BUFFER}get index(){return this.type===er.ELEMENT_ARRAY_BUFFER}static from(t){return t instanceof Array&&(t=new Float32Array(t)),new Ht(t)}}class Do{constructor(t,e=0,i=!1,s=nt.FLOAT,n,o,a,l=1){this.buffer=t,this.size=e,this.normalized=i,this.type=s,this.stride=n,this.start=o,this.instance=a,this.divisor=l}destroy(){this.buffer=null}static from(t,e,i,s,n){return new Do(t,e,i,s,n)}}const RE={Float32Array,Uint32Array,Int32Array,Uint8Array};function ME(r,t){let e=0,i=0;const s={};for(let l=0;l<r.length;l++)i+=t[l],e+=r[l].length;const n=new ArrayBuffer(e*4);let o=null,a=0;for(let l=0;l<r.length;l++){const h=t[l],c=r[l],u=mm(c);s[u]||(s[u]=new RE[u](n)),o=s[u];for(let d=0;d<c.length;d++){const f=(d/h|0)*i+a,p=d%h;o[f+p]=c[d]}a+=h}return new Float32Array(n)}const Od={5126:4,5123:2,5121:1};let BE=0;const DE={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array};class Yr{constructor(t=[],e={}){this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=BE++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Ne("disposeGeometry"),this.refCount=0}addAttribute(t,e,i=0,s=!1,n,o,a,l=!1){if(!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Ht||(e instanceof Array&&(e=new Float32Array(e)),e=new Ht(e));const h=t.split("|");if(h.length>1){for(let u=0;u<h.length;u++)this.addAttribute(h[u],e,i,s,n);return this}let c=this.buffers.indexOf(e);return c===-1&&(this.buffers.push(e),c=this.buffers.length-1),this.attributes[t]=new Do(c,i,s,n,o,a,l),this.instanced=this.instanced||l,this}getAttribute(t){return this.attributes[t]}getBuffer(t){return this.buffers[this.getAttribute(t).buffer]}addIndex(t){return t instanceof Ht||(t instanceof Array&&(t=new Uint16Array(t)),t=new Ht(t)),t.type=er.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.includes(t)||this.buffers.push(t),this}getIndex(){return this.indexBuffer}interleave(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;const t=[],e=[],i=new Ht;let s;for(s in this.attributes){const n=this.attributes[s],o=this.buffers[n.buffer];t.push(o.data),e.push(n.size*Od[n.type]/4),n.buffer=0}for(i.data=ME(t,e),s=0;s<this.buffers.length;s++)this.buffers[s]!==this.indexBuffer&&this.buffers[s].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(const t in this.attributes){const e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){const t=new Yr;for(let e=0;e<this.buffers.length;e++)t.buffers[e]=new Ht(this.buffers[e].data.slice(0));for(const e in this.attributes){const i=this.attributes[e];t.attributes[e]=new Do(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=er.ELEMENT_ARRAY_BUFFER),t}static merge(t){const e=new Yr,i=[],s=[],n=[];let o;for(let a=0;a<t.length;a++){o=t[a];for(let l=0;l<o.buffers.length;l++)s[l]=s[l]||0,s[l]+=o.buffers[l].data.length,n[l]=0}for(let a=0;a<o.buffers.length;a++)i[a]=new DE[mm(o.buffers[a].data)](s[a]),e.buffers[a]=new Ht(i[a]);for(let a=0;a<t.length;a++){o=t[a];for(let l=0;l<o.buffers.length;l++)i[l].set(o.buffers[l].data,n[l]),n[l]+=o.buffers[l].data.length}if(e.attributes=o.attributes,o.indexBuffer){e.indexBuffer=e.buffers[o.buffers.indexOf(o.indexBuffer)],e.indexBuffer.type=er.ELEMENT_ARRAY_BUFFER;let a=0,l=0,h=0,c=0;for(let u=0;u<o.buffers.length;u++)if(o.buffers[u]!==o.indexBuffer){c=u;break}for(const u in o.attributes){const d=o.attributes[u];(d.buffer|0)===c&&(l+=d.size*Od[d.type]/4)}for(let u=0;u<t.length;u++){const d=t[u].indexBuffer.data;for(let f=0;f<d.length;f++)e.indexBuffer.data[f+h]+=a;a+=t[u].buffers[c].data.length/l,h+=d.length}}return e}}class ym extends Yr{constructor(t=!1){super(),this._buffer=new Ht(null,t,!1),this._indexBuffer=new Ht(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,nt.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,nt.FLOAT).addAttribute("aColor",this._buffer,4,!0,nt.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,nt.FLOAT).addIndex(this._indexBuffer)}}const Fo=Math.PI*2,FE=180/Math.PI,OE=Math.PI/180;var te=(r=>(r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC",r))(te||{});class wt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new wt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}}wt.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const Ln=[new wt,new wt,new wt,new wt];class mt{constructor(t=0,e=0,i=0,s=0){this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(s),this.type=te.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new mt(0,0,0,0)}clone(){return new mt(this.x,this.y,this.width,this.height)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}intersects(t,e){if(!e){const T=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=T)return!1;const I=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>I}const i=this.left,s=this.right,n=this.top,o=this.bottom;if(s<=i||o<=n)return!1;const a=Ln[0].set(t.left,t.top),l=Ln[1].set(t.left,t.bottom),h=Ln[2].set(t.right,t.top),c=Ln[3].set(t.right,t.bottom);if(h.x<=a.x||l.y<=a.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(a,a),e.apply(l,l),e.apply(h,h),e.apply(c,c),Math.max(a.x,l.x,h.x,c.x)<=i||Math.min(a.x,l.x,h.x,c.x)>=s||Math.max(a.y,l.y,h.y,c.y)<=n||Math.min(a.y,l.y,h.y,c.y)>=o))return!1;const d=u*(l.y-a.y),f=u*(a.x-l.x),p=d*i+f*n,m=d*s+f*n,g=d*i+f*o,y=d*s+f*o;if(Math.max(p,m,g,y)<=d*a.x+f*a.y||Math.min(p,m,g,y)>=d*c.x+f*c.y)return!1;const x=u*(a.y-h.y),_=u*(h.x-a.x),b=x*i+_*n,S=x*s+_*n,D=x*i+_*o,M=x*s+_*o;return!(Math.max(b,S,D,M)<=x*a.x+_*a.y||Math.min(b,S,D,M)>=x*c.x+_*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),s=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=s,this.height=Math.max(n-s,0),this}ceil(t=1,e=.001){const i=Math.ceil((this.x+this.width-e)*t)/t,s=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=s-this.y,this}enlarge(t){const e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),s=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=s,this.height=n-s,this}}mt.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class fa{constructor(t=0,e=0,i=0){this.x=t,this.y=e,this.radius=i,this.type=te.CIRC}clone(){return new fa(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const i=this.radius*this.radius;let s=this.x-t,n=this.y-e;return s*=s,n*=n,s+n<=i}getBounds(){return new mt(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}}fa.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class vn{constructor(t=0,e=0,i=0,s=0){this.x=t,this.y=e,this.width=i,this.height=s,this.type=te.ELIP}clone(){return new vn(this.x,this.y,this.width,this.height)}contains(t,e){if(this.width<=0||this.height<=0)return!1;let i=(t-this.x)/this.width,s=(e-this.y)/this.height;return i*=i,s*=s,i+s<=1}getBounds(){return new mt(this.x-this.width,this.y-this.height,this.width,this.height)}}vn.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class br{constructor(...t){let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const i=[];for(let s=0,n=e.length;s<n;s++)i.push(e[s].x,e[s].y);e=i}this.points=e,this.type=te.POLY,this.closeStroke=!0}clone(){const t=this.points.slice(),e=new br(t);return e.closeStroke=this.closeStroke,e}contains(t,e){let i=!1;const s=this.points.length/2;for(let n=0,o=s-1;n<s;o=n++){const a=this.points[n*2],l=this.points[n*2+1],h=this.points[o*2],c=this.points[o*2+1];l>e!=c>e&&t<(h-a)*((e-l)/(c-l))+a&&(i=!i)}return i}}br.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((r,t)=>`${r}, ${t}`,"")}]`};class pa{constructor(t=0,e=0,i=0,s=0,n=20){this.x=t,this.y=e,this.width=i,this.height=s,this.radius=n,this.type=te.RREC}clone(){return new pa(this.x,this.y,this.width,this.height,this.radius)}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let s=t-(this.x+i),n=e-(this.y+i);const o=i*i;if(s*s+n*n<=o||(s=t-(this.x+this.width-i),s*s+n*n<=o)||(n=e-(this.y+this.height-i),s*s+n*n<=o)||(s=t-(this.x+i),s*s+n*n<=o))return!0}return!1}}pa.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class Dt{constructor(t=1,e=0,i=0,s=1,n=0,o=0){this.array=null,this.a=t,this.b=e,this.c=i,this.d=s,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,i,s,n,o){return this.a=t,this.b=e,this.c=i,this.d=s,this.tx=n,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(t,e){e=e||new wt;const i=t.x,s=t.y;return e.x=this.a*i+this.c*s+this.tx,e.y=this.b*i+this.d*s+this.ty,e}applyInverse(t,e){e=e||new wt;const i=1/(this.a*this.d+this.c*-this.b),s=t.x,n=t.y;return e.x=this.d*i*s+-this.c*i*n+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*n+-this.b*i*s+(-this.ty*this.a+this.tx*this.b)*i,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),s=this.a,n=this.c,o=this.tx;return this.a=s*e-this.b*i,this.b=s*i+this.b*e,this.c=n*e-this.d*i,this.d=n*i+this.d*e,this.tx=o*e-this.ty*i,this.ty=o*i+this.ty*e,this}append(t){const e=this.a,i=this.b,s=this.c,n=this.d;return this.a=t.a*e+t.b*s,this.b=t.a*i+t.b*n,this.c=t.c*e+t.d*s,this.d=t.c*i+t.d*n,this.tx=t.tx*e+t.ty*s+this.tx,this.ty=t.tx*i+t.ty*n+this.ty,this}setTransform(t,e,i,s,n,o,a,l,h){return this.a=Math.cos(a+h)*n,this.b=Math.sin(a+h)*n,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=t-(i*this.a+s*this.c),this.ty=e-(i*this.b+s*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const i=this.a,s=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,i=this.b,s=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-s,n),l=Math.atan2(i,e),h=Math.abs(a+l);return h<1e-5||Math.abs(Fo-h)<1e-5?(t.rotation=l,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=l),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(s*s+n*n),t.position.x=this.tx+(o.x*e+o.y*s),t.position.y=this.ty+(o.x*i+o.y*n),t}invert(){const t=this.a,e=this.b,i=this.c,s=this.d,n=this.tx,o=t*s-e*i;return this.a=s/o,this.b=-e/o,this.c=-i/o,this.d=t/o,this.tx=(i*this.ty-s*n)/o,this.ty=-(t*this.ty-e*n)/o,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new Dt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}static get IDENTITY(){return new Dt}static get TEMP_MATRIX(){return new Dt}}Dt.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const ai=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],li=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],hi=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],ci=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],ah=[],_m=[],kn=Math.sign;function NE(){for(let r=0;r<16;r++){const t=[];ah.push(t);for(let e=0;e<16;e++){const i=kn(ai[r]*ai[e]+hi[r]*li[e]),s=kn(li[r]*ai[e]+ci[r]*li[e]),n=kn(ai[r]*hi[e]+hi[r]*ci[e]),o=kn(li[r]*hi[e]+ci[r]*ci[e]);for(let a=0;a<16;a++)if(ai[a]===i&&li[a]===s&&hi[a]===n&&ci[a]===o){t.push(a);break}}}for(let r=0;r<16;r++){const t=new Dt;t.set(ai[r],li[r],hi[r],ci[r],0,0),_m.push(t)}}NE();const Ot={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:r=>ai[r],uY:r=>li[r],vX:r=>hi[r],vY:r=>ci[r],inv:r=>r&8?r&15:-r&7,add:(r,t)=>ah[r][t],sub:(r,t)=>ah[r][Ot.inv(t)],rotate180:r=>r^4,isVertical:r=>(r&3)===2,byDirection:(r,t)=>Math.abs(r)*2<=Math.abs(t)?t>=0?Ot.S:Ot.N:Math.abs(t)*2<=Math.abs(r)?r>0?Ot.E:Ot.W:t>0?r>0?Ot.SE:Ot.SW:r>0?Ot.NE:Ot.NW,matrixAppendRotationInv:(r,t,e=0,i=0)=>{const s=_m[Ot.inv(t)];s.tx=e,s.ty=i,r.append(s)}};class gr{constructor(t,e,i=0,s=0){this._x=i,this._y=s,this.cb=t,this.scope=e}clone(t=this.cb,e=this.scope){return new gr(t,e,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))}}gr.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const lh=class{constructor(){this.worldTransform=new Dt,this.localTransform=new Dt,this.position=new gr(this.onChange,this,0,0),this.scale=new gr(this.onChange,this,1,1),this.pivot=new gr(this.onChange,this,0,0),this.skew=new gr(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){const r=this.localTransform;this._localID!==this._currentLocalID&&(r.a=this._cx*this.scale.x,r.b=this._sx*this.scale.x,r.c=this._cy*this.scale.y,r.d=this._sy*this.scale.y,r.tx=this.position.x-(this.pivot.x*r.a+this.pivot.y*r.c),r.ty=this.position.y-(this.pivot.x*r.b+this.pivot.y*r.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(r){const t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==r._worldID){const e=r.worldTransform,i=this.worldTransform;i.a=t.a*e.a+t.b*e.c,i.b=t.a*e.b+t.b*e.d,i.c=t.c*e.a+t.d*e.c,i.d=t.c*e.b+t.d*e.d,i.tx=t.tx*e.a+t.ty*e.c+e.tx,i.ty=t.tx*e.b+t.ty*e.d+e.ty,this._parentID=r._worldID,this._worldID++}}setFromMatrix(r){r.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(r){this._rotation!==r&&(this._rotation=r,this.updateSkew())}};lh.IDENTITY=new lh;let _c=lh;_c.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var LE=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,kE=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function Nd(r,t,e){const i=r.createShader(t);return r.shaderSource(i,e),r.compileShader(i),i}function Ja(r){const t=new Array(r);for(let e=0;e<t.length;e++)t[e]=!1;return t}function vm(r,t){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return Ja(2*t);case"bvec3":return Ja(3*t);case"bvec4":return Ja(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const ls=[{test:r=>r.type==="float"&&r.size===1&&!r.isArray,code:r=>`
            if(uv["${r}"] !== ud["${r}"].value)
            {
                ud["${r}"].value = uv["${r}"]
                gl.uniform1f(ud["${r}"].location, uv["${r}"])
            }
            `},{test:(r,t)=>(r.type==="sampler2D"||r.type==="samplerCube"||r.type==="sampler2DArray")&&r.size===1&&!r.isArray&&(t==null||t.castToBaseTexture!==void 0),code:r=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${r}"], t);

            if(ud["${r}"].value !== t)
            {
                ud["${r}"].value = t;
                gl.uniform1i(ud["${r}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(r,t)=>r.type==="mat3"&&r.size===1&&!r.isArray&&t.a!==void 0,code:r=>`
            gl.uniformMatrix3fv(ud["${r}"].location, false, uv["${r}"].toArray(true));
            `,codeUbo:r=>`
                var ${r}_matrix = uv.${r}.toArray(true);

                data[offset] = ${r}_matrix[0];
                data[offset+1] = ${r}_matrix[1];
                data[offset+2] = ${r}_matrix[2];
        
                data[offset + 4] = ${r}_matrix[3];
                data[offset + 5] = ${r}_matrix[4];
                data[offset + 6] = ${r}_matrix[5];
        
                data[offset + 8] = ${r}_matrix[6];
                data[offset + 9] = ${r}_matrix[7];
                data[offset + 10] = ${r}_matrix[8];
            `},{test:(r,t)=>r.type==="vec2"&&r.size===1&&!r.isArray&&t.x!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${r}"].location, v.x, v.y);
                }`,codeUbo:r=>`
                v = uv.${r};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:r=>r.type==="vec2"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${r}"].location, v[0], v[1]);
                }
            `},{test:(r,t)=>r.type==="vec4"&&r.size===1&&!r.isArray&&t.width!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${r}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(r,t)=>r.type==="vec4"&&r.size===1&&!r.isArray&&t.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${r}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(r,t)=>r.type==="vec3"&&r.size===1&&!r.isArray&&t.red!==void 0,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${r}"].location, v.red, v.green, v.blue)
                }`,codeUbo:r=>`
                    v = uv.${r};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:r=>r.type==="vec4"&&r.size===1&&!r.isArray,code:r=>`
                cv = ud["${r}"].value;
                v = uv["${r}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${r}"].location, v[0], v[1], v[2], v[3])
                }`}],UE={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},GE={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function HE(r,t){var i;const e=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(const s in r.uniforms){const n=t[s];if(!n){((i=r.uniforms[s])==null?void 0:i.group)===!0&&(r.uniforms[s].ubo?e.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${s}, '${s}');
                    `):e.push(`
                        renderer.shader.syncUniformGroup(uv.${s}, syncData);
                    `));continue}const o=r.uniforms[s];let a=!1;for(let l=0;l<ls.length;l++)if(ls[l].test(n,o)){e.push(ls[l].code(s,o)),a=!0;break}if(!a){const l=(n.size===1&&!n.isArray?UE:GE)[n.type].replace("location",`ud["${s}"].location`);e.push(`
            cu = ud["${s}"];
            cv = cu.value;
            v = uv["${s}"];
            ${l};`)}}return new Function("ud","uv","renderer","syncData",e.join(`
`))}const xm={};let Gi=xm;function $E(){if(Gi===xm||Gi!=null&&Gi.isContextLost()){const r=tt.ADAPTER.createCanvas();let t;tt.PREFER_ENV>=Ri.WEBGL2&&(t=r.getContext("webgl2",{})),t||(t=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),Gi=t}return Gi}let Un;function VE(){if(!Un){Un=Ee.MEDIUM;const r=$E();if(r&&r.getShaderPrecisionFormat){const t=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);t&&(Un=t.precision?Ee.HIGH:Ee.MEDIUM)}}return Un}function Ld(r,t){const e=r.getShaderSource(t).split(`
`).map((h,c)=>`${c}: ${h}`),i=r.getShaderInfoLog(t),s=i.split(`
`),n={},o=s.map(h=>parseFloat(h.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(h=>h&&!n[h]?(n[h]=!0,!0):!1),a=[""];o.forEach(h=>{e[h-1]=`%c${e[h-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=e.join(`
`);a[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}function XE(r,t,e,i){r.getProgramParameter(t,r.LINK_STATUS)||(r.getShaderParameter(e,r.COMPILE_STATUS)||Ld(r,e),r.getShaderParameter(i,r.COMPILE_STATUS)||Ld(r,i),console.error("PixiJS Error: Could not initialize shader."),r.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(t)))}const zE={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function bm(r){return zE[r]}let Gn=null;const kd={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Em(r,t){if(!Gn){const e=Object.keys(kd);Gn={};for(let i=0;i<e.length;++i){const s=e[i];Gn[r[s]]=kd[s]}}return Gn[t]}function Ud(r,t,e){if(r.substring(0,9)!=="precision"){let i=t;return t===Ee.HIGH&&e!==Ee.HIGH&&(i=Ee.MEDIUM),`precision ${i} float;
${r}`}else if(e!==Ee.HIGH&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}let Ds;function WE(){if(typeof Ds=="boolean")return Ds;try{Ds=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{Ds=!1}return Ds}let jE=0;const Hn={},hh=class ji{constructor(t,e,i="pixi-shader",s={}){this.extra={},this.id=jE++,this.vertexSrc=t||ji.defaultVertexSrc,this.fragmentSrc=e||ji.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,this.vertexSrc.substring(0,8)!=="#version"&&(i=i.replace(/\s+/g,"-"),Hn[i]?(Hn[i]++,i+=`-${Hn[i]}`):Hn[i]=1,this.vertexSrc=`#define SHADER_NAME ${i}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${i}
${this.fragmentSrc}`,this.vertexSrc=Ud(this.vertexSrc,ji.defaultVertexPrecision,Ee.HIGH),this.fragmentSrc=Ud(this.fragmentSrc,ji.defaultFragmentPrecision,VE())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return kE}static get defaultFragmentSrc(){return LE}static from(t,e,i){const s=t+e;let n=Md[s];return n||(Md[s]=n=new ji(t,e,i)),n}};hh.defaultVertexPrecision=Ee.HIGH,hh.defaultFragmentPrecision=mr.apple.device?Ee.HIGH:Ee.MEDIUM;let yr=hh,YE=0;class Le{constructor(t,e,i){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=YE++,this.static=!!e,this.ubo=!!i,t instanceof Ht?(this.buffer=t,this.buffer.type=er.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Ht(new Float32Array(1)),this.buffer.type=er.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(t,e,i){if(!this.ubo)this.uniforms[t]=new Le(e,i);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")}static from(t,e,i){return new Le(t,e,i)}static uboFrom(t,e){return new Le(t,e??!0,!0)}}class rr{constructor(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof Le?this.uniformGroup=e:this.uniformGroup=new Le(e):this.uniformGroup=new Le({}),this.disposeRunner=new Ne("disposeShader")}checkUniformExists(t,e){if(e.uniforms[t])return!0;for(const i in e.uniforms){const s=e.uniforms[i];if(s.group===!0&&this.checkUniformExists(t,s))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(t,e,i){const s=yr.from(t,e);return new rr(s,i)}}class qE{constructor(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},!e.includes("%count%"))throw new Error('Fragment template must contain "%count%".');if(!e.includes("%forloop%"))throw new Error('Fragment template must contain "%forloop%".')}generateShader(t){if(!this.programCache[t]){const i=new Int32Array(t);for(let n=0;n<t;n++)i[n]=n;this.defaultGroupCache[t]=Le.from({uSamplers:i},!0);let s=this.fragTemplate;s=s.replace(/%count%/gi,`${t}`),s=s.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new yr(this.vertexSrc,s)}const e={tint:new Float32Array([1,1,1,1]),translationMatrix:new Dt,default:this.defaultGroupCache[t]};return new rr(this.programCache[t],e)}generateSampleSrc(t){let e="";e+=`
`,e+=`
`;for(let i=0;i<t;i++)i>0&&(e+=`
else `),i<t-1&&(e+=`if(vTextureId < ${i}.5)`),e+=`
{`,e+=`
	color = texture2D(uSamplers[${i}], vTextureCoord);`,e+=`
}`;return e+=`
`,e+=`
`,e}}class ch{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let t=0;t<this.count;t++)this.elements[t]=null;this.count=0}}function KE(){return!mr.apple.device}function ZE(r){let t=!0;const e=tt.ADAPTER.getNavigator();if(mr.tablet||mr.phone){if(mr.apple.device){const i=e.userAgent.match(/OS (\d+)_(\d+)?/);i&&parseInt(i[1],10)<11&&(t=!1)}if(mr.android.device){const i=e.userAgent.match(/Android\s([0-9.]*)/);i&&parseInt(i[1],10)<7&&(t=!1)}}return t?r:4}class ma{constructor(t){this.renderer=t}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(t){}}var QE=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,JE=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const ks=class Pe extends ma{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=ym,this.vertexSize=6,this.state=or.for2d(),this.size=Pe.defaultBatchSize*4,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??ZE(32),this._defaultMaxTextures}static set defaultMaxTextures(t){this._defaultMaxTextures=t}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??KE(),this._canUploadSameBuffer}static set canUploadSameBuffer(t){this._canUploadSameBuffer=t}get MAX_TEXTURES(){return vt("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return JE}static get defaultFragmentTemplate(){return QE}setShaderGenerator({vertex:t=Pe.defaultVertexSrc,fragment:e=Pe.defaultFragmentTemplate}={}){this.shaderGenerator=new qE(t,e)}contextChange(){const t=this.renderer.gl;tt.PREFER_ENV===Ri.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Pe.defaultMaxTextures),this.maxTextures=CE(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){const{_drawCallPool:t,_textureArrayPool:e}=Pe,i=this.size/4,s=Math.floor(i/this.maxTextures)+1;for(;t.length<i;)t.push(new oh);for(;e.length<s;)e.push(new ch);for(let n=0;n<this.maxTextures;n++)this._tempBoundTextures[n]=null}onPrerender(){this._flushId=0}render(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)}buildTexturesAndDrawCalls(){const{_bufferedTextures:t,maxTextures:e}=this,i=Pe._textureArrayPool,s=this.renderer.batch,n=this._tempBoundTextures,o=this.renderer.textureGC.count;let a=++ft._globalBatch,l=0,h=i[0],c=0;s.copyBoundTextures(n,e);for(let u=0;u<this._bufferSize;++u){const d=t[u];t[u]=null,d._batchEnabled!==a&&(h.count>=e&&(s.boundArray(h,n,a,e),this.buildDrawCalls(h,c,u),c=u,h=i[++l],++a),d._batchEnabled=a,d.touched=o,h.elements[h.count++]=d)}h.count>0&&(s.boundArray(h,n,a,e),this.buildDrawCalls(h,c,this._bufferSize),++l,++a);for(let u=0;u<n.length;u++)n[u]=null;ft._globalBatch=a}buildDrawCalls(t,e,i){const{_bufferedElements:s,_attributeBuffer:n,_indexBuffer:o,vertexSize:a}=this,l=Pe._drawCallPool;let h=this._dcIndex,c=this._aIndex,u=this._iIndex,d=l[h];d.start=this._iIndex,d.texArray=t;for(let f=e;f<i;++f){const p=s[f],m=p._texture.baseTexture,g=fm[m.alphaMode?1:0][p.blendMode];s[f]=null,e<f&&d.blend!==g&&(d.size=u-d.start,e=f,d=l[++h],d.texArray=t,d.start=u),this.packInterleavedGeometry(p,n,o,c,u),c+=p.vertexData.length/2*a,u+=p.indices.length,d.blend=g}e<i&&(d.size=u-d.start,++h),this._dcIndex=h,this._aIndex=c,this._iIndex=u}bindAndClearTexArray(t){const e=this.renderer.texture;for(let i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0}updateGeometry(){const{_packedGeometries:t,_attributeBuffer:e,_indexBuffer:i}=this;Pe.canUploadSameBuffer?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){const t=this._dcIndex,{gl:e,state:i}=this.renderer,s=Pe._drawCallPool;let n=null;for(let o=0;o<t;o++){const{texArray:a,type:l,size:h,start:c,blend:u}=s[o];n!==a&&(n=a,this.bindAndClearTexArray(a)),this.state.blendMode=u,i.set(this.state),e.drawElements(l,h,e.UNSIGNED_SHORT,c*2)}}flush(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),Pe.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(t){const e=Bo(Math.ceil(t/8)),i=Pd(e),s=e*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);let n=this._aBuffers[s];return n||(this._aBuffers[s]=n=new ih(s*this.vertexSize*4)),n}getIndexBuffer(t){const e=Bo(Math.ceil(t/12)),i=Pd(e),s=e*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);let n=this._iBuffers[i];return n||(this._iBuffers[i]=n=new Uint16Array(s)),n}packInterleavedGeometry(t,e,i,s,n){const{uint32View:o,float32View:a}=e,l=s/this.vertexSize,h=t.uvs,c=t.indices,u=t.vertexData,d=t._texture.baseTexture._batchLocation,f=Math.min(t.worldAlpha,1),p=Bt.shared.setValue(t._tintRGB).toPremultiplied(f,t._texture.baseTexture.alphaMode>0);for(let m=0;m<u.length;m+=2)a[s++]=u[m],a[s++]=u[m+1],a[s++]=h[m],a[s++]=h[m+1],o[s++]=p,a[s++]=d;for(let m=0;m<c.length;m++)i[n++]=l+c[m]}};ks.defaultBatchSize=4096,ks.extension={name:"batch",type:Y.RendererPlugin},ks._drawCallPool=[],ks._textureArrayPool=[];let ui=ks;rt.add(ui);var tT=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,eT=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const uh=class Us extends rr{constructor(t,e,i){const s=yr.from(t||Us.defaultVertexSrc,e||Us.defaultFragmentSrc);super(s,i),this.padding=0,this.resolution=Us.defaultResolution,this.multisample=Us.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new or}apply(t,e,i,s,n){t.applyFilter(this,e,i,s)}get blendMode(){return this.state.blendMode}set blendMode(t){this.state.blendMode=t}get resolution(){return this._resolution}set resolution(t){this._resolution=t}static get defaultVertexSrc(){return eT}static get defaultFragmentSrc(){return tT}};uh.defaultResolution=1,uh.defaultMultisample=Xt.NONE;let ae=uh;class Oo{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new Bt(0),this.alpha=1}init(t){this.clearBeforeRender=t.clearBeforeRender;const{backgroundColor:e,background:i,backgroundAlpha:s}=t,n=i??e;n!==void 0&&(this.color=n),this.alpha=s}get color(){return this._backgroundColor.value}set color(t){this._backgroundColor.setValue(t)}get alpha(){return this._backgroundColor.alpha}set alpha(t){this._backgroundColor.setAlpha(t)}get backgroundColor(){return this._backgroundColor}destroy(){}}Oo.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},Oo.extension={type:[Y.RendererSystem,Y.CanvasRendererSystem],name:"background"};rt.add(Oo);class Tm{constructor(t){this.renderer=t,this.emptyRenderer=new ma(t),this.currentRenderer=this.emptyRenderer}setObjectRenderer(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(t,e){const{boundTextures:i}=this.renderer.texture;for(let s=e-1;s>=0;--s)t[s]=i[s]||null,t[s]&&(t[s]._batchLocation=s)}boundArray(t,e,i,s){const{elements:n,ids:o,count:a}=t;let l=0;for(let h=0;h<a;h++){const c=n[h],u=c._batchLocation;if(u>=0&&u<s&&e[u]===c){o[h]=u;continue}for(;l<s;){const d=e[l];if(d&&d._batchEnabled===i&&d._batchLocation===l){l++;continue}o[h]=l,c._batchLocation=l,e[l]=c;break}}}destroy(){this.renderer=null}}Tm.extension={type:Y.RendererSystem,name:"batch"};rt.add(Tm);let Gd=0;class No{constructor(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Gd++}init(t){if(t.context)this.initFromContext(t.context);else{const e=this.renderer.background.alpha<1,i=t.premultipliedAlpha;this.preserveDrawingBuffer=t.preserveDrawingBuffer,this.useContextAlpha=t.useContextAlpha,this.powerPreference=t.powerPreference,this.initFromOptions({alpha:e,premultipliedAlpha:i,antialias:t.antialias,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference})}}initFromContext(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Gd++,this.renderer.runners.contextChange.emit(t);const e=this.renderer.view;e.addEventListener!==void 0&&(e.addEventListener("webglcontextlost",this.handleContextLost,!1),e.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(t){const e=this.createContext(this.renderer.view,t);this.initFromContext(e)}createContext(t,e){let i;if(tt.PREFER_ENV>=Ri.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!i)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl}getExtensions(){const{gl:t}=this,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})}handleContextLost(t){t.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){const t=this.renderer.view;this.renderer=null,t.removeEventListener!==void 0&&(t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(t){const e=t.getContextAttributes(),i="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;i&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const s=i||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=s,s||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}No.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},No.extension={type:Y.RendererSystem,name:"context"};rt.add(No);class dh{constructor(t,e){if(this.width=Math.round(t),this.height=Math.round(e),!this.width||!this.height)throw new Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Ne("disposeFramebuffer"),this.multisample=Xt.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(t=0,e){return this.colorTextures[t]=e||new ft(null,{scaleMode:pr.NEAREST,resolution:1,mipmap:sr.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(t){return this.depthTexture=t||new ft(null,{scaleMode:pr.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:sr.OFF,format:U.DEPTH_COMPONENT,type:nt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(t,e){if(t=Math.round(t),e=Math.round(e),!t||!e)throw new Error("Framebuffer width and height must not be zero");if(!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(let i=0;i<this.colorTextures.length;i++){const s=this.colorTextures[i],n=s.resolution;s.setSize(t/n,e/n)}if(this.depthTexture){const i=this.depthTexture.resolution;this.depthTexture.setSize(t/i,e/i)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class wm extends ft{constructor(t={}){if(typeof t=="number"){const e=arguments[0],i=arguments[1],s=arguments[2],n=arguments[3];t={width:e,height:i,scaleMode:s,resolution:n}}t.width=t.width??100,t.height=t.height??100,t.multisample??(t.multisample=Xt.NONE),super(null,t),this.mipmap=sr.OFF,this.valid=!0,this._clear=new Bt([0,0,0,0]),this.framebuffer=new dh(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=t.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(t){this._clear.setValue(t)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class qr extends mn{constructor(t){const e=t,i=e.naturalWidth||e.videoWidth||e.width,s=e.naturalHeight||e.videoHeight||e.height;super(i,s),this.source=t,this.noSubImage=!1}static crossOrigin(t,e,i){i===void 0&&!e.startsWith("data:")?t.crossOrigin=wE(e):i!==!1&&(t.crossOrigin=typeof i=="string"?i:"anonymous")}upload(t,e,i,s){const n=t.gl,o=e.realWidth,a=e.realHeight;if(s=s||this.source,typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement){if(!s.complete||s.naturalWidth===0)return!1}else if(typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement&&s.readyState<=1)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===de.UNPACK),!this.noSubImage&&e.target===n.TEXTURE_2D&&i.width===o&&i.height===a?n.texSubImage2D(n.TEXTURE_2D,0,0,0,e.format,i.type,s):(i.width=o,i.height=a,n.texImage2D(e.target,0,i.internalFormat,e.format,i.type,s)),!0}update(){if(this.destroyed)return;const t=this.source,e=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(e,i),super.update()}dispose(){this.source=null}}class Am extends qr{constructor(t,e){if(e=e||{},typeof t=="string"){const i=new Image;qr.crossOrigin(i,t,e.crossorigin),i.src=t,t=i}super(t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(e.createBitmap??tt.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.bitmap=null,this._load=null,e.autoLoad!==!1&&this.load()}load(t){return this._load?this._load:(t!==void 0&&(this.createBitmap=t),this._load=new Promise((e,i)=>{const s=this.source;this.url=s.src;const n=()=>{this.destroyed||(s.onload=null,s.onerror=null,this.update(),this._load=null,this.createBitmap?e(this.process()):e(this))};s.complete&&s.src?n():(s.onload=n,s.onerror=o=>{i(o),this.onError.emit(o)})}),this._load)}process(){const t=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);const e=globalThis.createImageBitmap,i=!t.crossOrigin||t.crossOrigin==="anonymous";return this._process=fetch(t.src,{mode:i?"cors":"no-cors"}).then(s=>s.blob()).then(s=>e(s,0,0,t.width,t.height,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===de.UNPACK?"premultiply":"none"})).then(s=>this.destroyed?Promise.reject():(this.bitmap=s,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(t,e,i){if(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(t,e,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(t,e,i,this.bitmap),!this.preserveBitmap){let s=!0;const n=e._glTextures;for(const o in n){const a=n[o];if(a!==i&&a.dirtyId!==e.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(t){return typeof HTMLImageElement<"u"&&(typeof t=="string"||t instanceof HTMLImageElement)}}class vc{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(t,e,i){const s=e.width,n=e.height;if(i){const o=t.width/2/s,a=t.height/2/n,l=t.x/s+o,h=t.y/n+a;i=Ot.add(i,Ot.NW),this.x0=l+o*Ot.uX(i),this.y0=h+a*Ot.uY(i),i=Ot.add(i,2),this.x1=l+o*Ot.uX(i),this.y1=h+a*Ot.uY(i),i=Ot.add(i,2),this.x2=l+o*Ot.uX(i),this.y2=h+a*Ot.uY(i),i=Ot.add(i,2),this.x3=l+o*Ot.uX(i),this.y3=h+a*Ot.uY(i)}else this.x0=t.x/s,this.y0=t.y/n,this.x1=(t.x+t.width)/s,this.y1=t.y/n,this.x2=(t.x+t.width)/s,this.y2=(t.y+t.height)/n,this.x3=t.x/s,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}vc.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const Hd=new vc;function $n(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}class et extends yn{constructor(t,e,i,s,n,o,a){if(super(),this.noFrame=!1,e||(this.noFrame=!0,e=new mt(0,0,1,1)),t instanceof et&&(t=t.baseTexture),this.baseTexture=t,this._frame=e,this.trim=s,this.valid=!1,this.destroyed=!1,this._uvs=Hd,this.uvMatrix=null,this.orig=i||e,this._rotate=Number(n||0),n===!0)this._rotate=2;else if(this._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=o?new wt(o.x,o.y):new wt(0,0),this.defaultBorders=a,this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=e:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(t){if(this.baseTexture){if(t){const{resource:e}=this.baseTexture;e!=null&&e.url&&Xe[e.url]&&et.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,et.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){var s;const t=this._frame.clone(),e=this._frame===this.orig?t:this.orig.clone(),i=new et(this.baseTexture,!this.noFrame&&t,e,(s=this.trim)==null?void 0:s.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(i._frame=t),i}updateUvs(){this._uvs===Hd&&(this._uvs=new vc),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(t,e={},i=tt.STRICT_TEXTURE_CACHE){const s=typeof t=="string";let n=null;if(s)n=t;else if(t instanceof ft){if(!t.cacheId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t.cacheId=`${a}-${Ii()}`,ft.addToCache(t,t.cacheId)}n=t.cacheId}else{if(!t._pixiId){const a=(e==null?void 0:e.pixiIdPrefix)||"pixiid";t._pixiId=`${a}_${Ii()}`}n=t._pixiId}let o=Xe[n];if(s&&i&&!o)throw new Error(`The cacheId "${n}" does not exist in TextureCache.`);return!o&&!(t instanceof ft)?(e.resolution||(e.resolution=Tr(t)),o=new et(new ft(t,e)),o.baseTexture.cacheId=n,ft.addToCache(o.baseTexture,n),et.addToCache(o,n)):!o&&t instanceof ft&&(o=new et(t),et.addToCache(o,n)),o}static fromURL(t,e){const i=Object.assign({autoLoad:!1},e==null?void 0:e.resourceOptions),s=et.from(t,Object.assign({resourceOptions:i},e),!1),n=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):n.load().then(()=>Promise.resolve(s))}static fromBuffer(t,e,i,s){return new et(ft.fromBuffer(t,e,i,s))}static fromLoader(t,e,i,s){const n=new ft(t,Object.assign({scaleMode:ft.defaultOptions.scaleMode,resolution:Tr(e)},s)),{resource:o}=n;o instanceof Am&&(o.url=e);const a=new et(n);return i||(i=e),ft.addToCache(a.baseTexture,i),et.addToCache(a,i),i!==e&&(ft.addToCache(a.baseTexture,e),et.addToCache(a,e)),a.baseTexture.valid?Promise.resolve(a):new Promise(l=>{a.baseTexture.once("loaded",()=>l(a))})}static addToCache(t,e){e&&(t.textureCacheIds.includes(e)||t.textureCacheIds.push(e),Xe[e]&&Xe[e]!==t&&console.warn(`Texture added to the cache with an id [${e}] that already had an entry`),Xe[e]=t)}static removeFromCache(t){if(typeof t=="string"){const e=Xe[t];if(e){const i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete Xe[t],e}}else if(t!=null&&t.textureCacheIds){for(let e=0;e<t.textureCacheIds.length;++e)Xe[t.textureCacheIds[e]]===t&&delete Xe[t.textureCacheIds[e]];return t.textureCacheIds.length=0,t}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(t){this._frame=t,this.noFrame=!1;const{x:e,y:i,width:s,height:n}=t,o=e+s>this.baseTexture.width,a=i+n>this.baseTexture.height;if(o||a){const l=o&&a?"and":"or",h=`X: ${e} + ${s} = ${e+s} > ${this.baseTexture.width}`,c=`Y: ${i} + ${n} = ${i+n} > ${this.baseTexture.height}`;throw new Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${h} ${l} ${c}`)}this.valid=s&&n&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(t){this._rotate=t,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return et._EMPTY||(et._EMPTY=new et(new ft),$n(et._EMPTY),$n(et._EMPTY.baseTexture)),et._EMPTY}static get WHITE(){if(!et._WHITE){const t=tt.ADAPTER.createCanvas(16,16),e=t.getContext("2d");t.width=16,t.height=16,e.fillStyle="white",e.fillRect(0,0,16,16),et._WHITE=new et(ft.from(t)),$n(et._WHITE),$n(et._WHITE.baseTexture)}return et._WHITE}}class Bi extends et{constructor(t,e){super(t,e),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(t){this.framebuffer.multisample=t}resize(t,e,i=!0){const s=this.baseTexture.resolution,n=Math.round(t*s)/s,o=Math.round(e*s)/s;this.valid=n>0&&o>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(n,o),this.updateUvs()}setResolution(t){const{baseTexture:e}=this;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))}static create(t){return new Bi(new wm(t))}}class Sm{constructor(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(t,e,i=Xt.NONE){const s=new wm(Object.assign({width:t,height:e,resolution:1,multisample:i},this.textureOptions));return new Bi(s)}getOptimalTexture(t,e,i=1,s=Xt.NONE){let n;t=Math.max(Math.ceil(t*i-1e-6),1),e=Math.max(Math.ceil(e*i-1e-6),1),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=Bo(t),e=Bo(e),n=((t&65535)<<16|e&65535)>>>0,s>1&&(n+=s*4294967296)):n=s>1?-s:-1,this.texturePool[n]||(this.texturePool[n]=[]);let o=this.texturePool[n].pop();return o||(o=this.createTexture(t,e,s)),o.filterPoolKey=n,o.setResolution(i),o}getFilterTexture(t,e,i){const s=this.getOptimalTexture(t.width,t.height,e||t.resolution,i||Xt.NONE);return s.filterFrame=t.filterFrame,s}returnTexture(t){const e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)}returnFilterTexture(t){this.returnTexture(t)}clear(t){if(t=t!==!1,t)for(const e in this.texturePool){const i=this.texturePool[e];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0)}this.texturePool={}}setScreenSize(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(const e in this.texturePool){if(!(Number(e)<0))continue;const i=this.texturePool[e];if(i)for(let s=0;s<i.length;s++)i[s].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}}}Sm.SCREEN_KEY=-1;class rT extends Yr{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class Cm extends Yr{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new Ht(this.vertices),this.uvBuffer=new Ht(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(t,e){let i=0,s=0;return this.uvs[0]=i,this.uvs[1]=s,this.uvs[2]=i+e.width/t.width,this.uvs[3]=s,this.uvs[4]=i+e.width/t.width,this.uvs[5]=s+e.height/t.height,this.uvs[6]=i,this.uvs[7]=s+e.height/t.height,i=e.x,s=e.y,this.vertices[0]=i,this.vertices[1]=s,this.vertices[2]=i+e.width,this.vertices[3]=s,this.vertices[4]=i+e.width,this.vertices[5]=s+e.height,this.vertices[6]=i,this.vertices[7]=s+e.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class iT{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=Xt.NONE,this.sourceFrame=new mt,this.destinationFrame=new mt,this.bindingSourceFrame=new mt,this.bindingDestinationFrame=new mt,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const Vn=[new wt,new wt,new wt,new wt],tl=new Dt;class Im{constructor(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Sm,this.statePool=[],this.quad=new rT,this.quadUv=new Cm,this.tempRect=new mt,this.activeState={},this.globalUniforms=new Le({outputFrame:new mt,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(t,e){const i=this.renderer,s=this.defaultFilterStack,n=this.statePool.pop()||new iT,o=i.renderTexture;let a,l;if(o.current){const g=o.current;a=g.resolution,l=g.multisample}else a=i.resolution,l=i.multisample;let h=e[0].resolution||a,c=e[0].multisample??l,u=e[0].padding,d=e[0].autoFit,f=e[0].legacy??!0;for(let g=1;g<e.length;g++){const y=e[g];h=Math.min(h,y.resolution||a),c=Math.min(c,y.multisample??l),u=this.useMaxPadding?Math.max(u,y.padding):u+y.padding,d=d&&y.autoFit,f=f||(y.legacy??!0)}s.length===1&&(this.defaultFilterStack[0].renderTexture=o.current),s.push(n),n.resolution=h,n.multisample=c,n.legacy=f,n.target=t,n.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),n.sourceFrame.pad(u);const p=this.tempRect.copyFrom(o.sourceFrame);i.projection.transform&&this.transformAABB(tl.copyFrom(i.projection.transform).invert(),p),d?(n.sourceFrame.fit(p),(n.sourceFrame.width<=0||n.sourceFrame.height<=0)&&(n.sourceFrame.width=0,n.sourceFrame.height=0)):n.sourceFrame.intersects(p)||(n.sourceFrame.width=0,n.sourceFrame.height=0),this.roundFrame(n.sourceFrame,o.current?o.current.resolution:i.resolution,o.sourceFrame,o.destinationFrame,i.projection.transform),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,h,c),n.filters=e,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;const m=this.tempRect;m.x=0,m.y=0,m.width=n.sourceFrame.width,m.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,n.bindingSourceFrame.copyFrom(o.sourceFrame),n.bindingDestinationFrame.copyFrom(o.destinationFrame),n.transform=i.projection.transform,i.projection.transform=null,o.bind(n.renderTexture,n.sourceFrame,m),i.framebuffer.clear(0,0,0,0)}pop(){const t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;const s=this.globalUniforms.uniforms;s.outputFrame=e.sourceFrame,s.resolution=e.resolution;const n=s.inputSize,o=s.inputPixel,a=s.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],o[0]=Math.round(n[0]*e.resolution),o[1]=Math.round(n[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],a[0]=.5*o[2],a[1]=.5*o[3],a[2]=e.sourceFrame.width*n[2]-.5*o[2],a[3]=e.sourceFrame.height*n[3]-.5*o[3],e.legacy){const h=s.filterArea;h[0]=e.destinationFrame.width,h[1]=e.destinationFrame.height,h[2]=e.sourceFrame.x,h[3]=e.sourceFrame.y,s.filterClamp=s.inputClamp}this.globalUniforms.update();const l=t[t.length-1];if(this.renderer.framebuffer.blit(),i.length===1)i[0].apply(this,e.renderTexture,l.renderTexture,Ye.BLEND,e),this.returnFilterTexture(e.renderTexture);else{let h=e.renderTexture,c=this.getOptimalFilterTexture(h.width,h.height,e.resolution);c.filterFrame=h.filterFrame;let u=0;for(u=0;u<i.length-1;++u){u===1&&e.multisample>1&&(c=this.getOptimalFilterTexture(h.width,h.height,e.resolution),c.filterFrame=h.filterFrame),i[u].apply(this,h,c,Ye.CLEAR,e);const d=h;h=c,c=d}i[u].apply(this,h,l.renderTexture,Ye.BLEND,e),u>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(h),this.returnFilterTexture(c)}e.clear(),this.statePool.push(e)}bindAndClear(t,e=Ye.CLEAR){const{renderTexture:i,state:s}=this.renderer;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t==null?void 0:t.filterFrame){const o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,i.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);const n=s.stateId&1||this.forceClear;(e===Ye.CLEAR||e===Ye.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(t,e,i,s){const n=this.renderer;n.state.set(t.state),this.bindAndClear(i,s),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(Qe.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(Qe.TRIANGLE_STRIP))}calculateSpriteMatrix(t,e){const{sourceFrame:i,destinationFrame:s}=this.activeState,{orig:n}=e._texture,o=t.set(s.width,0,0,s.height,i.x,i.y),a=e.worldTransform.copyTo(Dt.TEMP_MATRIX);return a.invert(),o.prepend(a),o.scale(1/n.width,1/n.height),o.translate(e.anchor.x,e.anchor.y),o}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(t,e,i=1,s=Xt.NONE){return this.texturePool.getOptimalTexture(t,e,i,s)}getFilterTexture(t,e,i){if(typeof t=="number"){const n=t;t=e,e=n}t=t||this.activeState.renderTexture;const s=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,i||Xt.NONE);return s.filterFrame=t.filterFrame,s}returnFilterTexture(t){this.texturePool.returnTexture(t)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(t,e){const i=Vn[0],s=Vn[1],n=Vn[2],o=Vn[3];i.set(e.left,e.top),s.set(e.left,e.bottom),n.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(i,i),t.apply(s,s),t.apply(n,n),t.apply(o,o);const a=Math.min(i.x,s.x,n.x,o.x),l=Math.min(i.y,s.y,n.y,o.y),h=Math.max(i.x,s.x,n.x,o.x),c=Math.max(i.y,s.y,n.y,o.y);e.x=a,e.y=l,e.width=h-a,e.height=c-l}roundFrame(t,e,i,s,n){if(!(t.width<=0||t.height<=0||i.width<=0||i.height<=0)){if(n){const{a:o,b:a,c:l,d:h}=n;if((Math.abs(a)>1e-4||Math.abs(l)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(h)>1e-4))return}n=n?tl.copyFrom(n):tl.identity(),n.translate(-i.x,-i.y).scale(s.width/i.width,s.height/i.height).translate(s.x,s.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}}}Im.extension={type:Y.RendererSystem,name:"filter"};rt.add(Im);class sT{constructor(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=Xt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const nT=new mt;class Pm{constructor(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new dh(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new mt,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){let e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;tt.PREFER_ENV===Ri.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=s=>e.drawBuffersWEBGL(s):(this.hasMRT=!1,t.drawBuffers=()=>{}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)}bind(t,e,i=0){const{gl:s}=this;if(t){const n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,s.bindFramebuffer(s.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==i&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=i),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,i)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(let o=0;o<t.colorTextures.length;o++){const a=t.colorTextures[o];this.renderer.texture.unbind(a.parentTextureArray||a)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){const o=e.width>>i,a=e.height>>i,l=o/e.width;this.setViewport(e.x*l,e.y*l,o,a)}else{const o=t.width>>i,a=t.height>>i;this.setViewport(0,0,o,a)}}else this.current&&(this.current=null,s.bindFramebuffer(s.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(t,e,i,s){const n=this.viewport;t=Math.round(t),e=Math.round(e),i=Math.round(i),s=Math.round(s),(n.width!==i||n.height!==s||n.x!==t||n.y!==e)&&(n.x=t,n.y=e,n.width=i,n.height=s,this.gl.viewport(t,e,i,s))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(t,e,i,s,n=kl.COLOR|kl.DEPTH){const{gl:o}=this;o.clearColor(t,e,i,s),o.clear(n)}initFramebuffer(t){const{gl:e}=this,i=new sT(e.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i}resizeFramebuffer(t){const{gl:e}=this,i=t.glFramebuffers[this.CONTEXT_UID];if(i.stencil){e.bindRenderbuffer(e.RENDERBUFFER,i.stencil);let o;this.renderer.context.webGLVersion===1?o=e.DEPTH_STENCIL:t.depth&&t.stencil?o=e.DEPTH24_STENCIL8:t.depth?o=e.DEPTH_COMPONENT24:o=e.STENCIL_INDEX8,i.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,o,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,o,t.width,t.height)}const s=t.colorTextures;let n=s.length;e.drawBuffers||(n=Math.min(n,1));for(let o=0;o<n;o++){const a=s[o],l=a.parentTextureArray||a;this.renderer.texture.bind(l,0),o===0&&i.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,i.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height))}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)}updateFramebuffer(t,e){const{gl:i}=this,s=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures;let o=n.length;i.drawBuffers||(o=Math.min(o,1)),s.multisample>1&&this.canMultisampleFramebuffer(t)?s.msaaBuffer=s.msaaBuffer||i.createRenderbuffer():s.msaaBuffer&&(i.deleteRenderbuffer(s.msaaBuffer),s.msaaBuffer=null,s.blitFramebuffer&&(s.blitFramebuffer.dispose(),s.blitFramebuffer=null));const a=[];for(let l=0;l<o;l++){const h=n[l],c=h.parentTextureArray||h;this.renderer.texture.bind(c,0),l===0&&s.msaaBuffer?(i.bindRenderbuffer(i.RENDERBUFFER,s.msaaBuffer),i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,c._glTextures[this.CONTEXT_UID].internalFormat,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,s.msaaBuffer)):(i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+l,h.target,c._glTextures[this.CONTEXT_UID].texture,e),a.push(i.COLOR_ATTACHMENT0+l))}if(a.length>1&&i.drawBuffers(a),t.depthTexture&&this.writeDepthTexture){const l=t.depthTexture;this.renderer.texture.bind(l,0),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,l._glTextures[this.CONTEXT_UID].texture,e)}if((t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)){s.stencil=s.stencil||i.createRenderbuffer();let l,h;this.renderer.context.webGLVersion===1?(l=i.DEPTH_STENCIL_ATTACHMENT,h=i.DEPTH_STENCIL):t.depth&&t.stencil?(l=i.DEPTH_STENCIL_ATTACHMENT,h=i.DEPTH24_STENCIL8):t.depth?(l=i.DEPTH_ATTACHMENT,h=i.DEPTH_COMPONENT24):(l=i.STENCIL_ATTACHMENT,h=i.STENCIL_INDEX8),i.bindRenderbuffer(i.RENDERBUFFER,s.stencil),s.msaaBuffer?i.renderbufferStorageMultisample(i.RENDERBUFFER,s.multisample,h,t.width,t.height):i.renderbufferStorage(i.RENDERBUFFER,h,t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,l,i.RENDERBUFFER,s.stencil)}else s.stencil&&(i.deleteRenderbuffer(s.stencil),s.stencil=null)}canMultisampleFramebuffer(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture}detectSamples(t){const{msaaSamples:e}=this;let i=Xt.NONE;if(t<=1||e===null)return i;for(let s=0;s<e.length;s++)if(e[s]<=t){i=e[s];break}return i===1&&(i=Xt.NONE),i}blit(t,e,i){const{current:s,renderer:n,gl:o,CONTEXT_UID:a}=this;if(n.context.webGLVersion!==2||!s)return;const l=s.glFramebuffers[a];if(!l)return;if(!t){if(!l.msaaBuffer)return;const c=s.colorTextures[0];if(!c)return;l.blitFramebuffer||(l.blitFramebuffer=new dh(s.width,s.height),l.blitFramebuffer.addColorTexture(0,c)),t=l.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==s.width||t.height!==s.height)&&(t.width=s.width,t.height=s.height,t.dirtyId++,t.dirtySize++)}e||(e=nT,e.width=s.width,e.height=s.height),i||(i=e);const h=e.width===i.width&&e.height===i.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,i.left,i.top,i.right,i.bottom,o.COLOR_BUFFER_BIT,h?o.NEAREST:o.LINEAR),o.bindFramebuffer(o.READ_FRAMEBUFFER,t.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(t,e){const i=t.glFramebuffers[this.CONTEXT_UID],s=this.gl;if(!i)return;delete t.glFramebuffers[this.CONTEXT_UID];const n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(s.deleteFramebuffer(i.framebuffer),i.msaaBuffer&&s.deleteRenderbuffer(i.msaaBuffer),i.stencil&&s.deleteRenderbuffer(i.stencil)),i.blitFramebuffer&&this.disposeFramebuffer(i.blitFramebuffer,e)}disposeAll(t){const e=this.managedFramebuffers;this.managedFramebuffers=[];for(let i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)}forceStencil(){const t=this.current;if(!t)return;const e=t.glFramebuffers[this.CONTEXT_UID];if(!e||e.stencil&&t.stencil)return;t.stencil=!0;const i=t.width,s=t.height,n=this.gl,o=e.stencil=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o);let a,l;this.renderer.context.webGLVersion===1?(a=n.DEPTH_STENCIL_ATTACHMENT,l=n.DEPTH_STENCIL):t.depth?(a=n.DEPTH_STENCIL_ATTACHMENT,l=n.DEPTH24_STENCIL8):(a=n.STENCIL_ATTACHMENT,l=n.STENCIL_INDEX8),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,l,i,s):n.renderbufferStorage(n.RENDERBUFFER,l,i,s),n.framebufferRenderbuffer(n.FRAMEBUFFER,a,n.RENDERBUFFER,o)}reset(){this.current=this.unknownFramebuffer,this.viewport=new mt}destroy(){this.renderer=null}}Pm.extension={type:Y.RendererSystem,name:"framebuffer"};rt.add(Pm);const el={5126:4,5123:2,5121:1};class Rm{constructor(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);const t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){let i=this.renderer.context.extensions.vertexArrayObject;tt.PREFER_ENV===Ri.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=()=>i.createVertexArrayOES(),t.bindVertexArray=s=>i.bindVertexArrayOES(s),t.deleteVertexArray=s=>i.deleteVertexArrayOES(s)):(this.hasVao=!1,t.createVertexArray=()=>null,t.bindVertexArray=()=>null,t.deleteVertexArray=()=>null)}if(e.webGLVersion!==2){const i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=(s,n)=>i.vertexAttribDivisorANGLE(s,n),t.drawElementsInstanced=(s,n,o,a,l)=>i.drawElementsInstancedANGLE(s,n,o,a,l),t.drawArraysInstanced=(s,n,o,a)=>i.drawArraysInstancedANGLE(s,n,o,a)):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex}bind(t,e){e=e||this.renderer.shader.shader;const{gl:i}=this;let s=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;s||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=s={},n=!0);const o=s[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?i.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const t=this._activeGeometry,e=this.renderer.buffer;for(let i=0;i<t.buffers.length;i++){const s=t.buffers[i];e.update(s)}}checkCompatibility(t,e){const i=t.attributes,s=e.attributeData;for(const n in s)if(!i[n])throw new Error(`shader and geometry incompatible, geometry missing the "${n}" attribute`)}getSignature(t,e){const i=t.attributes,s=e.attributeData,n=["g",t.id];for(const o in i)s[o]&&n.push(o,s[o].location);return n.join("-")}initGeometryVao(t,e,i=!0){const s=this.gl,n=this.CONTEXT_UID,o=this.renderer.buffer,a=e.program;a.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,a);const l=this.getSignature(t,a),h=t.glVertexArrayObjects[this.CONTEXT_UID];let c=h[l];if(c)return h[a.id]=c,c;const u=t.buffers,d=t.attributes,f={},p={};for(const m in u)f[m]=0,p[m]=0;for(const m in d)!d[m].size&&a.attributeData[m]?d[m].size=a.attributeData[m].size:d[m].size||console.warn(`PIXI Geometry attribute '${m}' size cannot be determined (likely the bound shader does not have the attribute)`),f[d[m].buffer]+=d[m].size*el[d[m].type];for(const m in d){const g=d[m],y=g.size;g.stride===void 0&&(f[g.buffer]===y*el[g.type]?g.stride=0:g.stride=f[g.buffer]),g.start===void 0&&(g.start=p[g.buffer],p[g.buffer]+=y*el[g.type])}c=s.createVertexArray(),s.bindVertexArray(c);for(let m=0;m<u.length;m++){const g=u[m];o.bind(g),i&&g._glBuffers[n].refCount++}return this.activateVao(t,a),h[a.id]=c,h[l]=c,s.bindVertexArray(null),o.unbind(er.ARRAY_BUFFER),c}disposeGeometry(t,e){var a;if(!this.managedGeometries[t.id])return;delete this.managedGeometries[t.id];const i=t.glVertexArrayObjects[this.CONTEXT_UID],s=this.gl,n=t.buffers,o=(a=this.renderer)==null?void 0:a.buffer;if(t.disposeRunner.remove(this),!!i){if(o)for(let l=0;l<n.length;l++){const h=n[l]._glBuffers[this.CONTEXT_UID];h&&(h.refCount--,h.refCount===0&&!e&&o.dispose(n[l],e))}if(!e){for(const l in i)if(l[0]==="g"){const h=i[l];this._activeVao===h&&this.unbind(),s.deleteVertexArray(h)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(t){const e=Object.keys(this.managedGeometries);for(let i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t)}activateVao(t,e){const i=this.gl,s=this.CONTEXT_UID,n=this.renderer.buffer,o=t.buffers,a=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);let l=null;for(const h in a){const c=a[h],u=o[c.buffer],d=u._glBuffers[s];if(e.attributeData[h]){l!==d&&(n.bind(u),l=d);const f=e.attributeData[h].location;if(i.enableVertexAttribArray(f),i.vertexAttribPointer(f,c.size,c.type||i.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)i.vertexAttribDivisor(f,c.divisor);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}}draw(t,e,i,s){const{gl:n}=this,o=this._activeGeometry;if(o.indexBuffer){const a=o.indexBuffer.data.BYTES_PER_ELEMENT,l=a===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;a===2||a===4&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(t,e||o.indexBuffer.data.length,l,(i||0)*a,s||1):n.drawElements(t,e||o.indexBuffer.data.length,l,(i||0)*a):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(t,i,e||o.getSize(),s||1):n.drawArrays(t,i,e||o.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}Rm.extension={type:Y.RendererSystem,name:"geometry"};rt.add(Rm);const $d=new Dt;class Mm{constructor(t,e){this._texture=t,this.mapCoord=new Dt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}get texture(){return this._texture}set texture(t){this._texture=t,this._textureID=-1}multiplyUvs(t,e){e===void 0&&(e=t);const i=this.mapCoord;for(let s=0;s<t.length;s+=2){const n=t[s],o=t[s+1];e[s]=n*i.a+o*i.c+i.tx,e[s+1]=n*i.b+o*i.d+i.ty}return e}update(t){const e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;const i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);const s=e.orig,n=e.trim;n&&($d.set(s.width/n.width,0,0,s.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append($d));const o=e.baseTexture,a=this.uClampFrame,l=this.clampMargin/o.resolution,h=this.clampOffset;return a[0]=(e._frame.x+l+h)/o.width,a[1]=(e._frame.y+l+h)/o.height,a[2]=(e._frame.x+e._frame.width-l+h)/o.width,a[3]=(e._frame.y+e._frame.height-l+h)/o.height,this.uClampOffset[0]=h/o.realWidth,this.uClampOffset[1]=h/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&e.rotate===0,!0}}var oT=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,aT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class lT extends ae{constructor(t,e,i){let s=null;typeof t!="string"&&e===void 0&&i===void 0&&(s=t,t=void 0,e=void 0,i=void 0),super(t||aT,e||oT,i),this.maskSprite=s,this.maskMatrix=new Dt}get maskSprite(){return this._maskSprite}set maskSprite(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(t,e,i,s){const n=this._maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Mm(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,i,s))}}class hT{constructor(t=null){this.type=zt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=ae.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=zt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class Bm{constructor(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)}push(t,e){let i=e;if(!i.isMaskData){const n=this.maskDataPool.pop()||new hT;n.pooled=!0,n.maskObject=e,i=n}const s=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(i.copyCountersOrReset(s),i._colorMask=s?s._colorMask:15,i.autoDetect&&this.detect(i),i._target=t,i.type!==zt.SPRITE&&this.maskStack.push(i),i.enabled)switch(i.type){case zt.SCISSOR:this.renderer.scissor.push(i);break;case zt.STENCIL:this.renderer.stencil.push(i);break;case zt.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i);break;case zt.COLOR:this.pushColorMask(i);break}i.type===zt.SPRITE&&this.maskStack.push(i)}pop(t){const e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case zt.SCISSOR:this.renderer.scissor.pop(e);break;case zt.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case zt.SPRITE:this.popSpriteMask(e);break;case zt.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){const i=this.maskStack[this.maskStack.length-1];i.type===zt.SPRITE&&i._filters&&(i._filters[0].maskSprite=i.maskObject)}}}detect(t){const e=t.maskObject;e?e.isSprite?t.type=zt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=zt.SCISSOR:t.type=zt.STENCIL:t.type=zt.COLOR}pushSpriteMask(t){const{maskObject:e}=t,i=t._target;let s=t._filters;s||(s=this.alphaMaskPool[this.alphaMaskIndex],s||(s=this.alphaMaskPool[this.alphaMaskIndex]=[new lT])),s[0].resolution=t.resolution,s[0].multisample=t.multisample,s[0].maskSprite=e;const n=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,s),i.filterArea=n,t._filters||this.alphaMaskIndex++}popSpriteMask(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(t){const e=t._colorMask,i=t._colorMask=e&t.colorMask;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}popColorMask(t){const e=t._colorMask,i=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;i!==e&&this.renderer.gl.colorMask((i&1)!==0,(i&2)!==0,(i&4)!==0,(i&8)!==0)}destroy(){this.renderer=null}}Bm.extension={type:Y.RendererSystem,name:"mask"};rt.add(Bm);class Dm{constructor(t){this.renderer=t,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(t){const{gl:e}=this.renderer,i=this.getStackLength();this.maskStack=t;const s=this.getStackLength();s!==i&&(s===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const Vd=new Dt,Xd=[],Fm=class co extends Dm{constructor(t){super(t),this.glConst=tt.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0}calcScissorRect(t){if(t._scissorRectLocal)return;const e=t._scissorRect,{maskObject:i}=t,{renderer:s}=this,n=s.renderTexture,o=i.getBounds(!0,Xd.pop()??new mt);this.roundFrameToPixels(o,n.current?n.current.resolution:s.resolution,n.sourceFrame,n.destinationFrame,s.projection.transform),e&&o.fit(e),t._scissorRectLocal=o}static isMatrixRotated(t){if(!t)return!1;const{a:e,b:i,c:s,d:n}=t;return(Math.abs(i)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(n)>1e-4)}testScissor(t){const{maskObject:e}=t;if(!e.isFastRect||!e.isFastRect()||co.isMatrixRotated(e.worldTransform)||co.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);const i=t._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(t,e,i,s,n){co.isMatrixRotated(n)||(n=n?Vd.copyFrom(n):Vd.identity(),n.translate(-i.x,-i.y).scale(s.width/i.width,s.height/i.height).translate(s.x,s.y),this.renderer.filter.transformAABB(n,t),t.fit(s),t.x=Math.round(t.x*e),t.y=Math.round(t.y*e),t.width=Math.round(t.width*e),t.height=Math.round(t.height*e))}push(t){t._scissorRectLocal||this.calcScissorRect(t);const{gl:e}=this.renderer;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()}pop(t){const{gl:e}=this.renderer;t&&Xd.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)}_useCurrent(){const t=this.maskStack[this.maskStack.length-1]._scissorRect;let e;this.renderer.renderTexture.current?e=t.y:e=this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};Fm.extension={type:Y.RendererSystem,name:"scissor"};let cT=Fm;rt.add(cT);class Om extends Dm{constructor(t){super(t),this.glConst=tt.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){const t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0}push(t){const e=t.maskObject,{gl:i}=this.renderer,s=t._stencilCounter;s===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),t._stencilCounter++;const n=t._colorMask;n!==0&&(t._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,s,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(t._colorMask=n,i.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}pop(t){const e=this.renderer.gl;if(this.getStackLength()===0)e.disable(e.STENCIL_TEST);else{const i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,s=i?i._colorMask:15;s!==0&&(i._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,s!==0&&(i._colorMask=s,e.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)),this._useCurrent()}}_useCurrent(){const t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)}}Om.extension={type:Y.RendererSystem,name:"stencil"};rt.add(Om);class Nm{constructor(t){this.renderer=t,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get(){return vt("7.0.0","renderer.plugins.extract has moved to renderer.extract"),t.extract}},prepare:{enumerable:!1,get(){return vt("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),t.prepare}},interaction:{enumerable:!1,get(){return vt("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),t.events}}})}init(){const t=this.rendererPlugins;for(const e in t)this.plugins[e]=new t[e](this.renderer)}destroy(){for(const t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null}}Nm.extension={type:[Y.RendererSystem,Y.CanvasRendererSystem],name:"_plugin"};rt.add(Nm);class Lm{constructor(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Dt,this.transform=null}update(t,e,i,s){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,s),this.transform&&this.projectionMatrix.append(this.transform);const n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(t,e,i,s){const n=this.projectionMatrix,o=s?-1:1;n.identity(),n.a=1/e.width*2,n.d=o*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-o-e.y*n.d}setTransform(t){}destroy(){this.renderer=null}}Lm.extension={type:Y.RendererSystem,name:"projection"};rt.add(Lm);const uT=new _c,zd=new mt;class km{constructor(t){this.renderer=t,this._tempMatrix=new Dt}generateTexture(t,e){const{region:i,...s}=e||{},n=(i==null?void 0:i.copyTo(zd))||t.getLocalBounds(zd,!0),o=s.resolution||this.renderer.resolution;n.width=Math.max(n.width,1/o),n.height=Math.max(n.height,1/o),s.width=n.width,s.height=n.height,s.resolution=o,s.multisample??(s.multisample=this.renderer.multisample);const a=Bi.create(s);this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;const l=t.transform;return t.transform=uT,this.renderer.render(t,{renderTexture:a,transform:this._tempMatrix,skipUpdateTransform:!!t.parent,blit:!0}),t.transform=l,a}destroy(){}}km.extension={type:[Y.RendererSystem,Y.CanvasRendererSystem],name:"textureGenerator"};rt.add(km);const ni=new mt,Fs=new mt;class Um{constructor(t){this.renderer=t,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new mt,this.destinationFrame=new mt,this.viewportFrame=new mt}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}bind(t=null,e,i){const s=this.renderer;this.current=t;let n,o,a;t?(n=t.baseTexture,a=n.resolution,e||(ni.width=t.frame.width,ni.height=t.frame.height,e=ni),i||(Fs.x=t.frame.x,Fs.y=t.frame.y,Fs.width=e.width,Fs.height=e.height,i=Fs),o=n.framebuffer):(a=s.resolution,e||(ni.width=s._view.screen.width,ni.height=s._view.screen.height,e=ni),i||(i=ni,i.width=e.width,i.height=e.height));const l=this.viewportFrame;l.x=i.x*a,l.y=i.y*a,l.width=i.width*a,l.height=i.height*a,t||(l.y=s.view.height-(l.y+l.height)),l.ceil(),this.renderer.framebuffer.bind(o,l),this.renderer.projection.update(i,e,a,!o),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(i)}clear(t,e){const i=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,s=Bt.shared.setValue(t||i);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&s.premultiply(s.alpha);const n=this.destinationFrame,o=this.current?this.current.baseTexture:this.renderer._view.screen,a=n.width!==o.width||n.height!==o.height;if(a){let{x:l,y:h,width:c,height:u}=this.viewportFrame;l=Math.round(l),h=Math.round(h),c=Math.round(c),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(l,h,c,u)}this.renderer.framebuffer.clear(s.red,s.green,s.blue,s.alpha,e),a&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}Um.extension={type:Y.RendererSystem,name:"renderTexture"};rt.add(Um);class dT{constructor(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function fT(r,t){const e={},i=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES);for(let s=0;s<i;s++){const n=t.getActiveAttrib(r,s);if(n.name.startsWith("gl_"))continue;const o=Em(t,n.type),a={type:o,name:n.name,size:bm(o),location:t.getAttribLocation(r,n.name)};e[n.name]=a}return e}function pT(r,t){const e={},i=t.getProgramParameter(r,t.ACTIVE_UNIFORMS);for(let s=0;s<i;s++){const n=t.getActiveUniform(r,s),o=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),l=Em(t,n.type);e[o]={name:o,index:s,type:l,size:n.size,isArray:a,value:vm(l,n.size)}}return e}function mT(r,t){var a;const e=Nd(r,r.VERTEX_SHADER,t.vertexSrc),i=Nd(r,r.FRAGMENT_SHADER,t.fragmentSrc),s=r.createProgram();r.attachShader(s,e),r.attachShader(s,i);const n=(a=t.extra)==null?void 0:a.transformFeedbackVaryings;if(n&&(typeof r.transformFeedbackVaryings!="function"?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):r.transformFeedbackVaryings(s,n.names,n.bufferMode==="separate"?r.SEPARATE_ATTRIBS:r.INTERLEAVED_ATTRIBS)),r.linkProgram(s),r.getProgramParameter(s,r.LINK_STATUS)||XE(r,s,e,i),t.attributeData=fT(s,r),t.uniformData=pT(s,r),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){const l=Object.keys(t.attributeData);l.sort((h,c)=>h>c?1:-1);for(let h=0;h<l.length;h++)t.attributeData[l[h]].location=h,r.bindAttribLocation(s,h,l[h]);r.linkProgram(s)}r.deleteShader(e),r.deleteShader(i);const o={};for(const l in t.uniformData){const h=t.uniformData[l];o[l]={location:r.getUniformLocation(s,l),value:vm(h.type,h.size)}}return new dT(s,o)}function gT(r,t,e,i,s){e.buffer.update(s)}const yT={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},Gm={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function _T(r){const t=r.map(n=>({data:n,offset:0,dataLen:0,dirty:0}));let e=0,i=0,s=0;for(let n=0;n<t.length;n++){const o=t[n];if(e=Gm[o.data.type],o.data.size>1&&(e=Math.max(e,16)*o.data.size),o.dataLen=e,i%e!==0&&i<16){const a=i%e%16;i+=a,s+=a}i+e>16?(s=Math.ceil(s/16)*16,o.offset=s,s+=e,i=e):(o.offset=s,i+=e,s+=e)}return s=Math.ceil(s/16)*16,{uboElements:t,size:s}}function vT(r,t){const e=[];for(const i in r)t[i]&&e.push(t[i]);return e.sort((i,s)=>i.index-s.index),e}function xT(r,t){if(!r.autoManage)return{size:0,syncFunc:gT};const e=vT(r.uniforms,t),{uboElements:i,size:s}=_T(e),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let o=0;o<i.length;o++){const a=i[o],l=r.uniforms[a.data.name],h=a.data.name;let c=!1;for(let u=0;u<ls.length;u++){const d=ls[u];if(d.codeUbo&&d.test(a.data,l)){n.push(`offset = ${a.offset/4};`,ls[u].codeUbo(a.data.name,l)),c=!0;break}}if(!c)if(a.data.size>1){const u=bm(a.data.type),d=Math.max(Gm[a.data.type]/16,1),f=u/d,p=(4-f%4)%4;n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};

                t = 0;

                for(var i=0; i < ${a.data.size*d}; i++)
                {
                    for(var j = 0; j < ${f}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${p};
                }

                `)}else{const u=yT[a.data.type];n.push(`
                cv = ud.${h}.value;
                v = uv.${h};
                offset = ${a.offset/4};
                ${u};
                `)}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:s,syncFunc:new Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}let bT=0;const Xn={textureCount:0,uboCount:0};class Hm{constructor(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=bT++}systemCheck(){if(!WE())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(t){this.gl=t,this.reset()}bind(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;const i=t.program,s=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(s.program)),e||(Xn.textureCount=0,Xn.uboCount=0,this.syncUniformGroup(t.uniformGroup,Xn)),s}setUniforms(t){const e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)}syncUniformGroup(t,e){const i=this.getGlProgram();(!t.static||t.dirtyId!==i.uniformDirtyGroups[t.id])&&(i.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))}syncUniforms(t,e,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,i)}createSyncGroups(t){const e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=HE(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(t,e){const i=this.getGlProgram();if(!t.static||t.dirtyId!==0||!i.uniformGroups[t.id]){t.dirtyId=0;const s=i.uniformGroups[t.id]||this.createSyncBufferGroup(t,i,e);t.buffer.update(),s(i.uniformData,t.uniforms,this.renderer,Xn,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,i.uniformBufferBindings[e])}createSyncBufferGroup(t,e,i){const{gl:s}=this.renderer;this.renderer.buffer.bind(t.buffer);const n=this.gl.getUniformBlockIndex(e.program,i);e.uniformBufferBindings[i]=this.shader.uniformBindCount,s.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;const o=this.getSignature(t,this.shader.program.uniformData,"ubo");let a=this._uboCache[o];if(a||(a=this._uboCache[o]=xT(t,this.shader.program.uniformData)),t.autoManage){const l=new Float32Array(a.size/4);t.buffer.update(l)}return e.uniformGroups[t.id]=a.syncFunc,e.uniformGroups[t.id]}getSignature(t,e,i){const s=t.uniforms,n=[`${i}-`];for(const o in s)n.push(o),e[o]&&n.push(e[o].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(t){const e=this.gl,i=t.program,s=mT(e,i);return i.glPrograms[this.renderer.CONTEXT_UID]=s,s}reset(){this.program=null,this.shader=null}disposeShader(t){this.shader===t&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}Hm.extension={type:Y.RendererSystem,name:"shader"};rt.add(Hm);class Lo{constructor(t){this.renderer=t}run(t){const{renderer:e}=this;e.runners.init.emit(e.options),t.hello&&console.log(`PixiJS 7.3.2 - ${e.rendererLogId} - https://pixijs.com`),e.resize(e.screen.width,e.screen.height)}destroy(){}}Lo.defaultOptions={hello:!1},Lo.extension={type:[Y.RendererSystem,Y.CanvasRendererSystem],name:"startup"};rt.add(Lo);function ET(r,t=[]){return t[ct.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.ADD]=[r.ONE,r.ONE],t[ct.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.NONE]=[0,0],t[ct.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],t[ct.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[ct.SRC_IN]=[r.DST_ALPHA,r.ZERO],t[ct.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],t[ct.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[ct.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],t[ct.DST_IN]=[r.ZERO,r.SRC_ALPHA],t[ct.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],t[ct.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],t[ct.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[ct.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],t}const TT=0,wT=1,AT=2,ST=3,CT=4,IT=5,$m=class fh{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ct.NONE,this._blendEq=!1,this.map=[],this.map[TT]=this.setBlend,this.map[wT]=this.setOffset,this.map[AT]=this.setCullFace,this.map[ST]=this.setDepthTest,this.map[CT]=this.setFrontFace,this.map[IT]=this.setDepthMask,this.checks=[],this.defaultState=new or,this.defaultState.blend=!0}contextChange(t){this.gl=t,this.blendModes=ET(t),this.set(this.defaultState),this.reset()}set(t){if(t=t||this.defaultState,this.stateId!==t.data){let e=this.stateId^t.data,i=0;for(;e;)e&1&&this.map[i].call(this,!!(t.data&1<<i)),e=e>>1,i++;this.stateId=t.data}for(let e=0;e<this.checks.length;e++)this.checks[e](this,t)}forceState(t){t=t||this.defaultState;for(let e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(let e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data}setBlend(t){this.updateCheck(fh.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(fh.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(t){this.gl.depthMask(t)}setCullFace(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])}setBlendMode(t){if(t===this.blendMode)return;this.blendMode=t;const e=this.blendModes[t],i=this.gl;e.length===2?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(t,e){this.gl.polygonOffset(t,e)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(t,e){const i=this.checks.indexOf(t);e&&i===-1?this.checks.push(t):!e&&i!==-1&&this.checks.splice(i,1)}static checkBlendMode(t,e){t.setBlendMode(e.blendMode)}static checkPolygonOffset(t,e){t.setPolygonOffset(1,e.polygonOffset)}destroy(){this.gl=null}};$m.extension={type:Y.RendererSystem,name:"state"};let PT=$m;rt.add(PT);class RT extends yn{constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(t){this.addRunners(...t.runners);const e=(t.priority??[]).filter(s=>t.systems[s]),i=[...e,...Object.keys(t.systems).filter(s=>!e.includes(s))];for(const s of i)this.addSystem(t.systems[s],s)}addRunners(...t){t.forEach(e=>{this.runners[e]=new Ne(e)})}addSystem(t,e){const i=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=i,this._systemsHash[e]=i;for(const s in this.runners)this.runners[s].add(i);return this}emitWithCustomOptions(t,e){const i=Object.keys(this._systemsHash);t.items.forEach(s=>{const n=i.find(o=>this._systemsHash[o]===s);s[t.name](e[n])})}destroy(){Object.values(this.runners).forEach(t=>{t.destroy()}),this._systemsHash={}}}const Gs=class uo{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=uo.defaultMaxIdle,this.checkCountMax=uo.defaultCheckCountMax,this.mode=uo.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==lc.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const t=this.renderer.texture,e=t.managedTextures;let i=!1;for(let s=0;s<e.length;s++){const n=e[s];n.resource&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[s]=null,i=!0)}if(i){let s=0;for(let n=0;n<e.length;n++)e[n]!==null&&(e[s++]=e[n]);e.length=s}}unload(t){const e=this.renderer.texture,i=t._texture;i&&!i.framebuffer&&e.destroyTexture(i);for(let s=t.children.length-1;s>=0;s--)this.unload(t.children[s])}destroy(){this.renderer=null}};Gs.defaultMode=lc.AUTO,Gs.defaultMaxIdle=60*60,Gs.defaultCheckCountMax=60*10,Gs.extension={type:Y.RendererSystem,name:"textureGC"};let di=Gs;rt.add(di);class rl{constructor(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=nt.UNSIGNED_BYTE,this.internalFormat=U.RGBA,this.samplerType=0}}function MT(r){let t;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?t={[r.RGB]:J.FLOAT,[r.RGBA]:J.FLOAT,[r.ALPHA]:J.FLOAT,[r.LUMINANCE]:J.FLOAT,[r.LUMINANCE_ALPHA]:J.FLOAT,[r.R8]:J.FLOAT,[r.R8_SNORM]:J.FLOAT,[r.RG8]:J.FLOAT,[r.RG8_SNORM]:J.FLOAT,[r.RGB8]:J.FLOAT,[r.RGB8_SNORM]:J.FLOAT,[r.RGB565]:J.FLOAT,[r.RGBA4]:J.FLOAT,[r.RGB5_A1]:J.FLOAT,[r.RGBA8]:J.FLOAT,[r.RGBA8_SNORM]:J.FLOAT,[r.RGB10_A2]:J.FLOAT,[r.RGB10_A2UI]:J.FLOAT,[r.SRGB8]:J.FLOAT,[r.SRGB8_ALPHA8]:J.FLOAT,[r.R16F]:J.FLOAT,[r.RG16F]:J.FLOAT,[r.RGB16F]:J.FLOAT,[r.RGBA16F]:J.FLOAT,[r.R32F]:J.FLOAT,[r.RG32F]:J.FLOAT,[r.RGB32F]:J.FLOAT,[r.RGBA32F]:J.FLOAT,[r.R11F_G11F_B10F]:J.FLOAT,[r.RGB9_E5]:J.FLOAT,[r.R8I]:J.INT,[r.R8UI]:J.UINT,[r.R16I]:J.INT,[r.R16UI]:J.UINT,[r.R32I]:J.INT,[r.R32UI]:J.UINT,[r.RG8I]:J.INT,[r.RG8UI]:J.UINT,[r.RG16I]:J.INT,[r.RG16UI]:J.UINT,[r.RG32I]:J.INT,[r.RG32UI]:J.UINT,[r.RGB8I]:J.INT,[r.RGB8UI]:J.UINT,[r.RGB16I]:J.INT,[r.RGB16UI]:J.UINT,[r.RGB32I]:J.INT,[r.RGB32UI]:J.UINT,[r.RGBA8I]:J.INT,[r.RGBA8UI]:J.UINT,[r.RGBA16I]:J.INT,[r.RGBA16UI]:J.UINT,[r.RGBA32I]:J.INT,[r.RGBA32UI]:J.UINT,[r.DEPTH_COMPONENT16]:J.FLOAT,[r.DEPTH_COMPONENT24]:J.FLOAT,[r.DEPTH_COMPONENT32F]:J.FLOAT,[r.DEPTH_STENCIL]:J.FLOAT,[r.DEPTH24_STENCIL8]:J.FLOAT,[r.DEPTH32F_STENCIL8]:J.FLOAT}:t={[r.RGB]:J.FLOAT,[r.RGBA]:J.FLOAT,[r.ALPHA]:J.FLOAT,[r.LUMINANCE]:J.FLOAT,[r.LUMINANCE_ALPHA]:J.FLOAT,[r.DEPTH_STENCIL]:J.FLOAT},t}function BT(r){let t;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?t={[nt.UNSIGNED_BYTE]:{[U.RGBA]:r.RGBA8,[U.RGB]:r.RGB8,[U.RG]:r.RG8,[U.RED]:r.R8,[U.RGBA_INTEGER]:r.RGBA8UI,[U.RGB_INTEGER]:r.RGB8UI,[U.RG_INTEGER]:r.RG8UI,[U.RED_INTEGER]:r.R8UI,[U.ALPHA]:r.ALPHA,[U.LUMINANCE]:r.LUMINANCE,[U.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[nt.BYTE]:{[U.RGBA]:r.RGBA8_SNORM,[U.RGB]:r.RGB8_SNORM,[U.RG]:r.RG8_SNORM,[U.RED]:r.R8_SNORM,[U.RGBA_INTEGER]:r.RGBA8I,[U.RGB_INTEGER]:r.RGB8I,[U.RG_INTEGER]:r.RG8I,[U.RED_INTEGER]:r.R8I},[nt.UNSIGNED_SHORT]:{[U.RGBA_INTEGER]:r.RGBA16UI,[U.RGB_INTEGER]:r.RGB16UI,[U.RG_INTEGER]:r.RG16UI,[U.RED_INTEGER]:r.R16UI,[U.DEPTH_COMPONENT]:r.DEPTH_COMPONENT16},[nt.SHORT]:{[U.RGBA_INTEGER]:r.RGBA16I,[U.RGB_INTEGER]:r.RGB16I,[U.RG_INTEGER]:r.RG16I,[U.RED_INTEGER]:r.R16I},[nt.UNSIGNED_INT]:{[U.RGBA_INTEGER]:r.RGBA32UI,[U.RGB_INTEGER]:r.RGB32UI,[U.RG_INTEGER]:r.RG32UI,[U.RED_INTEGER]:r.R32UI,[U.DEPTH_COMPONENT]:r.DEPTH_COMPONENT24},[nt.INT]:{[U.RGBA_INTEGER]:r.RGBA32I,[U.RGB_INTEGER]:r.RGB32I,[U.RG_INTEGER]:r.RG32I,[U.RED_INTEGER]:r.R32I},[nt.FLOAT]:{[U.RGBA]:r.RGBA32F,[U.RGB]:r.RGB32F,[U.RG]:r.RG32F,[U.RED]:r.R32F,[U.DEPTH_COMPONENT]:r.DEPTH_COMPONENT32F},[nt.HALF_FLOAT]:{[U.RGBA]:r.RGBA16F,[U.RGB]:r.RGB16F,[U.RG]:r.RG16F,[U.RED]:r.R16F},[nt.UNSIGNED_SHORT_5_6_5]:{[U.RGB]:r.RGB565},[nt.UNSIGNED_SHORT_4_4_4_4]:{[U.RGBA]:r.RGBA4},[nt.UNSIGNED_SHORT_5_5_5_1]:{[U.RGBA]:r.RGB5_A1},[nt.UNSIGNED_INT_2_10_10_10_REV]:{[U.RGBA]:r.RGB10_A2,[U.RGBA_INTEGER]:r.RGB10_A2UI},[nt.UNSIGNED_INT_10F_11F_11F_REV]:{[U.RGB]:r.R11F_G11F_B10F},[nt.UNSIGNED_INT_5_9_9_9_REV]:{[U.RGB]:r.RGB9_E5},[nt.UNSIGNED_INT_24_8]:{[U.DEPTH_STENCIL]:r.DEPTH24_STENCIL8},[nt.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[U.DEPTH_STENCIL]:r.DEPTH32F_STENCIL8}}:t={[nt.UNSIGNED_BYTE]:{[U.RGBA]:r.RGBA,[U.RGB]:r.RGB,[U.ALPHA]:r.ALPHA,[U.LUMINANCE]:r.LUMINANCE,[U.LUMINANCE_ALPHA]:r.LUMINANCE_ALPHA},[nt.UNSIGNED_SHORT_5_6_5]:{[U.RGB]:r.RGB},[nt.UNSIGNED_SHORT_4_4_4_4]:{[U.RGBA]:r.RGBA},[nt.UNSIGNED_SHORT_5_5_5_1]:{[U.RGBA]:r.RGBA}},t}class Vm{constructor(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new ft,this.hasIntegerTextures=!1}contextChange(){const t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=BT(t),this.samplerTypes=MT(t);const e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(let s=0;s<e;s++)this.boundTextures[s]=null;this.emptyTextures={};const i=new rl(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new rl(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(let s=0;s<6;s++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(let s=0;s<this.boundTextures.length;s++)this.bind(null,s)}bind(t,e=0){const{gl:i}=this;if(t=t==null?void 0:t.castToBaseTexture(),(t==null?void 0:t.valid)&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;const s=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,s.texture)),s.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)):s.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture}unbind(t){const{gl:e,boundTextures:i}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let s=0;s<i.length;s++)i[s]===this.unknownTexture&&this.bind(null,s)}for(let s=0;s<i.length;s++)i[s]===t&&(this.currentLocation!==s&&(e.activeTexture(e.TEXTURE0+s),this.currentLocation=s),e.bindTexture(t.target,this.emptyTextures[t.target].texture),i[s]=null)}ensureSamplerType(t){const{boundTextures:e,hasIntegerTextures:i,CONTEXT_UID:s}=this;if(i)for(let n=t-1;n>=0;--n){const o=e[n];o&&o._glTextures[s].samplerType!==J.FLOAT&&this.renderer.texture.unbind(o)}}initTexture(t){const e=new rl(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e}initTextureType(t,e){var i;e.internalFormat=((i=this.internalFormats[t.type])==null?void 0:i[t.format])??t.format,e.samplerType=this.samplerTypes[e.internalFormat]??J.FLOAT,this.webGLVersion===2&&t.type===nt.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type}updateTexture(t){var s;const e=t._glTextures[this.CONTEXT_UID];if(!e)return;const i=this.renderer;if(this.initTextureType(t,e),(s=t.resource)==null?void 0:s.upload(i,t,e))e.samplerType!==J.FLOAT&&(this.hasIntegerTextures=!0);else{const n=t.realWidth,o=t.realHeight,a=i.gl;(e.width!==n||e.height!==o||e.dirtyId<0)&&(e.width=n,e.height=o,a.texImage2D(t.target,0,e.internalFormat,n,o,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}destroyTexture(t,e){const{gl:i}=this;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){const s=this.managedTextures.indexOf(t);s!==-1&&as(this.managedTextures,s,1)}}updateTextureStyle(t){var i;const e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===sr.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=zr.CLAMP:e.wrapMode=t.wrapMode,(i=t.resource)!=null&&i.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)}setStyle(t,e){const i=this.gl;if(e.mipmap&&t.mipmap!==sr.ON_MANUAL&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===pr.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);const s=this.renderer.context.extensions.anisotropicFiltering;if(s&&t.anisotropicLevel>0&&t.scaleMode===pr.LINEAR){const n=Math.min(t.anisotropicLevel,i.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,s.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===pr.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===pr.LINEAR?i.LINEAR:i.NEAREST)}destroy(){this.renderer=null}}Vm.extension={type:Y.RendererSystem,name:"texture"};rt.add(Vm);class Xm{constructor(t){this.renderer=t}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,s=t._glTransformFeedbacks[i]||this.createGLTransformFeedback(t);e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,s)}unbind(){const{gl:t}=this;t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(t,e){const{gl:i,renderer:s}=this;e&&s.shader.bind(e),i.beginTransformFeedback(t)}endTransformFeedback(){const{gl:t}=this;t.endTransformFeedback()}createGLTransformFeedback(t){const{gl:e,renderer:i,CONTEXT_UID:s}=this,n=e.createTransformFeedback();t._glTransformFeedbacks[s]=n,e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,n);for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];a&&(i.buffer.update(a),a._glBuffers[s].refCount++,e.bindBufferBase(e.TRANSFORM_FEEDBACK_BUFFER,o,a._glBuffers[s].buffer||null))}return e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null),t.disposeRunner.add(this),n}disposeTransformFeedback(t,e){const i=t._glTransformFeedbacks[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this);const n=this.renderer.buffer;if(n)for(let o=0;o<t.buffers.length;o++){const a=t.buffers[o];if(!a)continue;const l=a._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,l.refCount===0&&!e&&n.dispose(a,e))}i&&(e||s.deleteTransformFeedback(i),delete t._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}Xm.extension={type:Y.RendererSystem,name:"transformFeedback"};rt.add(Xm);class ko{constructor(t){this.renderer=t}init(t){this.screen=new mt(0,0,t.width,t.height),this.element=t.view||tt.ADAPTER.createCanvas(),this.resolution=t.resolution||tt.RESOLUTION,this.autoDensity=!!t.autoDensity}resizeView(t,e){this.element.width=Math.round(t*this.resolution),this.element.height=Math.round(e*this.resolution);const i=this.element.width/this.resolution,s=this.element.height/this.resolution;this.screen.width=i,this.screen.height=s,this.autoDensity&&(this.element.style.width=`${i}px`,this.element.style.height=`${s}px`),this.renderer.emit("resize",i,s),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(t){var e;t&&((e=this.element.parentNode)==null||e.removeChild(this.element)),this.renderer=null,this.element=null,this.screen=null}}ko.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},ko.extension={type:[Y.RendererSystem,Y.CanvasRendererSystem],name:"_view"};rt.add(ko);tt.PREFER_ENV=Ri.WEBGL2;tt.STRICT_TEXTURE_CACHE=!1;tt.RENDER_OPTIONS={...No.defaultOptions,...Oo.defaultOptions,...ko.defaultOptions,...Lo.defaultOptions};Object.defineProperties(tt,{WRAP_MODE:{get(){return ft.defaultOptions.wrapMode},set(r){vt("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),ft.defaultOptions.wrapMode=r}},SCALE_MODE:{get(){return ft.defaultOptions.scaleMode},set(r){vt("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),ft.defaultOptions.scaleMode=r}},MIPMAP_TEXTURES:{get(){return ft.defaultOptions.mipmap},set(r){vt("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),ft.defaultOptions.mipmap=r}},ANISOTROPIC_LEVEL:{get(){return ft.defaultOptions.anisotropicLevel},set(r){vt("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),ft.defaultOptions.anisotropicLevel=r}},FILTER_RESOLUTION:{get(){return vt("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),ae.defaultResolution},set(r){ae.defaultResolution=r}},FILTER_MULTISAMPLE:{get(){return vt("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),ae.defaultMultisample},set(r){ae.defaultMultisample=r}},SPRITE_MAX_TEXTURES:{get(){return ui.defaultMaxTextures},set(r){vt("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),ui.defaultMaxTextures=r}},SPRITE_BATCH_SIZE:{get(){return ui.defaultBatchSize},set(r){vt("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),ui.defaultBatchSize=r}},CAN_UPLOAD_SAME_BUFFER:{get(){return ui.canUploadSameBuffer},set(r){vt("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),ui.canUploadSameBuffer=r}},GC_MODE:{get(){return di.defaultMode},set(r){vt("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),di.defaultMode=r}},GC_MAX_IDLE:{get(){return di.defaultMaxIdle},set(r){vt("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),di.defaultMaxIdle=r}},GC_MAX_CHECK_COUNT:{get(){return di.defaultCheckCountMax},set(r){vt("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),di.defaultCheckCountMax=r}},PRECISION_VERTEX:{get(){return yr.defaultVertexPrecision},set(r){vt("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),yr.defaultVertexPrecision=r}},PRECISION_FRAGMENT:{get(){return yr.defaultFragmentPrecision},set(r){vt("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),yr.defaultFragmentPrecision=r}}});var Pi=(r=>(r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY",r))(Pi||{});class il{constructor(t,e=null,i=0,s=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=i,this.once=s}match(t,e=null){return this.fn===t&&this.context===e}emit(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));const e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const zm=class me{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new il(null,null,1/0),this.deltaMS=1/me.targetFPMS,this.elapsedMS=1/me.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,i=Pi.NORMAL){return this._addListener(new il(t,e,i))}addOnce(t,e,i=Pi.NORMAL){return this._addListener(new il(t,e,i,!0))}_addListener(t){let e=this._head.next,i=this._head;if(!e)t.connect(i);else{for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}return this._startIfPossible(),this}remove(t,e){let i=this._head.next;for(;i;)i.match(t,e)?i=i.destroy():i=i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*me.targetFPMS;const i=this._head;let s=i.next;for(;s;)s=s.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,me.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!me._shared){const t=me._shared=new me;t.autoStart=!0,t._protected=!0}return me._shared}static get system(){if(!me._system){const t=me._system=new me;t.autoStart=!0,t._protected=!0}return me._system}};zm.targetFPMS=.06;let ve=zm;Object.defineProperties(tt,{TARGET_FPMS:{get(){return ve.targetFPMS},set(r){vt("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),ve.targetFPMS=r}}});class Wm{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Pi.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?ve.shared:new ve,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Wm.extension=Y.Application;rt.add(Wm);const jm=[];rt.handleByList(Y.Renderer,jm);function DT(r){for(const t of jm)if(t.test(r))return new t(r);throw new Error("Unable to auto-detect a suitable renderer.")}var FT=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,OT=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const NT=FT,Ym=OT;class qm{constructor(t){this.renderer=t}contextChange(t){let e;if(this.renderer.context.webGLVersion===1){const i=t.getParameter(t.FRAMEBUFFER_BINDING);t.bindFramebuffer(t.FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.FRAMEBUFFER,i)}else{const i=t.getParameter(t.DRAW_FRAMEBUFFER_BINDING);t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),e=t.getParameter(t.SAMPLES),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,i)}e>=Xt.HIGH?this.multisample=Xt.HIGH:e>=Xt.MEDIUM?this.multisample=Xt.MEDIUM:e>=Xt.LOW?this.multisample=Xt.LOW:this.multisample=Xt.NONE}destroy(){}}qm.extension={type:Y.RendererSystem,name:"_multisample"};rt.add(qm);class LT{constructor(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class Km{constructor(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(t){const{gl:e,CONTEXT_UID:i}=this,s=t._glBuffers[i]||this.createGLBuffer(t);e.bindBuffer(t.type,s.buffer)}unbind(t){const{gl:e}=this;e.bindBuffer(t,null)}bindBufferBase(t,e){const{gl:i,CONTEXT_UID:s}=this;if(this.boundBufferBases[e]!==t){const n=t._glBuffers[s]||this.createGLBuffer(t);this.boundBufferBases[e]=t,i.bindBufferBase(i.UNIFORM_BUFFER,e,n.buffer)}}bindBufferRange(t,e,i){const{gl:s,CONTEXT_UID:n}=this;i=i||0;const o=t._glBuffers[n]||this.createGLBuffer(t);s.bindBufferRange(s.UNIFORM_BUFFER,e||0,o.buffer,i*256,256)}update(t){const{gl:e,CONTEXT_UID:i}=this,s=t._glBuffers[i]||this.createGLBuffer(t);if(t._updateID!==s.updateID)if(s.updateID=t._updateID,e.bindBuffer(t.type,s.buffer),s.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{const n=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;s.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,n)}}dispose(t,e){if(!this.managedBuffers[t.id])return;delete this.managedBuffers[t.id];const i=t._glBuffers[this.CONTEXT_UID],s=this.gl;t.disposeRunner.remove(this),i&&(e||s.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}disposeAll(t){const e=Object.keys(this.managedBuffers);for(let i=0;i<e.length;i++)this.dispose(this.managedBuffers[e[i]],t)}createGLBuffer(t){const{CONTEXT_UID:e,gl:i}=this;return t._glBuffers[e]=new LT(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]}}Km.extension={type:Y.RendererSystem,name:"buffer"};rt.add(Km);class Zm{constructor(t){this.renderer=t}render(t,e){const i=this.renderer;let s,n,o,a;if(e&&(s=e.renderTexture,n=e.clear,o=e.transform,a=e.skipUpdateTransform),this.renderingToScreen=!s,i.runners.prerender.emit(),i.emit("prerender"),i.projection.transform=o,!i.context.isLost){if(s||(this.lastObjectRendered=t),!a){const l=t.enableTempParent();t.updateTransform(),t.disableTempParent(l)}i.renderTexture.bind(s),i.batch.currentRenderer.start(),(n??i.background.clearBeforeRender)&&i.renderTexture.clear(),t.render(i),i.batch.currentRenderer.flush(),s&&(e.blit&&i.framebuffer.blit(),s.baseTexture.update()),i.runners.postrender.emit(),i.projection.transform=null,i.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}Zm.extension={type:Y.RendererSystem,name:"objectRenderer"};rt.add(Zm);const fo=class ph extends RT{constructor(t){super(),this.type=Gp.WEBGL,t=Object.assign({},tt.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new Le({projectionMatrix:new Dt},!0);const e={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:ph.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(e),"useContextAlpha"in t&&(vt("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&t.useContextAlpha!=="notMultiplied",t.backgroundAlpha=t.useContextAlpha===!1?1:t.backgroundAlpha),this._plugin.rendererPlugins=ph.__plugins,this.options=t,this.startup.run(this.options)}static test(t){return t!=null&&t.forceCanvas?!1:oE()}render(t,e){this.objectRenderer.render(t,e)}resize(t,e){this._view.resizeView(t,e)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(t=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:t}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(t){this._view.resolution=t,this.runners.resolutionChange.emit(t)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return vt("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return vt("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return vt("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return vt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(t){vt("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=t}get backgroundAlpha(){return vt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(t){vt("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=t}get powerPreference(){return vt("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(t,e){return this.textureGenerator.generateTexture(t,e)}};fo.extension={type:Y.Renderer,priority:1},fo.__plugins={},fo.__systems={};let xc=fo;rt.handleByMap(Y.RendererPlugin,xc.__plugins);rt.handleByMap(Y.RendererSystem,xc.__systems);rt.add(xc);class Qm extends mn{constructor(t,e){const{width:i,height:s}=e||{};super(i,s),this.items=[],this.itemDirtyIds=[];for(let n=0;n<t;n++){const o=new ft;this.items.push(o),this.itemDirtyIds.push(-2)}this.length=t,this._load=null,this.baseTexture=null}initFromArray(t,e){for(let i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof mn?this.addResourceAt(t[i],i):this.addResourceAt(gm(t[i],e),i))}dispose(){for(let t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(t,e){if(!this.items[e])throw new Error(`Index ${e} is out of bounds`);return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this}bind(t){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");super.bind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=t,this.items[e].on("update",t.update,t)}unbind(t){super.unbind(t);for(let e=0;e<this.length;e++)this.items[e].parentTextureArray=null,this.items[e].off("update",t.update,t)}load(){if(this._load)return this._load;const t=this.items.map(e=>e.resource).filter(e=>e).map(e=>e.load());return this._load=Promise.all(t).then(()=>{const{realWidth:e,realHeight:i}=this.items[0];return this.resize(e,i),this.update(),Promise.resolve(this)}),this._load}}class kT extends Qm{constructor(t,e){const{width:i,height:s}=e||{};let n,o;Array.isArray(t)?(n=t,o=t.length):o=t,super(o,{width:i,height:s}),n&&this.initFromArray(n,e)}addBaseTextureAt(t,e){if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("ArrayResource does not support RenderTexture");return this}bind(t){super.bind(t),t.target=ss.TEXTURE_2D_ARRAY}upload(t,e,i){const{length:s,itemDirtyIds:n,items:o}=this,{gl:a}=t;i.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,s,0,e.format,i.type,null);for(let l=0;l<s;l++){const h=o[l];n[l]<h.dirtyId&&(n[l]=h.dirtyId,h.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,h.resource.width,h.resource.height,1,e.format,i.type,h.resource.source))}return!0}}class UT extends qr{constructor(t){super(t)}static test(t){const{OffscreenCanvas:e}=globalThis;return e&&t instanceof e?!0:globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement}}const Jm=class Hs extends Qm{constructor(t,e){const{width:i,height:s,autoLoad:n,linkBaseTexture:o}=e||{};if(t&&t.length!==Hs.SIDES)throw new Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:i,height:s});for(let a=0;a<Hs.SIDES;a++)this.items[a].target=ss.TEXTURE_CUBE_MAP_POSITIVE_X+a;this.linkBaseTexture=o!==!1,t&&this.initFromArray(t,e),n!==!1&&this.load()}bind(t){super.bind(t),t.target=ss.TEXTURE_CUBE_MAP}addBaseTextureAt(t,e,i){if(i===void 0&&(i=this.linkBaseTexture),!this.items[e])throw new Error(`Index ${e} is out of bounds`);if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0)if(t.resource)this.addResourceAt(t.resource,e);else throw new Error("CubeResource does not support copying of renderTexture.");else t.target=ss.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this}upload(t,e,i){const s=this.itemDirtyIds;for(let n=0;n<Hs.SIDES;n++){const o=this.items[n];(s[n]<o.dirtyId||i.dirtyId<e.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(t,o,i),s[n]=o.dirtyId):s[n]<-1&&(t.gl.texImage2D(o.target,0,i.internalFormat,e.realWidth,e.realHeight,0,e.format,i.type,null),s[n]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===Hs.SIDES}};Jm.SIDES=6;let GT=Jm;class Ji extends qr{constructor(t,e){e=e||{};let i,s,n;typeof t=="string"?(i=Ji.EMPTY,s=t,n=!0):(i=t,s=null,n=!1),super(i),this.url=s,this.crossOrigin=e.crossOrigin??!0,this.alphaMode=typeof e.alphaMode=="number"?e.alphaMode:null,this.ownsImageBitmap=e.ownsImageBitmap??n,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(async(t,e)=>{if(this.url===null){t(this);return}try{const i=await tt.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;const s=await i.blob();if(this.destroyed)return;const n=await createImageBitmap(s,{premultiplyAlpha:this.alphaMode===null||this.alphaMode===de.UNPACK?"premultiply":"none"});if(this.destroyed){n.close();return}this.source=n,this.update(),t(this)}catch(i){if(this.destroyed)return;e(i),this.onError.emit(i)}}),this._load)}upload(t,e,i){return this.source instanceof ImageBitmap?(typeof this.alphaMode=="number"&&(e.alphaMode=this.alphaMode),super.upload(t,e,i)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(t){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&(typeof t=="string"||t instanceof ImageBitmap)}static get EMPTY(){return Ji._EMPTY=Ji._EMPTY??tt.ADAPTER.createCanvas(0,0),Ji._EMPTY}}const mh=class po extends qr{constructor(t,e){e=e||{},super(tt.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=t,this.scale=e.scale||1,this._overrideWidth=e.width,this._overrideHeight=e.height,this._resolve=null,this._crossorigin=e.crossorigin,this._load=null,e.autoLoad!==!1&&this.load()}load(){return this._load?this._load:(this._load=new Promise(t=>{if(this._resolve=()=>{this.update(),t(this)},po.SVG_XML.test(this.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()}),this._load)}_loadSvg(){const t=new Image;qr.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=e=>{this._resolve&&(t.onerror=null,this.onError.emit(e))},t.onload=()=>{if(!this._resolve)return;const e=t.width,i=t.height;if(!e||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let s=e*this.scale,n=i*this.scale;(this._overrideWidth||this._overrideHeight)&&(s=this._overrideWidth||this._overrideHeight/i*e,n=this._overrideHeight||this._overrideWidth/e*i),s=Math.round(s),n=Math.round(n);const o=this.source;o.width=s,o.height=n,o._pixiId=`canvas_${Ii()}`,o.getContext("2d").drawImage(t,0,0,e,i,0,0,s,n),this._resolve(),this._resolve=null}}static getSize(t){const e=po.SVG_SIZE.exec(t),i={};return e&&(i[e[1]]=Math.round(parseFloat(e[3])),i[e[5]]=Math.round(parseFloat(e[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,e){return e==="svg"||typeof t=="string"&&t.startsWith("data:image/svg+xml")||typeof t=="string"&&po.SVG_XML.test(t)}};mh.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,mh.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;let gh=mh;const yh=class _h extends qr{constructor(t,e){if(e=e||{},!(t instanceof HTMLVideoElement)){const i=document.createElement("video");e.autoLoad!==!1&&i.setAttribute("preload","auto"),e.playsinline!==!1&&(i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","")),e.muted===!0&&(i.setAttribute("muted",""),i.muted=!0),e.loop===!0&&i.setAttribute("loop",""),e.autoPlay!==!1&&i.setAttribute("autoplay",""),typeof t=="string"&&(t=[t]);const s=t[0].src||t[0];qr.crossOrigin(i,s,e.crossorigin);for(let n=0;n<t.length;++n){const o=document.createElement("source");let{src:a,mime:l}=t[n];if(a=a||t[n],a.startsWith("data:"))l=a.slice(5,a.indexOf(";"));else if(!a.startsWith("blob:")){const h=a.split("?").shift().toLowerCase(),c=h.slice(h.lastIndexOf(".")+1);l=l||_h.MIME_TYPES[c]||`video/${c}`}o.src=a,l&&(o.type=l),i.appendChild(o)}t=i}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=e.autoPlay!==!1,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),e.autoLoad!==!1&&this.load()}update(t=0){if(!this.destroyed){if(this._updateFPS){const e=ve.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;const t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((e,i)=>{this.valid?e(this):(this._resolve=e,this._reject=i,t.load())}),this._load}_onError(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.source;return!t.paused&&!t.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){const t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);const e=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!e&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()}dispose(){this._configureAutoUpdate();const t=this.source;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(ve.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(ve.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(ve.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t,e){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||_h.TYPES.includes(e)}};yh.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],yh.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let tg=yh;sh.push(Ji,Am,UT,tg,gh,da,GT,kT);class Uo{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(t){return this.minX>this.maxX||this.minY>this.maxY?mt.EMPTY:(t=t||new mt(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)}addPoint(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)}addPointMatrix(t,e){const{a:i,b:s,c:n,d:o,tx:a,ty:l}=t,h=i*e.x+n*e.y+a,c=s*e.x+o*e.y+l;this.minX=Math.min(this.minX,h),this.maxX=Math.max(this.maxX,h),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)}addQuad(t){let e=this.minX,i=this.minY,s=this.maxX,n=this.maxY,o=t[0],a=t[1];e=o<e?o:e,i=a<i?a:i,s=o>s?o:s,n=a>n?a:n,o=t[2],a=t[3],e=o<e?o:e,i=a<i?a:i,s=o>s?o:s,n=a>n?a:n,o=t[4],a=t[5],e=o<e?o:e,i=a<i?a:i,s=o>s?o:s,n=a>n?a:n,o=t[6],a=t[7],e=o<e?o:e,i=a<i?a:i,s=o>s?o:s,n=a>n?a:n,this.minX=e,this.minY=i,this.maxX=s,this.maxY=n}addFrame(t,e,i,s,n){this.addFrameMatrix(t.worldTransform,e,i,s,n)}addFrameMatrix(t,e,i,s,n){const o=t.a,a=t.b,l=t.c,h=t.d,c=t.tx,u=t.ty;let d=this.minX,f=this.minY,p=this.maxX,m=this.maxY,g=o*e+l*i+c,y=a*e+h*i+u;d=g<d?g:d,f=y<f?y:f,p=g>p?g:p,m=y>m?y:m,g=o*s+l*i+c,y=a*s+h*i+u,d=g<d?g:d,f=y<f?y:f,p=g>p?g:p,m=y>m?y:m,g=o*e+l*n+c,y=a*e+h*n+u,d=g<d?g:d,f=y<f?y:f,p=g>p?g:p,m=y>m?y:m,g=o*s+l*n+c,y=a*s+h*n+u,d=g<d?g:d,f=y<f?y:f,p=g>p?g:p,m=y>m?y:m,this.minX=d,this.minY=f,this.maxX=p,this.maxY=m}addVertexData(t,e,i){let s=this.minX,n=this.minY,o=this.maxX,a=this.maxY;for(let l=e;l<i;l+=2){const h=t[l],c=t[l+1];s=h<s?h:s,n=c<n?c:n,o=h>o?h:o,a=c>a?c:a}this.minX=s,this.minY=n,this.maxX=o,this.maxY=a}addVertices(t,e,i,s){this.addVerticesMatrix(t.worldTransform,e,i,s)}addVerticesMatrix(t,e,i,s,n=0,o=n){const a=t.a,l=t.b,h=t.c,c=t.d,u=t.tx,d=t.ty;let f=this.minX,p=this.minY,m=this.maxX,g=this.maxY;for(let y=i;y<s;y+=2){const x=e[y],_=e[y+1],b=a*x+h*_+u,S=c*_+l*x+d;f=Math.min(f,b-n),m=Math.max(m,b+n),p=Math.min(p,S-o),g=Math.max(g,S+o)}this.minX=f,this.minY=p,this.maxX=m,this.maxY=g}addBounds(t){const e=this.minX,i=this.minY,s=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>s?t.maxX:s,this.maxY=t.maxY>n?t.maxY:n}addBoundsMask(t,e){const i=t.minX>e.minX?t.minX:e.minX,s=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=n&&s<=o){const a=this.minX,l=this.minY,h=this.maxX,c=this.maxY;this.minX=i<a?i:a,this.minY=s<l?s:l,this.maxX=n>h?n:h,this.maxY=o>c?o:c}}addBoundsMatrix(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)}addBoundsArea(t,e){const i=t.minX>e.x?t.minX:e.x,s=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=n&&s<=o){const a=this.minX,l=this.minY,h=this.maxX,c=this.maxY;this.minX=i<a?i:a,this.minY=s<l?s:l,this.maxX=n>h?n:h,this.maxY=o>c?o:c}}pad(t=0,e=t){this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)}addFramePad(t,e,i,s,n,o){t-=n,e-=o,i+=n,s+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>s?this.maxY:s}}class kt extends yn{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new _c,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new Uo,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(t){const e=Object.keys(t);for(let i=0;i<e.length;++i){const s=e[i];Object.defineProperty(kt.prototype,s,Object.getOwnPropertyDescriptor(t,s))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new mt),e=this._boundsRect),this._bounds.getRectangle(e)}getLocalBounds(t){t||(this._localBoundsRect||(this._localBoundsRect=new mt),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Uo);const e=this.transform,i=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=(i==null?void 0:i.worldAlpha)??1,this.transform=this._tempDisplayObjectParent.transform;const s=this._bounds,n=this._boundsID;this._bounds=this._localBounds;const o=this.getBounds(!1,t);return this.parent=i,this.transform=e,this._bounds=s,this._bounds.updateID+=this._boundsID-n,o}toGlobal(t,e,i=!1){return i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)}toLocal(t,e,i,s){return e&&(t=e.toGlobal(t,i,s)),s||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)}setParent(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t}removeFromParent(){var t;(t=this.parent)==null||t.removeChild(this)}setTransform(t=0,e=0,i=1,s=1,n=0,o=0,a=0,l=0,h=0){return this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=s||1,this.rotation=n,this.skew.x=o,this.skew.y=a,this.pivot.x=l,this.pivot.y=h,this}destroy(t){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new HT),this.tempDisplayObjectParent}enableTempParent(){const t=this.parent;return this.parent=this._tempDisplayObjectParent,t}disableTempParent(t){this.parent=t}get x(){return this.position.x}set x(t){this.transform.position.x=t}get y(){return this.position.y}set y(t){this.transform.position.y=t}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(t){this.transform.position.copyFrom(t)}get scale(){return this.transform.scale}set scale(t){this.transform.scale.copyFrom(t)}get pivot(){return this.transform.pivot}set pivot(t){this.transform.pivot.copyFrom(t)}get skew(){return this.transform.skew}set skew(t){this.transform.skew.copyFrom(t)}get rotation(){return this.transform.rotation}set rotation(t){this.transform.rotation=t}get angle(){return this.transform.rotation*FE}set angle(t){this.transform.rotation=t*OE}get zIndex(){return this._zIndex}set zIndex(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)}get worldVisible(){let t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0}get mask(){return this._mask}set mask(t){if(this._mask!==t){if(this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,e._maskRefCount===0&&(e.renderable=!0,e.isMask=!1))}if(this._mask=t,this._mask){const e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount===0&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class HT extends kt{constructor(){super(...arguments),this.sortDirty=null}}kt.prototype.displayObjectUpdateTransform=kt.prototype.updateTransform;const $T=new Dt;function VT(r,t){return r.zIndex===t.zIndex?r._lastSortedIndex-t._lastSortedIndex:r.zIndex-t.zIndex}const eg=class vh extends kt{constructor(){super(),this.children=[],this.sortableChildren=vh.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(t){}addChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.addChild(t[e]);else{const e=t[0];e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this)}return t[0]}addChildAt(t,e){if(e<0||e>this.children.length)throw new Error(`${t}addChildAt: The index ${e} supplied is out of bounds ${this.children.length}`);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t}swapChildren(t,e){if(t===e)return;const i=this.getChildIndex(t),s=this.getChildIndex(e);this.children[i]=e,this.children[s]=t,this.onChildrenChange(i<s?i:s)}getChildIndex(t){const e=this.children.indexOf(t);if(e===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return e}setChildIndex(t,e){if(e<0||e>=this.children.length)throw new Error(`The index ${e} supplied is out of bounds ${this.children.length}`);const i=this.getChildIndex(t);as(this.children,i,1),this.children.splice(e,0,t),this.onChildrenChange(e)}getChildAt(t){if(t<0||t>=this.children.length)throw new Error(`getChildAt: Index (${t}) does not exist.`);return this.children[t]}removeChild(...t){if(t.length>1)for(let e=0;e<t.length;e++)this.removeChild(t[e]);else{const e=t[0],i=this.children.indexOf(e);if(i===-1)return null;e.parent=null,e.transform._parentID=-1,as(this.children,i,1),this._boundsID++,this.onChildrenChange(i),e.emit("removed",this),this.emit("childRemoved",e,this,i)}return t[0]}removeChildAt(t){const e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,as(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e}removeChildren(t=0,e=this.children.length){const i=t,s=e,n=s-i;let o;if(n>0&&n<=s){o=this.children.splice(i,n);for(let a=0;a<o.length;++a)o[a].parent=null,o[a].transform&&(o[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(let a=0;a<o.length;++a)o[a].emit("removed",this),this.emit("childRemoved",o[a],this,a);return o}else if(n===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let t=!1;for(let e=0,i=this.children.length;e<i;++e){const s=this.children[e];s._lastSortedIndex=e,!t&&s.zIndex!==0&&(t=!0)}t&&this.children.length>1&&this.children.sort(VT),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let t=0,e=this.children.length;t<e;++t){const i=this.children[t];i.visible&&i.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let t=0;t<this.children.length;t++){const e=this.children[t];if(!(!e.visible||!e.renderable))if(e.calculateBounds(),e._mask){const i=e._mask.isMaskData?e._mask.maskObject:e._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID}getLocalBounds(t,e=!1){const i=super.getLocalBounds(t);if(!e)for(let s=0,n=this.children.length;s<n;++s){const o=this.children[s];o.visible&&o.updateTransform()}return i}_calculateBounds(){}_renderWithCulling(t){const e=t.renderTexture.sourceFrame;if(!(e.width>0&&e.height>0))return;let i,s;this.cullArea?(i=this.cullArea,s=this.worldTransform):this._render!==vh.prototype._render&&(i=this.getBounds(!0));const n=t.projection.transform;if(n&&(s?(s=$T.copyFrom(s),s.prepend(n)):s=n),i&&e.intersects(i,s))this._render(t);else if(this.cullArea)return;for(let o=0,a=this.children.length;o<a;++o){const l=this.children[o],h=l.cullable;l.cullable=h||!this.cullArea,l.render(t),l.cullable=h}}render(t){var e;if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||(e=this.filters)!=null&&e.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(let i=0,s=this.children.length;i<s;++i)this.children[i].render(t)}}renderAdvanced(t){var n,o,a;const e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let l=0;l<e.length;l++)e[l].enabled&&this._enabledFilters.push(e[l])}const s=e&&((n=this._enabledFilters)==null?void 0:n.length)||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==zt.NONE));if(s&&t.batch.flush(),e&&((o=this._enabledFilters)!=null&&o.length)&&t.filter.push(this,this._enabledFilters),i&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);for(let l=0,h=this.children.length;l<h;++l)this.children[l].render(t)}s&&t.batch.flush(),i&&t.mask.pop(this),e&&((a=this._enabledFilters)!=null&&a.length)&&t.filter.pop()}_render(t){}destroy(t){super.destroy(),this.sortDirty=!1;const e=typeof t=="boolean"?t:t==null?void 0:t.children,i=this.removeChildren(0,this.children.length);if(e)for(let s=0;s<i.length;++s)i[s].destroy(t)}get width(){return this.scale.x*this.getLocalBounds().width}set width(t){const e=this.getLocalBounds().width;e!==0?this.scale.x=t/e:this.scale.x=1,this._width=t}get height(){return this.scale.y*this.getLocalBounds().height}set height(t){const e=this.getLocalBounds().height;e!==0?this.scale.y=t/e:this.scale.y=1,this._height=t}};eg.defaultSortableChildren=!1;let le=eg;le.prototype.containerUpdateTransform=le.prototype.updateTransform;Object.defineProperties(tt,{SORTABLE_CHILDREN:{get(){return le.defaultSortableChildren},set(r){vt("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),le.defaultSortableChildren=r}}});const Os=new wt,XT=new Uint16Array([0,1,2,0,2,3]);class Di extends le{constructor(t){super(),this._anchor=new gr(this._onAnchorUpdate,this,t?t.defaultAnchor.x:0,t?t.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new Bt(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=ct.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=t||et.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=XT,this.pluginName="batch",this.isSprite=!0,this._roundPixels=tt.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Gr(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Gr(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){const t=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===t._updateID)return;this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;const e=this.transform.worldTransform,i=e.a,s=e.b,n=e.c,o=e.d,a=e.tx,l=e.ty,h=this.vertexData,c=t.trim,u=t.orig,d=this._anchor;let f=0,p=0,m=0,g=0;if(c?(p=c.x-d._x*u.width,f=p+c.width,g=c.y-d._y*u.height,m=g+c.height):(p=-d._x*u.width,f=p+u.width,g=-d._y*u.height,m=g+u.height),h[0]=i*p+n*g+a,h[1]=o*g+s*p+l,h[2]=i*f+n*g+a,h[3]=o*g+s*f+l,h[4]=i*f+n*m+a,h[5]=o*m+s*f+l,h[6]=i*p+n*m+a,h[7]=o*m+s*p+l,this._roundPixels){const y=tt.RESOLUTION;for(let x=0;x<h.length;++x)h[x]=Math.round(h[x]*y)/y}}calculateTrimmedVertices(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;const t=this._texture,e=this.vertexTrimmedData,i=t.orig,s=this._anchor,n=this.transform.worldTransform,o=n.a,a=n.b,l=n.c,h=n.d,c=n.tx,u=n.ty,d=-s._x*i.width,f=d+i.width,p=-s._y*i.height,m=p+i.height;if(e[0]=o*d+l*p+c,e[1]=h*p+a*d+u,e[2]=o*f+l*p+c,e[3]=h*p+a*f+u,e[4]=o*f+l*m+c,e[5]=h*m+a*f+u,e[6]=o*d+l*m+c,e[7]=h*m+a*d+u,this._roundPixels){const g=tt.RESOLUTION;for(let y=0;y<e.length;++y)e[y]=Math.round(e[y]*g)/g}}_render(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)}_calculateBounds(){const t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))}getLocalBounds(t){return this.children.length===0?(this._localBounds||(this._localBounds=new Uo),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new mt),t=this._localBoundsRect),this._localBounds.getRectangle(t)):super.getLocalBounds.call(this,t)}containsPoint(t){this.worldTransform.applyInverse(t,Os);const e=this._texture.orig.width,i=this._texture.orig.height,s=-e*this.anchor.x;let n=0;return Os.x>=s&&Os.x<s+e&&(n=-i*this.anchor.y,Os.y>=n&&Os.y<n+i)}destroy(t){if(super.destroy(t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,typeof t=="boolean"?t:t==null?void 0:t.texture){const e=typeof t=="boolean"?t:t==null?void 0:t.baseTexture;this._texture.destroy(!!e)}this._texture=null}static from(t,e){const i=t instanceof et?t:et.from(t,e);return new Di(i)}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){const e=Gr(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){const e=Gr(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get anchor(){return this._anchor}set anchor(t){this._anchor.copyFrom(t)}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||et.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))}}const rg=new Dt;kt.prototype._cacheAsBitmap=!1;kt.prototype._cacheData=null;kt.prototype._cacheAsBitmapResolution=null;kt.prototype._cacheAsBitmapMultisample=null;class zT{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(kt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(r){r!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(r){r!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(r){if(this._cacheAsBitmap===r)return;this._cacheAsBitmap=r;let t;r?(this._cacheData||(this._cacheData=new zT),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}});kt.prototype._renderCached=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(r),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(r))};kt.prototype._initCachedDisplayObject=function(r){var d,f;if((d=this._cacheData)!=null&&d.sprite)return;const t=this.alpha;this.alpha=1,r.batch.flush();const e=this.getLocalBounds(new mt,!0);if((f=this.filters)!=null&&f.length){const p=this.filters[0].padding;e.pad(p)}const i=this.cacheAsBitmapResolution||r.resolution;e.ceil(i),e.width=Math.max(e.width,1/i),e.height=Math.max(e.height,1/i);const s=r.renderTexture.current,n=r.renderTexture.sourceFrame.clone(),o=r.renderTexture.destinationFrame.clone(),a=r.projection.transform,l=Bi.create({width:e.width,height:e.height,resolution:i,multisample:this.cacheAsBitmapMultisample??r.multisample}),h=`cacheAsBitmap_${Ii()}`;this._cacheData.textureCacheId=h,ft.addToCache(l.baseTexture,h),et.addToCache(l,h);const c=this.transform.localTransform.copyTo(rg).invert().translate(-e.x,-e.y);this.render=this._cacheData.originalRender,r.render(this,{renderTexture:l,clear:!0,transform:c,skipUpdateTransform:!1}),r.framebuffer.blit(),r.projection.transform=a,r.renderTexture.bind(s,n,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;const u=new Di(l);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(e.x/e.width),u.anchor.y=-(e.y/e.height),u.alpha=t,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=u.containsPoint.bind(u)};kt.prototype._renderCachedCanvas=function(r){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(r),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(r))};kt.prototype._initCachedDisplayObjectCanvas=function(r){var c;if((c=this._cacheData)!=null&&c.sprite)return;const t=this.getLocalBounds(new mt,!0),e=this.alpha;this.alpha=1;const i=r.canvasContext.activeContext,s=r._projTransform,n=this.cacheAsBitmapResolution||r.resolution;t.ceil(n),t.width=Math.max(t.width,1/n),t.height=Math.max(t.height,1/n);const o=Bi.create({width:t.width,height:t.height,resolution:n}),a=`cacheAsBitmap_${Ii()}`;this._cacheData.textureCacheId=a,ft.addToCache(o.baseTexture,a),et.addToCache(o,a);const l=rg;this.transform.localTransform.copyTo(l),l.invert(),l.tx-=t.x,l.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,r.render(this,{renderTexture:o,clear:!0,transform:l,skipUpdateTransform:!1}),r.canvasContext.activeContext=i,r._projTransform=s,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=e;const h=new Di(o);h.transform.worldTransform=this.transform.worldTransform,h.anchor.x=-(t.x/t.width),h.anchor.y=-(t.y/t.height),h.alpha=e,h._bounds=this._bounds,this._cacheData.sprite=h,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=r._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=h.containsPoint.bind(h)};kt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};kt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};kt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,ft.removeFromCache(this._cacheData.textureCacheId),et.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};kt.prototype._cacheAsBitmapDestroy=function(r){this.cacheAsBitmap=!1,this.destroy(r)};kt.prototype.name=null;le.prototype.getChildByName=function(r,t){for(let e=0,i=this.children.length;e<i;e++)if(this.children[e].name===r)return this.children[e];if(t)for(let e=0,i=this.children.length;e<i;e++){const s=this.children[e];if(!s.getChildByName)continue;const n=s.getChildByName(r,!0);if(n)return n}return null};kt.prototype.getGlobalPosition=function(r=new wt,t=!1){return this.parent?this.parent.toGlobal(this.position,r,t):(r.x=this.position.x,r.y=this.position.y),r};var WT=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;class jT extends ae{constructor(t=1){super(NT,WT,{uAlpha:1}),this.alpha=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}const YT={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},qT=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`);function KT(r){const t=YT[r],e=t.length;let i=qT,s="";const n="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;";let o;for(let a=0;a<r;a++){let l=n.replace("%index%",a.toString());o=a,a>=e&&(o=r-a-1),l=l.replace("%value%",t[o].toString()),s+=l,s+=`
`}return i=i.replace("%blur%",s),i=i.replace("%size%",r.toString()),i}const ZT=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;function QT(r,t){const e=Math.ceil(r/2);let i=ZT,s="",n;t?n="vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":n="vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let o=0;o<r;o++){let a=n.replace("%index%",o.toString());a=a.replace("%sampleIndex%",`${o-(e-1)}.0`),s+=a,s+=`
`}return i=i.replace("%blur%",s),i=i.replace("%size%",r.toString()),i}class xh extends ae{constructor(t,e=8,i=4,s=ae.defaultResolution,n=5){const o=QT(n,t),a=KT(n);super(o,a),this.horizontal=t,this.resolution=s,this._quality=0,this.quality=i,this.blur=e}apply(t,e,i,s){if(i?this.horizontal?this.uniforms.strength=1/i.width*(i.width/e.width):this.uniforms.strength=1/i.height*(i.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,this.passes===1)t.applyFilter(this,e,i,s);else{const n=t.getFilterTexture(),o=t.renderer;let a=e,l=n;this.state.blend=!1,t.applyFilter(this,a,l,Ye.CLEAR);for(let h=1;h<this.passes-1;h++){t.bindAndClear(a,Ye.BLIT),this.uniforms.uSampler=l;const c=l;l=a,a=c,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,l,i,s),t.returnFilterTexture(n)}}get blur(){return this.strength}set blur(t){this.padding=1+Math.abs(t)*2,this.strength=t}get quality(){return this._quality}set quality(t){this._quality=t,this.passes=t}}class JT extends ae{constructor(t=8,e=4,i=ae.defaultResolution,s=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new xh(!0,t,e,i,s),this.blurYFilter=new xh(!1,t,e,i,s),this.resolution=i,this.quality=e,this.blur=t,this.repeatEdgePixels=!1}apply(t,e,i,s){const n=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(n&&o){const a=t.getFilterTexture();this.blurXFilter.apply(t,e,a,Ye.CLEAR),this.blurYFilter.apply(t,a,i,s),t.returnFilterTexture(a)}else o?this.blurYFilter.apply(t,e,i,s):this.blurXFilter.apply(t,e,i,s)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))*2}get blur(){return this.blurXFilter.blur}set blur(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(t){this.blurXFilter.quality=this.blurYFilter.quality=t}get blurX(){return this.blurXFilter.blur}set blurX(t){this.blurXFilter.blur=t,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(t){this.blurYFilter.blur=t,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(t){this.blurYFilter.blendMode=t}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(t){this._repeatEdgePixels=t,this.updatePadding()}}var tw=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class bh extends ae{constructor(){const t={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};super(Ym,tw,t),this.alpha=1}_loadMatrix(t,e=!1){let i=t;e&&(this._multiply(i,this.uniforms.m,t),i=this._colorMatrix(i)),this.uniforms.m=i}_multiply(t,e,i){return t[0]=e[0]*i[0]+e[1]*i[5]+e[2]*i[10]+e[3]*i[15],t[1]=e[0]*i[1]+e[1]*i[6]+e[2]*i[11]+e[3]*i[16],t[2]=e[0]*i[2]+e[1]*i[7]+e[2]*i[12]+e[3]*i[17],t[3]=e[0]*i[3]+e[1]*i[8]+e[2]*i[13]+e[3]*i[18],t[4]=e[0]*i[4]+e[1]*i[9]+e[2]*i[14]+e[3]*i[19]+e[4],t[5]=e[5]*i[0]+e[6]*i[5]+e[7]*i[10]+e[8]*i[15],t[6]=e[5]*i[1]+e[6]*i[6]+e[7]*i[11]+e[8]*i[16],t[7]=e[5]*i[2]+e[6]*i[7]+e[7]*i[12]+e[8]*i[17],t[8]=e[5]*i[3]+e[6]*i[8]+e[7]*i[13]+e[8]*i[18],t[9]=e[5]*i[4]+e[6]*i[9]+e[7]*i[14]+e[8]*i[19]+e[9],t[10]=e[10]*i[0]+e[11]*i[5]+e[12]*i[10]+e[13]*i[15],t[11]=e[10]*i[1]+e[11]*i[6]+e[12]*i[11]+e[13]*i[16],t[12]=e[10]*i[2]+e[11]*i[7]+e[12]*i[12]+e[13]*i[17],t[13]=e[10]*i[3]+e[11]*i[8]+e[12]*i[13]+e[13]*i[18],t[14]=e[10]*i[4]+e[11]*i[9]+e[12]*i[14]+e[13]*i[19]+e[14],t[15]=e[15]*i[0]+e[16]*i[5]+e[17]*i[10]+e[18]*i[15],t[16]=e[15]*i[1]+e[16]*i[6]+e[17]*i[11]+e[18]*i[16],t[17]=e[15]*i[2]+e[16]*i[7]+e[17]*i[12]+e[18]*i[17],t[18]=e[15]*i[3]+e[16]*i[8]+e[17]*i[13]+e[18]*i[18],t[19]=e[15]*i[4]+e[16]*i[9]+e[17]*i[14]+e[18]*i[19]+e[19],t}_colorMatrix(t){const e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e}brightness(t,e){const i=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)}tint(t,e){const[i,s,n]=Bt.shared.setValue(t).toArray(),o=[i,0,0,0,0,0,s,0,0,0,0,0,n,0,0,0,0,0,1,0];this._loadMatrix(o,e)}greyscale(t,e){const i=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(i,e)}blackAndWhite(t){const e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(e,t)}hue(t,e){t=(t||0)/180*Math.PI;const i=Math.cos(t),s=Math.sin(t),n=Math.sqrt,o=1/3,a=n(o),l=i+(1-i)*o,h=o*(1-i)-a*s,c=o*(1-i)+a*s,u=o*(1-i)+a*s,d=i+o*(1-i),f=o*(1-i)-a*s,p=o*(1-i)-a*s,m=o*(1-i)+a*s,g=i+o*(1-i),y=[l,h,c,0,0,u,d,f,0,0,p,m,g,0,0,0,0,0,1,0];this._loadMatrix(y,e)}contrast(t,e){const i=(t||0)+1,s=-.5*(i-1),n=[i,0,0,0,s,0,i,0,0,s,0,0,i,0,s,0,0,0,1,0];this._loadMatrix(n,e)}saturate(t=0,e){const i=t*2/3+1,s=(i-1)*-.5,n=[i,s,s,0,0,s,i,s,0,0,s,s,i,0,0,0,0,0,1,0];this._loadMatrix(n,e)}desaturate(){this.saturate(-1)}negative(t){const e=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(e,t)}sepia(t){const e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(e,t)}technicolor(t){const e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(e,t)}polaroid(t){const e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(e,t)}toBGR(t){const e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(e,t)}kodachrome(t){const e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(e,t)}browni(t){const e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(e,t)}vintage(t){const e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(e,t)}colorTone(t,e,i,s,n){t=t||.2,e=e||.15,i=i||16770432,s=s||3375104;const o=Bt.shared,[a,l,h]=o.setValue(i).toArray(),[c,u,d]=o.setValue(s).toArray(),f=[.3,.59,.11,0,0,a,l,h,t,0,c,u,d,e,0,a-c,l-u,h-d,0,0];this._loadMatrix(f,n)}night(t,e){t=t||.1;const i=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0];this._loadMatrix(i,e)}predator(t,e){const i=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(i,e)}lsd(t){const e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(e,t)}reset(){const t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(t,!1)}get matrix(){return this.uniforms.m}set matrix(t){this.uniforms.m=t}get alpha(){return this.uniforms.uAlpha}set alpha(t){this.uniforms.uAlpha=t}}bh.prototype.grayscale=bh.prototype.greyscale;var ew=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,rw=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`;class iw extends ae{constructor(t,e){const i=new Dt;t.renderable=!1,super(rw,ew,{mapSampler:t._texture,filterMatrix:i,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=t,this.maskMatrix=i,e==null&&(e=20),this.scale=new wt(e,e)}apply(t,e,i,s){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;const n=this.maskSprite.worldTransform,o=Math.sqrt(n.a*n.a+n.b*n.b),a=Math.sqrt(n.c*n.c+n.d*n.d);o!==0&&a!==0&&(this.uniforms.rotation[0]=n.a/o,this.uniforms.rotation[1]=n.b/o,this.uniforms.rotation[2]=n.c/a,this.uniforms.rotation[3]=n.d/a),t.applyFilter(this,e,i,s)}get map(){return this.uniforms.mapSampler}set map(t){this.uniforms.mapSampler=t}}var sw=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,nw=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`;class ow extends ae{constructor(){super(nw,sw)}}var aw=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;class lw extends ae{constructor(t=.5,e=Math.random()){super(Ym,aw,{uNoise:0,uSeed:0}),this.noise=t,this.seed=e}get noise(){return this.uniforms.uNoise}set noise(t){this.uniforms.uNoise=t}get seed(){return this.uniforms.uSeed}set seed(t){this.uniforms.uSeed=t}}const Wd={AlphaFilter:jT,BlurFilter:JT,BlurFilterPass:xh,ColorMatrixFilter:bh,DisplacementFilter:iw,FXAAFilter:ow,NoiseFilter:lw};Object.entries(Wd).forEach(([r,t])=>{Object.defineProperty(Wd,r,{get(){return vt("7.1.0",`filters.${r} has moved to ${r}`),t}})});class hw{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){this.tickerAdded||!this.domElement||(ve.system.add(this.tickerUpdate,this,Pi.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(ve.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}const t=this.events.rootPointerEvent;this.events.supportsTouchEvents&&t.pointerType==="touch"||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY}))}tickerUpdate(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())}}const kr=new hw;class xn{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=xn.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new wt,this.page=new wt,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,i,s,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class Go extends xn{constructor(){super(...arguments),this.client=new wt,this.movement=new wt,this.offset=new wt,this.global=new wt,this.screen=new wt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,i,s,n,o,a,l,h,c,u,d,f,p,m){throw new Error("Method not implemented.")}}class Re extends Go{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class hs extends Go{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}hs.DOM_DELTA_PIXEL=0,hs.DOM_DELTA_LINE=1,hs.DOM_DELTA_PAGE=2;const cw=2048,uw=new wt,sl=new wt;class dw{constructor(t){this.dispatch=new yn,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((i,s)=>i.priority-s.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let i=0,s=e.length;i<s;i++)e[i].fn(t);else console.warn(`[EventBoundary]: Event mapping not defined for ${t.type}`)}hitTest(t,e){kr.pauseUpdate=!0;const i=this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive",s=this[i](this.rootTarget,this.rootTarget.eventMode,uw.set(t,e),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(t,e){if(!t.target)return;const i=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let s=0,n=i.length-1;s<n;s++)if(t.currentTarget=i[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!(t.propagationStopped||t.propagationImmediatelyStopped)){t.eventPhase=t.BUBBLING_PHASE;for(let s=i.length-2;s>=0;s--)if(t.currentTarget=i[s],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,i=this._allInteractiveElements){if(i.length===0)return;t.eventPhase=t.BUBBLING_PHASE;const s=Array.isArray(e)?e:[e];for(let n=i.length-1;n>=0;n--)s.forEach(o=>{t.currentTarget=i[n],this.notifyTarget(t,o)})}propagationPath(t){const e=[t];for(let i=0;i<cw&&t!==this.rootTarget;i++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,i,s,n,o=!1){let a=!1;if(this._interactivePrune(t))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(kr.pauseUpdate=!1),t.interactiveChildren&&t.children){const c=t.children;for(let u=c.length-1;u>=0;u--){const d=c[u],f=this.hitTestMoveRecursive(d,this._isInteractive(e)?e:d.eventMode,i,s,n,o||n(t,i));if(f){if(f.length>0&&!f[f.length-1].parent)continue;const p=t.isInteractive();(f.length>0||p)&&(p&&this._allInteractiveElements.push(t),f.push(t)),this._hitElements.length===0&&(this._hitElements=f),a=!0}}}const l=this._isInteractive(e),h=t.isInteractive();return l&&h&&this._allInteractiveElements.push(t),o||this._hitElements.length>0?null:a?this._hitElements:l&&!n(t,i)&&s(t,i)?h?[t]:[]:null}hitTestRecursive(t,e,i,s,n){if(this._interactivePrune(t)||n(t,i))return null;if((t.eventMode==="dynamic"||e==="dynamic")&&(kr.pauseUpdate=!1),t.interactiveChildren&&t.children){const l=t.children;for(let h=l.length-1;h>=0;h--){const c=l[h],u=this.hitTestRecursive(c,this._isInteractive(e)?e:c.eventMode,i,s,n);if(u){if(u.length>0&&!u[u.length-1].parent)continue;const d=t.isInteractive();return(u.length>0||d)&&u.push(t),u}}}const o=this._isInteractive(e),a=t.isInteractive();return o&&s(t,i)?a?[t]:[]:null}_isInteractive(t){return t==="static"||t==="dynamic"}_interactivePrune(t){return!!(!t||t.isMask||!t.visible||!t.renderable||t.eventMode==="none"||t.eventMode==="passive"&&!t.interactiveChildren||t.isMask)}hitPruneFn(t,e){var i;if(t.hitArea&&(t.worldTransform.applyInverse(e,sl),!t.hitArea.contains(sl.x,sl.y)))return!0;if(t._mask){const s=t._mask.isMaskData?t._mask.maskObject:t._mask;if(s&&!((i=s.containsPoint)!=null&&i.call(s,e)))return!0}return!1}hitTestFn(t,e){return t.eventMode==="passive"?!1:t.hitArea?!0:t.containsPoint?t.containsPoint(e):!1}notifyTarget(t,e){var n,o;e=e??t.type;const i=`on${e}`;(o=(n=t.currentTarget)[i])==null||o.call(n,t);const s=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this.notifyListeners(t,s),t.eventPhase===t.AT_TARGET&&this.notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof Re)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),e.pointerType==="touch")this.dispatchEvent(e,"touchstart");else if(e.pointerType==="mouse"||e.pointerType==="pen"){const s=e.button===2;this.dispatchEvent(e,s?"rightdown":"mousedown")}const i=this.trackingData(t.pointerId);i.pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){var l,h;if(!(t instanceof Re)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const i=e.pointerType==="mouse"||e.pointerType==="pen",s=this.trackingData(t.pointerId),n=this.findMountedTarget(s.overTargets);if(((l=s.overTargets)==null?void 0:l.length)>0&&n!==e.target){const c=t.type==="mousemove"?"mouseout":"pointerout",u=this.createPointerEvent(t,c,n);if(this.dispatchEvent(u,"pointerout"),i&&this.dispatchEvent(u,"mouseout"),!e.composedPath().includes(n)){const d=this.createPointerEvent(t,"pointerleave",n);for(d.eventPhase=d.AT_TARGET;d.target&&!e.composedPath().includes(d.target);)d.currentTarget=d.target,this.notifyTarget(d),i&&this.notifyTarget(d,"mouseleave"),d.target=d.target.parent;this.freeEvent(d)}this.freeEvent(u)}if(n!==e.target){const c=t.type==="mousemove"?"mouseover":"pointerover",u=this.clonePointerEvent(e,c);this.dispatchEvent(u,"pointerover"),i&&this.dispatchEvent(u,"mouseover");let d=n==null?void 0:n.parent;for(;d&&d!==this.rootTarget.parent&&d!==e.target;)d=d.parent;if(!d||d===this.rootTarget.parent){const f=this.clonePointerEvent(e,"pointerenter");for(f.eventPhase=f.AT_TARGET;f.target&&f.target!==n&&f.target!==this.rootTarget.parent;)f.currentTarget=f.target,this.notifyTarget(f),i&&this.notifyTarget(f,"mouseenter"),f.target=f.target.parent;this.freeEvent(f)}this.freeEvent(u)}const o=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?o.push("pointermove"):this.dispatchEvent(e,"pointermove"),a&&o.push("globalpointermove"),e.pointerType==="touch"&&(this.moveOnAll?o.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),a&&o.push("globaltouchmove")),i&&(this.moveOnAll?o.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),a&&o.push("globalmousemove"),this.cursor=(h=e.target)==null?void 0:h.cursor),o.length>0&&this.all(e,o),this._allInteractiveElements.length=0,this._hitElements.length=0,s.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){var o;if(!(t instanceof Re)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),i=this.createPointerEvent(t),s=i.pointerType==="mouse"||i.pointerType==="pen";this.dispatchEvent(i,"pointerover"),s&&this.dispatchEvent(i,"mouseover"),i.pointerType==="mouse"&&(this.cursor=(o=i.target)==null?void 0:o.cursor);const n=this.clonePointerEvent(i,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),s&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;e.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof Re)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId);if(e.overTargets){const i=t.pointerType==="mouse"||t.pointerType==="pen",s=this.findMountedTarget(e.overTargets),n=this.createPointerEvent(t,"pointerout",s);this.dispatchEvent(n),i&&this.dispatchEvent(n,"mouseout");const o=this.createPointerEvent(t,"pointerleave",s);for(o.eventPhase=o.AT_TARGET;o.target&&o.target!==this.rootTarget.parent;)o.currentTarget=o.target,this.notifyTarget(o),i&&this.notifyTarget(o,"mouseleave"),o.target=o.target.parent;e.overTargets=null,this.freeEvent(n),this.freeEvent(o)}this.cursor=null}mapPointerUp(t){if(!(t instanceof Re)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=performance.now(),i=this.createPointerEvent(t);if(this.dispatchEvent(i,"pointerup"),i.pointerType==="touch")this.dispatchEvent(i,"touchend");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const a=i.button===2;this.dispatchEvent(i,a?"rightup":"mouseup")}const s=this.trackingData(t.pointerId),n=this.findMountedTarget(s.pressTargetsByButton[t.button]);let o=n;if(n&&!i.composedPath().includes(n)){let a=n;for(;a&&!i.composedPath().includes(a);){if(i.currentTarget=a,this.notifyTarget(i,"pointerupoutside"),i.pointerType==="touch")this.notifyTarget(i,"touchendoutside");else if(i.pointerType==="mouse"||i.pointerType==="pen"){const l=i.button===2;this.notifyTarget(i,l?"rightupoutside":"mouseupoutside")}a=a.parent}delete s.pressTargetsByButton[t.button],o=a}if(o){const a=this.clonePointerEvent(i,"click");a.target=o,a.path=null,s.clicksByButton[t.button]||(s.clicksByButton[t.button]={clickCount:0,target:a.target,timeStamp:e});const l=s.clicksByButton[t.button];if(l.target===a.target&&e-l.timeStamp<200?++l.clickCount:l.clickCount=1,l.target=a.target,l.timeStamp=e,a.detail=l.clickCount,a.pointerType==="mouse"){const h=a.button===2;this.dispatchEvent(a,h?"rightclick":"click")}else a.pointerType==="touch"&&this.dispatchEvent(a,"tap");this.dispatchEvent(a,"pointertap"),this.freeEvent(a)}this.freeEvent(i)}mapPointerUpOutside(t){if(!(t instanceof Re)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}const e=this.trackingData(t.pointerId),i=this.findMountedTarget(e.pressTargetsByButton[t.button]),s=this.createPointerEvent(t);if(i){let n=i;for(;n;)s.currentTarget=n,this.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"?this.notifyTarget(s,"touchendoutside"):(s.pointerType==="mouse"||s.pointerType==="pen")&&this.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),n=n.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(s)}mapWheel(t){if(!(t instanceof hs)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let i=1;i<t.length&&t[i].parent===e;i++)e=t[i];return e}createPointerEvent(t,e,i){const s=this.allocateEvent(Re);return this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.nativeEvent=t.nativeEvent,s.originalEvent=t,s.target=i??this.hitTest(s.global.x,s.global.y)??this._hitElements[0],typeof e=="string"&&(s.type=e),s}createWheelEvent(t){const e=this.allocateEvent(hs);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const i=this.allocateEvent(Re);return i.nativeEvent=t.nativeEvent,i.originalEvent=t.originalEvent,this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.target=t.target,i.path=t.composedPath().slice(),i.type=e??i.type,i}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof Re&&e instanceof Re&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof Go&&e instanceof Go&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}notifyListeners(t,e){const i=t.currentTarget._events[e];if(i&&t.currentTarget.isInteractive())if("fn"in i)i.once&&t.currentTarget.removeListener(e,i.fn,void 0,!0),i.fn.call(i.context,t);else for(let s=0,n=i.length;s<n&&!t.propagationImmediatelyStopped;s++)i[s].once&&t.currentTarget.removeListener(e,i[s].fn,void 0,!0),i[s].fn.call(i[s].context,t)}}const fw=1,pw={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},Eh=class Th{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new dw(null),kr.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new Re(null),this.rootWheelEvent=new hs(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...Th.defaultEventFeatures},{set:(e,i,s)=>(i==="globalMove"&&(this.rootBoundary.enableGlobalMoveEvents=s),e[i]=s,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){const{view:e,resolution:i}=this.renderer;this.setTargetElement(e),this.resolution=i,Th._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(t){t=t||"default";let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this.currentCursor===t)return;this.currentCursor=t;const i=this.cursorStyles[t];if(i)switch(typeof i){case"string":e&&(this.domElement.style.cursor=i);break;case"function":i(t);break;case"object":e&&Object.assign(this.domElement.style,i);break}else e&&typeof t=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this.rootPointerEvent}onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(let i=0,s=e.length;i<s;i++){const n=e[i],o=this.bootstrapEvent(this.rootPointerEvent,n);this.rootBoundary.mapEvent(o)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,kr.pointerMoved();const e=this.normalizeToPointerData(t);for(let i=0,s=e.length;i<s;i++){const n=this.bootstrapEvent(this.rootPointerEvent,e[i]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const i=e!==this.domElement?"outside":"",s=this.normalizeToPointerData(t);for(let n=0,o=s.length;n<o;n++){const a=this.bootstrapEvent(this.rootPointerEvent,s[n]);a.type+=i,this.rootBoundary.mapEvent(a)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this.normalizeToPointerData(t);for(let i=0,s=e.length;i<s;i++){const n=this.bootstrapEvent(this.rootPointerEvent,e[i]);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this.removeEvents(),this.domElement=t,kr.domElement=t,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;kr.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;kr.removeTickerListener();const t=this.domElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(t,e,i){const s=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},n=1/this.resolution;t.x=(e-s.left)*(this.domElement.width/s.width)*n,t.y=(i-s.top)*(this.domElement.height/s.height)*n}normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let i=0,s=t.changedTouches.length;i<s;i++){const n=t.changedTouches[i];typeof n.button>"u"&&(n.button=0),typeof n.buttons>"u"&&(n.buttons=1),typeof n.isPrimary>"u"&&(n.isPrimary=t.touches.length===1&&t.type==="touchstart"),typeof n.width>"u"&&(n.width=n.radiusX||1),typeof n.height>"u"&&(n.height=n.radiusY||1),typeof n.tiltX>"u"&&(n.tiltX=0),typeof n.tiltY>"u"&&(n.tiltY=0),typeof n.pointerType>"u"&&(n.pointerType="touch"),typeof n.pointerId>"u"&&(n.pointerId=n.identifier||0),typeof n.pressure>"u"&&(n.pressure=n.force||.5),typeof n.twist>"u"&&(n.twist=0),typeof n.tangentialPressure>"u"&&(n.tangentialPressure=0),typeof n.layerX>"u"&&(n.layerX=n.offsetX=n.clientX),typeof n.layerY>"u"&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=t.type,e.push(n)}else if(!globalThis.MouseEvent||t instanceof MouseEvent&&(!this.supportsPointerEvents||!(t instanceof globalThis.PointerEvent))){const i=t;typeof i.isPrimary>"u"&&(i.isPrimary=!0),typeof i.width>"u"&&(i.width=1),typeof i.height>"u"&&(i.height=1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="mouse"),typeof i.pointerId>"u"&&(i.pointerId=fw),typeof i.pressure>"u"&&(i.pressure=.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),i.isNormalized=!0,e.push(i)}else e.push(t);return e}normalizeWheelEvent(t){const e=this.rootWheelEvent;return this.transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this.transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,t.type==="pointerleave"&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=pw[t.type]||t.type),t}transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};Eh.extension={name:"events",type:[Y.RendererSystem,Y.CanvasRendererSystem]},Eh.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let wh=Eh;rt.add(wh);function jd(r){return r==="dynamic"||r==="static"}const mw={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??jd(wh.defaultEventMode)},set interactive(r){vt("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=r,this.eventMode=r?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??wh.defaultEventMode},set eventMode(r){this._internalInteractive=jd(r),this._internalEventMode=r},isInteractive(){return this.eventMode==="static"||this.eventMode==="dynamic"},interactiveChildren:!0,hitArea:null,addEventListener(r,t,e){const i=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof t=="function"?void 0:t;r=i?`${r}capture`:r,t=typeof t=="function"?t:t.handleEvent,this.on(r,t,s)},removeEventListener(r,t,e){const i=typeof e=="boolean"&&e||typeof e=="object"&&e.capture,s=typeof t=="function"?void 0:t;r=i?`${r}capture`:r,t=typeof t=="function"?t:t.handleEvent,this.off(r,t,s)},dispatchEvent(r){if(!(r instanceof xn))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return r.defaultPrevented=!1,r.path=null,r.target=this,r.manager.dispatchEvent(r),!r.defaultPrevented}};kt.mixin(mw);const gw={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};kt.mixin(gw);const yw=9,zn=100,_w=0,vw=0,Yd=2,qd=1,xw=-1e3,bw=-1e3,Ew=2;class ig{constructor(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(mr.tablet||mr.phone)&&this.createTouchHook();const e=document.createElement("div");e.style.width=`${zn}px`,e.style.height=`${zn}px`,e.style.position="absolute",e.style.top=`${_w}px`,e.style.left=`${vw}px`,e.style.zIndex=Yd.toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){const t=document.createElement("button");t.style.width=`${qd}px`,t.style.height=`${qd}px`,t.style.position="absolute",t.style.top=`${xw}px`,t.style.left=`${bw}px`,t.style.zIndex=Ew.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),(t=this.renderer.view.parentNode)==null||t.appendChild(this.div))}deactivate(){var t;!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),(t=this.div.parentNode)==null||t.removeChild(this.div))}updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&t.isInteractive()&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);const e=t.children;if(e)for(let i=0;i<e.length;i++)this.updateAccessibleObjects(e[i])}update(){const t=performance.now();if(mr.android.device&&t<this.androidUpdateCount||(this.androidUpdateCount=t+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);const{x:e,y:i,width:s,height:n}=this.renderer.view.getBoundingClientRect(),{width:o,height:a,resolution:l}=this.renderer,h=s/o*l,c=n/a*l;let u=this.div;u.style.left=`${e}px`,u.style.top=`${i}px`,u.style.width=`${o}px`,u.style.height=`${a}px`;for(let d=0;d<this.children.length;d++){const f=this.children[d];if(f.renderId!==this.renderId)f._accessibleActive=!1,as(this.children,d,1),this.div.removeChild(f._accessibleDiv),this.pool.push(f._accessibleDiv),f._accessibleDiv=null,d--;else{u=f._accessibleDiv;let p=f.hitArea;const m=f.worldTransform;f.hitArea?(u.style.left=`${(m.tx+p.x*m.a)*h}px`,u.style.top=`${(m.ty+p.y*m.d)*c}px`,u.style.width=`${p.width*m.a*h}px`,u.style.height=`${p.height*m.d*c}px`):(p=f.getBounds(),this.capHitArea(p),u.style.left=`${p.x*h}px`,u.style.top=`${p.y*c}px`,u.style.width=`${p.width*h}px`,u.style.height=`${p.height*c}px`,u.title!==f.accessibleTitle&&f.accessibleTitle!==null&&(u.title=f.accessibleTitle),u.getAttribute("aria-label")!==f.accessibleHint&&f.accessibleHint!==null&&u.setAttribute("aria-label",f.accessibleHint)),(f.accessibleTitle!==u.title||f.tabIndex!==u.tabIndex)&&(u.title=f.accessibleTitle,u.tabIndex=f.tabIndex,this.debug&&this.updateDebugHTML(u))}}this.renderId++}updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:i}=this.renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>i&&(t.height=i-t.y)}addChild(t){let e=this.pool.pop();e||(e=document.createElement("button"),e.style.width=`${zn}px`,e.style.height=`${zn}px`,e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=Yd.toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&t.accessibleTitle!==null?e.title=t.accessibleTitle:(!t.accessibleHint||t.accessibleHint===null)&&(e.title=`displayObject ${t.tabIndex}`),t.accessibleHint&&t.accessibleHint!==null&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex}_dispatchEvent(t,e){const{displayObject:i}=t.target,s=this.renderer.events.rootBoundary,n=Object.assign(new xn(s),{target:i});s.rootTarget=this.renderer.lastObjectRendered,e.forEach(o=>s.dispatchEvent(n,o))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){t.keyCode===yw&&this.activate()}_onMouseMove(t){t.movementX===0&&t.movementY===0||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}ig.extension={name:"accessibility",type:[Y.RendererPlugin,Y.CanvasRendererPlugin]};rt.add(ig);const sg=class Ah{constructor(t){this.stage=new le,t=Object.assign({forceCanvas:!1},t),this.renderer=DT(t),Ah._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){var t;return(t=this.renderer)==null?void 0:t.view}get screen(){var t;return(t=this.renderer)==null?void 0:t.screen}destroy(t,e){const i=Ah._plugins.slice(0);i.reverse(),i.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};sg._plugins=[];let ng=sg;rt.handleByList(Y.Application,ng._plugins);class og{static init(t){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this.cancelResize();let e,i;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,i=globalThis.innerHeight;else{const{clientWidth:s,clientHeight:n}=this._resizeTo;e=s,i=n}this.renderer.resize(e,i),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}og.extension=Y.Application;rt.add(og);const Kd={loader:Y.LoadParser,resolver:Y.ResolveParser,cache:Y.CacheParser,detection:Y.DetectionParser};rt.handle(Y.Asset,r=>{const t=r.ref;Object.entries(Kd).filter(([e])=>!!t[e]).forEach(([e,i])=>rt.add(Object.assign(t[e],{extension:t[e].extension??i})))},r=>{const t=r.ref;Object.keys(Kd).filter(e=>!!t[e]).forEach(e=>rt.remove(t[e]))});class Tw{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<e;i++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}function Ss(r,t){if(Array.isArray(t)){for(const e of t)if(r.startsWith(`data:${e}`))return!0;return!1}return r.startsWith(`data:${t}`)}function ti(r,t){const e=r.split("?")[0],i=Yt.extname(e).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const De=(r,t,e=!1)=>(Array.isArray(r)||(r=[r]),t?r.map(i=>typeof i=="string"||e?t(i):i):r),Sh=(r,t)=>{const e=t.split("?")[1];return e&&(r+=`?${e}`),r};function ag(r,t,e,i,s){const n=t[e];for(let o=0;o<n.length;o++){const a=n[o];e<t.length-1?ag(r.replace(i[e],a),t,e+1,i,s):s.push(r.replace(i[e],a))}}function ww(r){const t=/\{(.*?)\}/g,e=r.match(t),i=[];if(e){const s=[];e.forEach(n=>{const o=n.substring(1,n.length-1).split(",");s.push(o)}),ag(r,s,0,e,i)}else i.push(r);return i}const Ho=r=>!Array.isArray(r);class Aw{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||console.warn(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const i=De(t);let s;for(let a=0;a<this.parsers.length;a++){const l=this.parsers[a];if(l.test(e)){s=l.getCacheableAssets(i,e);break}}s||(s={},i.forEach(a=>{s[a]=e}));const n=Object.keys(s),o={cacheKeys:n,keys:i};if(i.forEach(a=>{this._cacheMap.set(a,o)}),n.forEach(a=>{this._cache.has(a)&&this._cache.get(a)!==e&&console.warn("[Cache] already has key:",a),this._cache.set(a,s[a])}),e instanceof et){const a=e;i.forEach(l=>{a.baseTexture!==et.EMPTY.baseTexture&&ft.addToCache(a.baseTexture,l),et.addToCache(a,l)})}}remove(t){if(!this._cacheMap.has(t)){console.warn(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(i=>{this._cache.delete(i)}),e.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const _i=new Aw;class Sw{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,i)=>(this._parsersValidated=!1,t[e]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const i={promise:null,parser:null};return i.promise=(async()=>{var o,a;let s=null,n=null;if(e.loadParser&&(n=this._parserHash[e.loadParser],n||console.warn(`[Assets] specified load parser "${e.loadParser}" not found while loading ${t}`)),!n){for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];if(h.load&&((o=h.test)!=null&&o.call(h,t,e,this))){n=h;break}}if(!n)return console.warn(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}s=await n.load(t,e,this),i.parser=n;for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];h.parse&&h.parse&&await((a=h.testParse)==null?void 0:a.call(h,s,e,this))&&(s=await h.parse(s,e,this)||s,i.parser=h)}return s})(),i}async load(t,e){this._parsersValidated||this._validateParsers();let i=0;const s={},n=Ho(t),o=De(t,h=>({alias:[h],src:h})),a=o.length,l=o.map(async h=>{const c=Yt.toAbsolute(h.src);if(!s[h.src])try{this.promiseCache[c]||(this.promiseCache[c]=this._getLoadPromiseAndParser(c,h)),s[h.src]=await this.promiseCache[c].promise,e&&e(++i/a)}catch(u){throw delete this.promiseCache[c],delete s[h.src],new Error(`[Loader.load] Failed to load ${c}.
${u}`)}});return await Promise.all(l),n?s[o[0].src]:s}async unload(t){const e=De(t,i=>({alias:[i],src:i})).map(async i=>{var o,a;const s=Yt.toAbsolute(i.src),n=this.promiseCache[s];if(n){const l=await n.promise;delete this.promiseCache[s],(a=(o=n.parser)==null?void 0:o.unload)==null||a.call(o,l,i,this)}});await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name).reduce((t,e)=>(t[e.name]&&console.warn(`[Assets] loadParser name conflict "${e.name}"`),{...t,[e.name]:e}),{})}}var Ue=(r=>(r[r.Low=0]="Low",r[r.Normal=1]="Normal",r[r.High=2]="High",r))(Ue||{});const Cw=".json",Iw="application/json",Pw={extension:{type:Y.LoadParser,priority:Ue.Low},name:"loadJson",test(r){return Ss(r,Iw)||ti(r,Cw)},async load(r){return await(await tt.ADAPTER.fetch(r)).json()}};rt.add(Pw);const Rw=".txt",Mw="text/plain",Bw={name:"loadTxt",extension:{type:Y.LoadParser,priority:Ue.Low},test(r){return Ss(r,Mw)||ti(r,Rw)},async load(r){return await(await tt.ADAPTER.fetch(r)).text()}};rt.add(Bw);const Dw=["normal","bold","100","200","300","400","500","600","700","800","900"],Fw=[".ttf",".otf",".woff",".woff2"],Ow=["font/ttf","font/otf","font/woff","font/woff2"],Nw=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function Lw(r){const t=Yt.extname(r),e=Yt.basename(r,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(n=>n.charAt(0).toUpperCase()+n.slice(1));let i=e.length>0;for(const n of e)if(!n.match(Nw)){i=!1;break}let s=e.join(" ");return i||(s=`"${s.replace(/[\\"]/g,"\\$&")}"`),s}const kw=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Uw(r){return kw.test(r)?r:encodeURI(r)}const Gw={extension:{type:Y.LoadParser,priority:Ue.Low},name:"loadWebFont",test(r){return Ss(r,Ow)||ti(r,Fw)},async load(r,t){var i,s,n;const e=tt.ADAPTER.getFontFaceSet();if(e){const o=[],a=((i=t.data)==null?void 0:i.family)??Lw(r),l=((n=(s=t.data)==null?void 0:s.weights)==null?void 0:n.filter(c=>Dw.includes(c)))??["normal"],h=t.data??{};for(let c=0;c<l.length;c++){const u=l[c],d=new FontFace(a,`url(${Uw(r)})`,{...h,weight:u});await d.load(),e.add(d),o.push(d)}return o.length===1?o[0]:o}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(r){(Array.isArray(r)?r:[r]).forEach(t=>tt.ADAPTER.getFontFaceSet().delete(t))}};rt.add(Gw);let Zd=0,nl;const Hw="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=",$w={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('${Hw}');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},Vw={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`};let ol;class Xw{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const e=URL.createObjectURL(new Blob([$w.code],{type:"application/javascript"})),i=new Worker(e);i.addEventListener("message",s=>{i.terminate(),URL.revokeObjectURL(e),t(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t){return this._run("loadImageBitmap",[t])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){nl===void 0&&(nl=navigator.hardwareConcurrency||4);let t=this.workerPool.pop();return!t&&this._createdWorkers<nl&&(ol||(ol=URL.createObjectURL(new Blob([Vw.code],{type:"application/javascript"}))),this._createdWorkers++,t=new Worker(ol),t.addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),t}returnWorker(t){this.workerPool.push(t)}complete(t){t.error!==void 0?this.resolveHash[t.uuid].reject(t.error):this.resolveHash[t.uuid].resolve(t.data),this.resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const i=new Promise((s,n)=>{this.queue.push({id:t,arguments:e,resolve:s,reject:n})});return this.next(),i}next(){if(!this.queue.length)return;const t=this.getWorker();if(!t)return;const e=this.queue.pop(),i=e.id;this.resolveHash[Zd]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Zd++,id:i})}}const Qd=new Xw;function bn(r,t,e){r.resource.internal=!0;const i=new et(r),s=()=>{delete t.promiseCache[e],_i.has(e)&&_i.remove(e)};return i.baseTexture.once("destroyed",()=>{e in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),s())}),i.once("destroyed",()=>{r.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),s())}),i}const zw=[".jpeg",".jpg",".png",".webp",".avif"],Ww=["image/jpeg","image/png","image/webp","image/avif"];async function jw(r){const t=await tt.ADAPTER.fetch(r);if(!t.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${r}: ${t.status} ${t.statusText}`);const e=await t.blob();return await createImageBitmap(e)}const ga={name:"loadTextures",extension:{type:Y.LoadParser,priority:Ue.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(r){return Ss(r,Ww)||ti(r,zw)},async load(r,t,e){var a;const i=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;let s;i?this.config.preferWorkers&&await Qd.isImageBitmapSupported()?s=await Qd.loadImageBitmap(r):s=await jw(r):s=await new Promise((l,h)=>{const c=new Image;c.crossOrigin=this.config.crossOrigin,c.src=r,c.complete?l(c):(c.onload=()=>l(c),c.onerror=u=>h(u))});const n={...t.data};n.resolution??(n.resolution=Tr(r)),i&&((a=n.resourceOptions)==null?void 0:a.ownsImageBitmap)===void 0&&(n.resourceOptions={...n.resourceOptions},n.resourceOptions.ownsImageBitmap=!0);const o=new ft(s,n);return o.resource.src=r,bn(o,e,r)},unload(r){r.destroy(!0)}};rt.add(ga);const Yw=".svg",qw="image/svg+xml",Kw={extension:{type:Y.LoadParser,priority:Ue.High},name:"loadSVG",test(r){return Ss(r,qw)||ti(r,Yw)},async testParse(r){return gh.test(r)},async parse(r,t,e){var n;const i=new gh(r,(n=t==null?void 0:t.data)==null?void 0:n.resourceOptions);await i.load();const s=new ft(i,{resolution:Tr(r),...t==null?void 0:t.data});return s.resource.src=t.src,bn(s,e,t.src)},async load(r,t){return(await tt.ADAPTER.fetch(r)).text()},unload:ga.unload};rt.add(Kw);const Zw=[".mp4",".m4v",".webm",".ogv"],Qw=["video/mp4","video/webm","video/ogg"],Jw={name:"loadVideo",extension:{type:Y.LoadParser,priority:Ue.High},config:{defaultAutoPlay:!0},test(r){return Ss(r,Qw)||ti(r,Zw)},async load(r,t,e){var o;let i;const s=await(await tt.ADAPTER.fetch(r)).blob(),n=URL.createObjectURL(s);try{const a={autoPlay:this.config.defaultAutoPlay,...(o=t==null?void 0:t.data)==null?void 0:o.resourceOptions},l=new tg(n,a);await l.load();const h=new ft(l,{alphaMode:await nE(),resolution:Tr(r),...t==null?void 0:t.data});h.resource.src=r,i=bn(h,e,r),i.baseTexture.once("destroyed",()=>{URL.revokeObjectURL(n)})}catch(a){throw URL.revokeObjectURL(n),a}return i},unload(r){r.destroy(!0)}};rt.add(Jw);class tA{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(i=>`${encodeURIComponent(i)}=${encodeURIComponent(e[i])}`).join("&")}}getAlias(t){const{alias:e,name:i,src:s,srcs:n}=t;return De(e||i||s||n,o=>typeof o=="string"?o:Array.isArray(o)?o.map(a=>(a==null?void 0:a.src)??(a==null?void 0:a.srcs)??a):o!=null&&o.src||o!=null&&o.srcs?o.src??o.srcs:o,!0)}addManifest(t){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const i=[];Array.isArray(e)?e.forEach(s=>{const n=s.src??s.srcs,o=s.alias??s.name;let a;if(typeof o=="string"){const l=this._createBundleAssetId(t,o);i.push(l),a=[o,l]}else{const l=o.map(h=>this._createBundleAssetId(t,h));i.push(...l),a=[...o,...l]}this.add({...s,alias:a,src:n})}):Object.keys(e).forEach(s=>{const n=[s,this._createBundleAssetId(t,s)];if(typeof e[s]=="string")this.add({alias:n,src:e[s]});else if(Array.isArray(e[s]))this.add({alias:n,src:e[s]});else{const o=e[s],a=o.src??o.srcs;this.add({...o,alias:n,src:Array.isArray(a)?a:[a]})}i.push(...n)}),this._bundles[t]=i}add(t,e,i,s,n){const o=[];typeof t=="string"||Array.isArray(t)&&typeof t[0]=="string"?(vt("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:t,src:e,data:i,format:s,loadParser:n})):Array.isArray(t)?o.push(...t):o.push(t);let a;a=l=>{this.hasKey(l)&&console.warn(`[Resolver] already has key: ${l} overwriting`)},De(o).forEach(l=>{const{src:h,srcs:c}=l;let{data:u,format:d,loadParser:f}=l;const p=De(h||c).map(y=>typeof y=="string"?ww(y):Array.isArray(y)?y:[y]),m=this.getAlias(l);Array.isArray(m)?m.forEach(a):a(m);const g=[];p.forEach(y=>{y.forEach(x=>{let _={};if(typeof x!="object"){_.src=x;for(let b=0;b<this._parsers.length;b++){const S=this._parsers[b];if(S.test(x)){_=S.parse(x);break}}}else u=x.data??u,d=x.format??d,f=x.loadParser??f,_={..._,...x};if(!m)throw new Error(`[Resolver] alias is undefined for this asset: ${_.src}`);_=this.buildResolvedAsset(_,{aliases:m,data:u,format:d,loadParser:f}),g.push(_)})}),m.forEach(y=>{this._assetMap[y]=g})})}resolveBundle(t){const e=Ho(t);t=De(t);const i={};return t.forEach(s=>{const n=this._bundles[s];if(n){const o=this.resolve(n),a={};for(const l in o){const h=o[l];a[this._extractAssetIdFromBundle(s,l)]=h}i[s]=a}}),e?i[t[0]]:i}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const i={};for(const s in e)i[s]=e[s].src;return i}return e.src}resolve(t){const e=Ho(t);t=De(t);const i={};return t.forEach(s=>{if(!this._resolverHash[s])if(this._assetMap[s]){let n=this._assetMap[s];const o=n[0],a=this._getPreferredOrder(n);a==null||a.priority.forEach(l=>{a.params[l].forEach(h=>{const c=n.filter(u=>u[l]?u[l]===h:!1);c.length&&(n=c)})}),this._resolverHash[s]=n[0]??o}else this._resolverHash[s]=this.buildResolvedAsset({alias:[s],src:s},{});i[s]=this._resolverHash[s]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const i=t[0],s=this._preferredOrder.find(n=>n.params.format.includes(i.format));if(s)return s}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}buildResolvedAsset(t,e){const{aliases:i,data:s,loadParser:n,format:o}=e;return(this._basePath||this._rootPath)&&(t.src=Yt.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...s||{},...t.data},t.loadParser=n??t.loadParser,t.format=o??Yt.extname(t.src).slice(1),t.srcs=t.src,t.name=t.alias,t}}class eA{constructor(){this._detections=[],this._initialized=!1,this.resolver=new tA,this.loader=new Sw,this.cache=_i,this._backgroundLoader=new Tw(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){var n,o;if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Asset.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let a=t.manifest;typeof a=="string"&&(a=await this.load(a)),this.resolver.addManifest(a)}const e=((n=t.texturePreference)==null?void 0:n.resolution)??1,i=typeof e=="number"?[e]:e,s=await this._detectFormats({preferredFormats:(o=t.texturePreference)==null?void 0:o.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:s,resolution:i}}),t.preferences&&this.setPreferences(t.preferences)}add(t,e,i,s,n){this.resolver.add(t,e,i,s,n)}async load(t,e){this._initialized||await this.init();const i=Ho(t),s=De(t).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(h=>!this.resolver.hasKey(h))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),n=this.resolver.resolve(s),o=await this._mapLoadToResolve(n,e);return i?o[s[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let i=!1;typeof t=="string"&&(i=!0,t=[t]);const s=this.resolver.resolveBundle(t),n={},o=Object.keys(s);let a=0,l=0;const h=()=>{e==null||e(++a/l)},c=o.map(u=>{const d=s[u];return l+=Object.keys(d).length,this._mapLoadToResolve(d,h).then(f=>{n[u]=f})});return await Promise.all(c),i?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(i=>{this._backgroundLoader.add(Object.values(i))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return _i.get(t);const e={};for(let i=0;i<t.length;i++)e[i]=_i.get(t[i]);return e}async _mapLoadToResolve(t,e){const i=Object.values(t),s=Object.keys(t);this._backgroundLoader.active=!1;const n=await this.loader.load(i,e);this._backgroundLoader.active=!0;const o={};return i.forEach((a,l)=>{const h=n[a.src],c=[a.src];a.alias&&c.push(...a.alias),o[s[l]]=h,_i.set(c,h)}),o}async unload(t){this._initialized||await this.init();const e=De(t).map(s=>typeof s!="string"?s.src:s),i=this.resolver.resolve(e);await this._unloadFromResolved(i)}async unloadBundle(t){this._initialized||await this.init(),t=De(t);const e=this.resolver.resolveBundle(t),i=Object.keys(e).map(s=>this._unloadFromResolved(e[s]));await Promise.all(i)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(i=>{_i.remove(i.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const i of t.detections)t.skipDetections||await i.test()?e=await i.add(e):t.skipDetections||(e=await i.remove(e));return e=e.filter((i,s)=>e.indexOf(i)===s),e}get detections(){return this._detections}get preferWorkers(){return ga.config.preferWorkers}set preferWorkers(t){vt("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:t})}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(i=>i in t).forEach(i=>{e.config[i]=t[i]})})}}const Wn=new eA;rt.handleByList(Y.LoadParser,Wn.loader.parsers).handleByList(Y.ResolveParser,Wn.resolver.parsers).handleByList(Y.CacheParser,Wn.cache.parsers).handleByList(Y.DetectionParser,Wn.detections);const rA={extension:Y.CacheParser,test:r=>Array.isArray(r)&&r.every(t=>t instanceof et),getCacheableAssets:(r,t)=>{const e={};return r.forEach(i=>{t.forEach((s,n)=>{e[i+(n===0?"":n+1)]=s})}),e}};rt.add(rA);async function lg(r){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=r});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(r)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const iA={extension:{type:Y.DetectionParser,priority:1},test:async()=>lg("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async r=>[...r,"avif"],remove:async r=>r.filter(t=>t!=="avif")};rt.add(iA);const sA={extension:{type:Y.DetectionParser,priority:0},test:async()=>lg("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async r=>[...r,"webp"],remove:async r=>r.filter(t=>t!=="webp")};rt.add(sA);const Jd=["png","jpg","jpeg"],nA={extension:{type:Y.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async r=>[...r,...Jd],remove:async r=>r.filter(t=>!Jd.includes(t))};rt.add(nA);const oA="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function bc(r){return oA?!1:document.createElement("video").canPlayType(r)!==""}const aA={extension:{type:Y.DetectionParser,priority:0},test:async()=>bc("video/webm"),add:async r=>[...r,"webm"],remove:async r=>r.filter(t=>t!=="webm")};rt.add(aA);const lA={extension:{type:Y.DetectionParser,priority:0},test:async()=>bc("video/mp4"),add:async r=>[...r,"mp4","m4v"],remove:async r=>r.filter(t=>t!=="mp4"&&t!=="m4v")};rt.add(lA);const hA={extension:{type:Y.DetectionParser,priority:0},test:async()=>bc("video/ogg"),add:async r=>[...r,"ogv"],remove:async r=>r.filter(t=>t!=="ogv")};rt.add(hA);const cA={extension:Y.ResolveParser,test:ga.test,parse:r=>{var t;return{resolution:parseFloat(((t=tt.RETINA_PREFIX.exec(r))==null?void 0:t[1])??"1"),format:Yt.extname(r).slice(1),src:r}}};rt.add(cA);var ye=(r=>(r[r.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",r[r.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",r[r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",r[r.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",r[r.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",r[r.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",r[r.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",r[r.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",r[r.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",r[r.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",r[r.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",r[r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",r[r.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",r[r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",r[r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",r[r.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",r[r.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",r[r.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",r[r.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",r))(ye||{});const $o={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35986:1,34798:1,37808:1};let ur,Yi;function tf(){Yi={s3tc:ur.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:ur.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:ur.getExtension("WEBGL_compressed_texture_etc"),etc1:ur.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:ur.getExtension("WEBGL_compressed_texture_pvrtc")||ur.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:ur.getExtension("WEBGL_compressed_texture_atc"),astc:ur.getExtension("WEBGL_compressed_texture_astc")}}const uA={extension:{type:Y.DetectionParser,priority:2},test:async()=>{const r=tt.ADAPTER.createCanvas().getContext("webgl");return r?(ur=r,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async r=>{Yi||tf();const t=[];for(const e in Yi)Yi[e]&&t.push(e);return[...t,...r]},remove:async r=>(Yi||tf(),r.filter(t=>!(t in Yi)))};rt.add(uA);class dA extends da{constructor(t,e={width:1,height:1,autoLoad:!0}){let i,s;typeof t=="string"?(i=t,s=new Uint8Array):(i=null,s=t),super(s,e),this.origin=i,this.buffer=s?new ih(s):null,this._load=null,this.loaded=!1,this.origin!==null&&e.autoLoad!==!1&&this.load(),this.origin===null&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(t){}load(){return this._load?this._load:(this._load=fetch(this.origin).then(t=>t.blob()).then(t=>t.arrayBuffer()).then(t=>(this.data=new Uint32Array(t),this.buffer=new ih(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),this)),this._load)}}class Ai extends dA{constructor(t,e){super(t,e),this.format=e.format,this.levels=e.levels||1,this._width=e.width,this._height=e.height,this._extension=Ai._formatToExtension(this.format),(e.levelBuffers||this.buffer)&&(this._levelBuffers=e.levelBuffers||Ai._createLevelBuffers(t instanceof Uint8Array?t:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(t,e,i){const s=t.gl;if(!t.context.extensions[this._extension])throw new Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;s.pixelStorei(s.UNPACK_ALIGNMENT,4);for(let n=0,o=this.levels;n<o;n++){const{levelID:a,levelWidth:l,levelHeight:h,levelBuffer:c}=this._levelBuffers[n];s.compressedTexImage2D(s.TEXTURE_2D,a,this.format,l,h,0,c)}return!0}onBlobLoaded(){this._levelBuffers=Ai._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(t,e,i,s,n,o,a){const l=new Array(i);let h=t.byteOffset,c=o,u=a,d=c+s-1&~(s-1),f=u+n-1&~(n-1),p=d*f*$o[e];for(let m=0;m<i;m++)l[m]={levelID:m,levelWidth:i>1?c:d,levelHeight:i>1?u:f,levelBuffer:new Uint8Array(t.buffer,h,p)},h+=p,c=c>>1||1,u=u>>1||1,d=c+s-1&~(s-1),f=u+n-1&~(n-1),p=d*f*$o[e];return l}}const al=4,jn=124,fA=32,ef=20,pA=542327876,Yn={SIZE:1,FLAGS:2,HEIGHT:3,WIDTH:4,MIPMAP_COUNT:7,PIXEL_FORMAT:19},mA={SIZE:0,FLAGS:1,FOURCC:2,RGB_BITCOUNT:3,R_BIT_MASK:4,G_BIT_MASK:5,B_BIT_MASK:6,A_BIT_MASK:7},qn={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3,MISC_FLAGS2:4},gA=1,yA=2,_A=4,vA=64,xA=512,bA=131072,EA=827611204,TA=861165636,wA=894720068,AA=808540228,SA=4,CA={[EA]:ye.COMPRESSED_RGBA_S3TC_DXT1_EXT,[TA]:ye.COMPRESSED_RGBA_S3TC_DXT3_EXT,[wA]:ye.COMPRESSED_RGBA_S3TC_DXT5_EXT},IA={70:ye.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:ye.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:ye.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:ye.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:ye.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:ye.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:ye.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:ye.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:ye.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT};function PA(r){const t=new Uint32Array(r);if(t[0]!==pA)throw new Error("Invalid DDS file magic word");const e=new Uint32Array(r,0,jn/Uint32Array.BYTES_PER_ELEMENT),i=e[Yn.HEIGHT],s=e[Yn.WIDTH],n=e[Yn.MIPMAP_COUNT],o=new Uint32Array(r,Yn.PIXEL_FORMAT*Uint32Array.BYTES_PER_ELEMENT,fA/Uint32Array.BYTES_PER_ELEMENT),a=o[gA];if(a&_A){const l=o[mA.FOURCC];if(l!==AA){const x=CA[l],_=al+jn,b=new Uint8Array(r,_);return[new Ai(b,{format:x,width:s,height:i,levels:n})]}const h=al+jn,c=new Uint32Array(t.buffer,h,ef/Uint32Array.BYTES_PER_ELEMENT),u=c[qn.DXGI_FORMAT],d=c[qn.RESOURCE_DIMENSION],f=c[qn.MISC_FLAG],p=c[qn.ARRAY_SIZE],m=IA[u];if(m===void 0)throw new Error(`DDSParser cannot parse texture data with DXGI format ${u}`);if(f===SA)throw new Error("DDSParser does not support cubemap textures");if(d===6)throw new Error("DDSParser does not supported 3D texture data");const g=new Array,y=al+jn+ef;if(p===1)g.push(new Uint8Array(r,y));else{const x=$o[m];let _=0,b=s,S=i;for(let M=0;M<n;M++){const T=Math.max(1,b+3&-4),I=Math.max(1,S+3&-4),F=T*I*x;_+=F,b=b>>>1,S=S>>>1}let D=y;for(let M=0;M<p;M++)g.push(new Uint8Array(r,D,_)),D+=_}return g.map(x=>new Ai(x,{format:m,width:s,height:i,levels:n}))}throw a&vA?new Error("DDSParser does not support uncompressed texture data."):a&xA?new Error("DDSParser does not supported YUV uncompressed texture data."):a&bA?new Error("DDSParser does not support single-channel (lumninance) texture data!"):a&yA?new Error("DDSParser does not support single-channel (alpha) texture data!"):new Error("DDSParser failed to load a texture file due to an unknown reason!")}const rf=[171,75,84,88,32,49,49,187,13,10,26,10],RA=67305985,Ie={FILE_IDENTIFIER:0,ENDIANNESS:12,GL_TYPE:16,GL_TYPE_SIZE:20,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,GL_BASE_INTERNAL_FORMAT:32,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},Ch=64,sf={[nt.UNSIGNED_BYTE]:1,[nt.UNSIGNED_SHORT]:2,[nt.INT]:4,[nt.UNSIGNED_INT]:4,[nt.FLOAT]:4,[nt.HALF_FLOAT]:8},MA={[U.RGBA]:4,[U.RGB]:3,[U.RG]:2,[U.RED]:1,[U.LUMINANCE]:1,[U.LUMINANCE_ALPHA]:2,[U.ALPHA]:1},BA={[nt.UNSIGNED_SHORT_4_4_4_4]:2,[nt.UNSIGNED_SHORT_5_5_5_1]:2,[nt.UNSIGNED_SHORT_5_6_5]:2};function DA(r,t,e=!1){const i=new DataView(t);if(!FA(r,i))return null;const s=i.getUint32(Ie.ENDIANNESS,!0)===RA,n=i.getUint32(Ie.GL_TYPE,s),o=i.getUint32(Ie.GL_FORMAT,s),a=i.getUint32(Ie.GL_INTERNAL_FORMAT,s),l=i.getUint32(Ie.PIXEL_WIDTH,s),h=i.getUint32(Ie.PIXEL_HEIGHT,s)||1,c=i.getUint32(Ie.PIXEL_DEPTH,s)||1,u=i.getUint32(Ie.NUMBER_OF_ARRAY_ELEMENTS,s)||1,d=i.getUint32(Ie.NUMBER_OF_FACES,s),f=i.getUint32(Ie.NUMBER_OF_MIPMAP_LEVELS,s),p=i.getUint32(Ie.BYTES_OF_KEY_VALUE_DATA,s);if(h===0||c!==1)throw new Error("Only 2D textures are supported");if(d!==1)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(u!==1)throw new Error("WebGL does not support array textures");const m=4,g=4,y=l+3&-4,x=h+3&-4,_=new Array(u);let b=l*h;n===0&&(b=y*x);let S;if(n!==0?sf[n]?S=sf[n]*MA[o]:S=BA[n]:S=$o[a],S===void 0)throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");const D=e?NA(i,p,s):null;let M=b*S,T=l,I=h,F=y,q=x,C=Ch+p;for(let A=0;A<f;A++){const O=i.getUint32(C,s);let Q=C+4;for(let X=0;X<u;X++){let z=_[X];z||(z=_[X]=new Array(f)),z[A]={levelID:A,levelWidth:f>1||n!==0?T:F,levelHeight:f>1||n!==0?I:q,levelBuffer:new Uint8Array(t,Q,M)},Q+=M}C+=O+4,C=C%4!==0?C+4-C%4:C,T=T>>1||1,I=I>>1||1,F=T+m-1&~(m-1),q=I+g-1&~(g-1),M=F*q*S}return n!==0?{uncompressed:_.map(A=>{let O=A[0].levelBuffer,Q=!1;return n===nt.FLOAT?O=new Float32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4):n===nt.UNSIGNED_INT?(Q=!0,O=new Uint32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4)):n===nt.INT&&(Q=!0,O=new Int32Array(A[0].levelBuffer.buffer,A[0].levelBuffer.byteOffset,A[0].levelBuffer.byteLength/4)),{resource:new da(O,{width:A[0].levelWidth,height:A[0].levelHeight}),type:n,format:Q?OA(o):o}}),kvData:D}:{compressed:_.map(A=>new Ai(null,{format:a,width:l,height:h,levels:f,levelBuffers:A})),kvData:D}}function FA(r,t){for(let e=0;e<rf.length;e++)if(t.getUint8(e)!==rf[e])return console.error(`${r} is not a valid *.ktx file!`),!1;return!0}function OA(r){switch(r){case U.RGBA:return U.RGBA_INTEGER;case U.RGB:return U.RGB_INTEGER;case U.RG:return U.RG_INTEGER;case U.RED:return U.RED_INTEGER;default:return r}}function NA(r,t,e){const i=new Map;let s=0;for(;s<t;){const n=r.getUint32(Ch+s,e),o=Ch+s+4,a=3-(n+3)%4;if(n===0||n>t-s){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<n&&r.getUint8(o+l)!==0;l++);if(l===-1){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}const h=new TextDecoder().decode(new Uint8Array(r.buffer,o,l)),c=new DataView(r.buffer,o+l+1,n-l-1);i.set(h,c),s+=4+n+a}return i}const LA={extension:{type:Y.LoadParser,priority:Ue.High},name:"loadDDS",test(r){return ti(r,".dds")},async load(r,t,e){const i=await(await tt.ADAPTER.fetch(r)).arrayBuffer(),s=PA(i).map(n=>{const o=new ft(n,{mipmap:sr.OFF,alphaMode:de.NO_PREMULTIPLIED_ALPHA,resolution:Tr(r),...t.data});return bn(o,e,r)});return s.length===1?s[0]:s},unload(r){Array.isArray(r)?r.forEach(t=>t.destroy(!0)):r.destroy(!0)}};rt.add(LA);const kA={extension:{type:Y.LoadParser,priority:Ue.High},name:"loadKTX",test(r){return ti(r,".ktx")},async load(r,t,e){const i=await(await tt.ADAPTER.fetch(r)).arrayBuffer(),{compressed:s,uncompressed:n,kvData:o}=DA(r,i),a=s??n,l={mipmap:sr.OFF,alphaMode:de.NO_PREMULTIPLIED_ALPHA,resolution:Tr(r),...t.data},h=a.map(c=>{a===n&&Object.assign(l,{type:c.type,format:c.format});const u=c.resource??c,d=new ft(u,l);return d.ktxKeyValueData=o,bn(d,e,r)});return h.length===1?h[0]:h},unload(r){Array.isArray(r)?r.forEach(t=>t.destroy(!0)):r.destroy(!0)}};rt.add(kA);const UA={extension:Y.ResolveParser,test:r=>{const t=Yt.extname(r).slice(1);return["basis","ktx","dds"].includes(t)},parse:r=>{var e,i;const t=Yt.extname(r).slice(1);if(t==="ktx"){const s=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(s.some(n=>r.endsWith(n)))return{resolution:parseFloat(((e=tt.RETINA_PREFIX.exec(r))==null?void 0:e[1])??"1"),format:s.find(n=>r.endsWith(n)),src:r}}return{resolution:parseFloat(((i=tt.RETINA_PREFIX.exec(r))==null?void 0:i[1])??"1"),format:t,src:r}}};rt.add(UA);const Kn=new mt,GA=4,hg=class $s{constructor(t){this.renderer=t,this._rendererPremultipliedAlpha=!1}contextChange(){var e;const t=(e=this.renderer)==null?void 0:e.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(t&&t.alpha&&t.premultipliedAlpha)}async image(t,e,i,s){const n=new Image;return n.src=await this.base64(t,e,i,s),n}async base64(t,e,i,s){const n=this.canvas(t,s);if(n.toBlob!==void 0)return new Promise((o,a)=>{n.toBlob(l=>{if(!l){a(new Error("ICanvas.toBlob failed!"));return}const h=new FileReader;h.onload=()=>o(h.result),h.onerror=a,h.readAsDataURL(l)},e,i)});if(n.toDataURL!==void 0)return n.toDataURL(e,i);if(n.convertToBlob!==void 0){const o=await n.convertToBlob({type:e,quality:i});return new Promise((a,l)=>{const h=new FileReader;h.onload=()=>a(h.result),h.onerror=l,h.readAsDataURL(o)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(t,e){const{pixels:i,width:s,height:n,flipY:o,premultipliedAlpha:a}=this._rawPixels(t,e);o&&$s._flipY(i,s,n),a&&$s._unpremultiplyAlpha(i);const l=new bE(s,n,1),h=new ImageData(new Uint8ClampedArray(i.buffer),s,n);return l.context.putImageData(h,0,0),l.canvas}pixels(t,e){const{pixels:i,width:s,height:n,flipY:o,premultipliedAlpha:a}=this._rawPixels(t,e);return o&&$s._flipY(i,s,n),a&&$s._unpremultiplyAlpha(i),i}_rawPixels(t,e){const i=this.renderer;if(!i)throw new Error("The Extract has already been destroyed");let s,n=!1,o=!1,a,l=!1;t&&(t instanceof Bi?a=t:(a=i.generateTexture(t,{region:e,resolution:i.resolution,multisample:i.multisample}),l=!0,e&&(Kn.width=e.width,Kn.height=e.height,e=Kn)));const h=i.gl;if(a){if(s=a.baseTexture.resolution,e=e??a.frame,n=!1,o=a.baseTexture.alphaMode>0&&a.baseTexture.format===U.RGBA,!l){i.renderTexture.bind(a);const f=a.framebuffer.glFramebuffers[i.CONTEXT_UID];f.blitFramebuffer&&i.framebuffer.bind(f.blitFramebuffer)}}else s=i.resolution,e||(e=Kn,e.width=i.width/s,e.height=i.height/s),n=!0,o=this._rendererPremultipliedAlpha,i.renderTexture.bind();const c=Math.max(Math.round(e.width*s),1),u=Math.max(Math.round(e.height*s),1),d=new Uint8Array(GA*c*u);return h.readPixels(Math.round(e.x*s),Math.round(e.y*s),c,u,h.RGBA,h.UNSIGNED_BYTE,d),l&&(a==null||a.destroy(!0)),{pixels:d,width:c,height:u,flipY:n,premultipliedAlpha:o}}destroy(){this.renderer=null}static _flipY(t,e,i){const s=e<<2,n=i>>1,o=new Uint8Array(s);for(let a=0;a<n;a++){const l=a*s,h=(i-a-1)*s;o.set(t.subarray(l,l+s)),t.copyWithin(l,h,h+s),t.set(o,h)}}static _unpremultiplyAlpha(t){t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));const e=t.length;for(let i=0;i<e;i+=4){const s=t[i+3];if(s!==0){const n=255.001/s;t[i]=t[i]*n+.5,t[i+1]=t[i+1]*n+.5,t[i+2]=t[i+2]*n+.5}}}};hg.extension={name:"extract",type:Y.RendererSystem};let HA=hg;rt.add(HA);const Vo={build(r){const t=r.points;let e,i,s,n,o,a;if(r.type===te.CIRC){const p=r.shape;e=p.x,i=p.y,o=a=p.radius,s=n=0}else if(r.type===te.ELIP){const p=r.shape;e=p.x,i=p.y,o=p.width,a=p.height,s=n=0}else{const p=r.shape,m=p.width/2,g=p.height/2;e=p.x+m,i=p.y+g,o=a=Math.max(0,Math.min(p.radius,Math.min(m,g))),s=m-o,n=g-a}if(!(o>=0&&a>=0&&s>=0&&n>=0)){t.length=0;return}const l=Math.ceil(2.3*Math.sqrt(o+a)),h=l*8+(s?4:0)+(n?4:0);if(t.length=h,h===0)return;if(l===0){t.length=8,t[0]=t[6]=e+s,t[1]=t[3]=i+n,t[2]=t[4]=e-s,t[5]=t[7]=i-n;return}let c=0,u=l*4+(s?2:0)+2,d=u,f=h;{const p=s+o,m=n,g=e+p,y=e-p,x=i+m;if(t[c++]=g,t[c++]=x,t[--u]=x,t[--u]=y,n){const _=i-m;t[d++]=y,t[d++]=_,t[--f]=_,t[--f]=g}}for(let p=1;p<l;p++){const m=Math.PI/2*(p/l),g=s+Math.cos(m)*o,y=n+Math.sin(m)*a,x=e+g,_=e-g,b=i+y,S=i-y;t[c++]=x,t[c++]=b,t[--u]=b,t[--u]=_,t[d++]=_,t[d++]=S,t[--f]=S,t[--f]=x}{const p=s,m=n+a,g=e+p,y=e-p,x=i+m,_=i-m;t[c++]=g,t[c++]=x,t[--f]=_,t[--f]=g,s&&(t[c++]=y,t[c++]=x,t[--f]=_,t[--f]=y)}},triangulate(r,t){const e=r.points,i=t.points,s=t.indices;if(e.length===0)return;let n=i.length/2;const o=n;let a,l;if(r.type!==te.RREC){const c=r.shape;a=c.x,l=c.y}else{const c=r.shape;a=c.x+c.width/2,l=c.y+c.height/2}const h=r.matrix;i.push(r.matrix?h.a*a+h.c*l+h.tx:a,r.matrix?h.b*a+h.d*l+h.ty:l),n++,i.push(e[0],e[1]);for(let c=2;c<e.length;c+=2)i.push(e[c],e[c+1]),s.push(n++,o,n);s.push(o+1,o,n)}};function nf(r,t=!1){const e=r.length;if(e<6)return;let i=0;for(let s=0,n=r[e-2],o=r[e-1];s<e;s+=2){const a=r[s],l=r[s+1];i+=(a-n)*(l+o),n=a,o=l}if(!t&&i>0||t&&i<=0){const s=e/2;for(let n=s+s%2;n<e;n+=2){const o=e-n-2,a=e-n-1,l=n,h=n+1;[r[o],r[l]]=[r[l],r[o]],[r[a],r[h]]=[r[h],r[a]]}}}const cg={build(r){r.points=r.shape.points.slice()},triangulate(r,t){let e=r.points;const i=r.holes,s=t.points,n=t.indices;if(e.length>=6){nf(e,!1);const o=[];for(let h=0;h<i.length;h++){const c=i[h];nf(c.points,!0),o.push(e.length/2),e=e.concat(c.points)}const a=Nx(e,o,2);if(!a)return;const l=s.length/2;for(let h=0;h<a.length;h+=3)n.push(a[h]+l),n.push(a[h+1]+l),n.push(a[h+2]+l);for(let h=0;h<e.length;h++)s.push(e[h])}}},$A={build(r){const t=r.shape,e=t.x,i=t.y,s=t.width,n=t.height,o=r.points;o.length=0,s>=0&&n>=0&&o.push(e,i,e+s,i,e+s,i+n,e,i+n)},triangulate(r,t){const e=r.points,i=t.points;if(e.length===0)return;const s=i.length/2;i.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(s,s+1,s+2,s+1,s+2,s+3)}},VA={build(r){Vo.build(r)},triangulate(r,t){Vo.triangulate(r,t)}};var ce=(r=>(r.MITER="miter",r.BEVEL="bevel",r.ROUND="round",r))(ce||{}),Je=(r=>(r.BUTT="butt",r.ROUND="round",r.SQUARE="square",r))(Je||{});const vs={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(r,t=20){if(!this.adaptive||!r||isNaN(r))return t;let e=Math.ceil(r/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}};class of{static curveTo(t,e,i,s,n,o){const a=o[o.length-2],l=o[o.length-1]-e,h=a-t,c=s-e,u=i-t,d=Math.abs(l*u-h*c);if(d<1e-8||n===0)return(o[o.length-2]!==t||o[o.length-1]!==e)&&o.push(t,e),null;const f=l*l+h*h,p=c*c+u*u,m=l*c+h*u,g=n*Math.sqrt(f)/d,y=n*Math.sqrt(p)/d,x=g*m/f,_=y*m/p,b=g*u+y*h,S=g*c+y*l,D=h*(y+x),M=l*(y+x),T=u*(g+_),I=c*(g+_),F=Math.atan2(M-S,D-b),q=Math.atan2(I-S,T-b);return{cx:b+t,cy:S+e,radius:n,startAngle:F,endAngle:q,anticlockwise:h*c>u*l}}static arc(t,e,i,s,n,o,a,l,h){const c=a-o,u=vs._segmentsCount(Math.abs(c)*n,Math.ceil(Math.abs(c)/Fo)*40),d=c/(u*2),f=d*2,p=Math.cos(d),m=Math.sin(d),g=u-1,y=g%1/g;for(let x=0;x<=g;++x){const _=x+y*x,b=d+o+f*_,S=Math.cos(b),D=-Math.sin(b);h.push((p*S+m*D)*n+i,(p*-D+m*S)*n+s)}}}class XA{constructor(){this.reset()}begin(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i}end(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class Ec{static curveLength(t,e,i,s,n,o,a,l){let h=0,c=0,u=0,d=0,f=0,p=0,m=0,g=0,y=0,x=0,_=0,b=t,S=e;for(let D=1;D<=10;++D)c=D/10,u=c*c,d=u*c,f=1-c,p=f*f,m=p*f,g=m*t+3*p*c*i+3*f*u*n+d*a,y=m*e+3*p*c*s+3*f*u*o+d*l,x=b-g,_=S-y,b=g,S=y,h+=Math.sqrt(x*x+_*_);return h}static curveTo(t,e,i,s,n,o,a){const l=a[a.length-2],h=a[a.length-1];a.length-=2;const c=vs._segmentsCount(Ec.curveLength(l,h,t,e,i,s,n,o));let u=0,d=0,f=0,p=0,m=0;a.push(l,h);for(let g=1,y=0;g<=c;++g)y=g/c,u=1-y,d=u*u,f=d*u,p=y*y,m=p*y,a.push(f*l+3*d*y*t+3*u*p*i+m*n,f*h+3*d*y*e+3*u*p*s+m*o)}}function af(r,t,e,i,s,n,o,a){const l=r-e*s,h=t-i*s,c=r+e*n,u=t+i*n;let d,f;o?(d=i,f=-e):(d=-i,f=e);const p=l+d,m=h+f,g=c+d,y=u+f;return a.push(p,m,g,y),2}function oi(r,t,e,i,s,n,o,a){const l=e-r,h=i-t;let c=Math.atan2(l,h),u=Math.atan2(s-r,n-t);a&&c<u?c+=Math.PI*2:!a&&c>u&&(u+=Math.PI*2);let d=c;const f=u-c,p=Math.abs(f),m=Math.sqrt(l*l+h*h),g=(15*p*Math.sqrt(m)/Math.PI>>0)+1,y=f/g;if(d+=y,a){o.push(r,t,e,i);for(let x=1,_=d;x<g;x++,_+=y)o.push(r,t,r+Math.sin(_)*m,t+Math.cos(_)*m);o.push(r,t,s,n)}else{o.push(e,i,r,t);for(let x=1,_=d;x<g;x++,_+=y)o.push(r+Math.sin(_)*m,t+Math.cos(_)*m,r,t);o.push(s,n,r,t)}return g*2}function zA(r,t){const e=r.shape;let i=r.points||e.points.slice();const s=t.closePointEps;if(i.length===0)return;const n=r.lineStyle,o=new wt(i[0],i[1]),a=new wt(i[i.length-2],i[i.length-1]),l=e.type!==te.POLY||e.closeStroke,h=Math.abs(o.x-a.x)<s&&Math.abs(o.y-a.y)<s;if(l){i=i.slice(),h&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));const z=(o.x+a.x)*.5,K=(a.y+o.y)*.5;i.unshift(z,K),i.push(z,K)}const c=t.points,u=i.length/2;let d=i.length;const f=c.length/2,p=n.width/2,m=p*p,g=n.miterLimit*n.miterLimit;let y=i[0],x=i[1],_=i[2],b=i[3],S=0,D=0,M=-(x-b),T=y-_,I=0,F=0,q=Math.sqrt(M*M+T*T);M/=q,T/=q,M*=p,T*=p;const C=n.alignment,A=(1-C)*2,O=C*2;l||(n.cap===Je.ROUND?d+=oi(y-M*(A-O)*.5,x-T*(A-O)*.5,y-M*A,x-T*A,y+M*O,x+T*O,c,!0)+2:n.cap===Je.SQUARE&&(d+=af(y,x,M,T,A,O,!0,c))),c.push(y-M*A,x-T*A,y+M*O,x+T*O);for(let z=1;z<u-1;++z){y=i[(z-1)*2],x=i[(z-1)*2+1],_=i[z*2],b=i[z*2+1],S=i[(z+1)*2],D=i[(z+1)*2+1],M=-(x-b),T=y-_,q=Math.sqrt(M*M+T*T),M/=q,T/=q,M*=p,T*=p,I=-(b-D),F=_-S,q=Math.sqrt(I*I+F*F),I/=q,F/=q,I*=p,F*=p;const K=_-y,St=x-b,H=_-S,G=D-b,ut=K*H+St*G,Et=St*H-G*K,Tt=Et<0;if(Math.abs(Et)<.001*Math.abs(ut)){c.push(_-M*A,b-T*A,_+M*O,b+T*O),ut>=0&&(n.join===ce.ROUND?d+=oi(_,b,_-M*A,b-T*A,_-I*A,b-F*A,c,!1)+4:d+=2,c.push(_-I*O,b-F*O,_+I*A,b+F*A));continue}const Ft=(-M+y)*(-T+b)-(-M+_)*(-T+x),_t=(-I+S)*(-F+b)-(-I+_)*(-F+D),R=(K*_t-H*Ft)/Et,V=(G*Ft-St*_t)/Et,k=(R-_)*(R-_)+(V-b)*(V-b),Z=_+(R-_)*A,ot=b+(V-b)*A,v=_-(R-_)*O,E=b-(V-b)*O,w=Math.min(K*K+St*St,H*H+G*G),P=Tt?A:O,B=w+P*P*m,N=k<=B;let j=n.join;if(j===ce.MITER&&k/m>g&&(j=ce.BEVEL),N)switch(j){case ce.MITER:{c.push(Z,ot,v,E);break}case ce.BEVEL:{Tt?c.push(Z,ot,_+M*O,b+T*O,Z,ot,_+I*O,b+F*O):c.push(_-M*A,b-T*A,v,E,_-I*A,b-F*A,v,E),d+=2;break}case ce.ROUND:{Tt?(c.push(Z,ot,_+M*O,b+T*O),d+=oi(_,b,_+M*O,b+T*O,_+I*O,b+F*O,c,!0)+4,c.push(Z,ot,_+I*O,b+F*O)):(c.push(_-M*A,b-T*A,v,E),d+=oi(_,b,_-M*A,b-T*A,_-I*A,b-F*A,c,!1)+4,c.push(_-I*A,b-F*A,v,E));break}}else{switch(c.push(_-M*A,b-T*A,_+M*O,b+T*O),j){case ce.MITER:{Tt?c.push(v,E,v,E):c.push(Z,ot,Z,ot),d+=2;break}case ce.ROUND:{Tt?d+=oi(_,b,_+M*O,b+T*O,_+I*O,b+F*O,c,!0)+2:d+=oi(_,b,_-M*A,b-T*A,_-I*A,b-F*A,c,!1)+2;break}}c.push(_-I*A,b-F*A,_+I*O,b+F*O),d+=2}}y=i[(u-2)*2],x=i[(u-2)*2+1],_=i[(u-1)*2],b=i[(u-1)*2+1],M=-(x-b),T=y-_,q=Math.sqrt(M*M+T*T),M/=q,T/=q,M*=p,T*=p,c.push(_-M*A,b-T*A,_+M*O,b+T*O),l||(n.cap===Je.ROUND?d+=oi(_-M*(A-O)*.5,b-T*(A-O)*.5,_-M*A,b-T*A,_+M*O,b+T*O,c,!1)+2:n.cap===Je.SQUARE&&(d+=af(_,b,M,T,A,O,!1,c)));const Q=t.indices,X=vs.epsilon*vs.epsilon;for(let z=f;z<d+f-2;++z)y=c[z*2],x=c[z*2+1],_=c[(z+1)*2],b=c[(z+1)*2+1],S=c[(z+2)*2],D=c[(z+2)*2+1],!(Math.abs(y*(b-D)+_*(D-x)+S*(x-b))<X)&&Q.push(z,z+1,z+2)}function WA(r,t){let e=0;const i=r.shape,s=r.points||i.points,n=i.type!==te.POLY||i.closeStroke;if(s.length===0)return;const o=t.points,a=t.indices,l=s.length/2,h=o.length/2;let c=h;for(o.push(s[0],s[1]),e=1;e<l;e++)o.push(s[e*2],s[e*2+1]),a.push(c,c+1),c++;n&&a.push(c,h)}function lf(r,t){r.lineStyle.native?WA(r,t):zA(r,t)}class Tc{static curveLength(t,e,i,s,n,o){const a=t-2*i+n,l=e-2*s+o,h=2*i-2*t,c=2*s-2*e,u=4*(a*a+l*l),d=4*(a*h+l*c),f=h*h+c*c,p=2*Math.sqrt(u+d+f),m=Math.sqrt(u),g=2*u*m,y=2*Math.sqrt(f),x=d/m;return(g*p+m*d*(p-y)+(4*f*u-d*d)*Math.log((2*m+x+p)/(x+y)))/(4*g)}static curveTo(t,e,i,s,n){const o=n[n.length-2],a=n[n.length-1],l=vs._segmentsCount(Tc.curveLength(o,a,t,e,i,s));let h=0,c=0;for(let u=1;u<=l;++u){const d=u/l;h=o+(t-o)*d,c=a+(e-a)*d,n.push(h+(t+(i-t)*d-h)*d,c+(e+(s-e)*d-c)*d)}}}const ll={[te.POLY]:cg,[te.CIRC]:Vo,[te.ELIP]:Vo,[te.RECT]:$A,[te.RREC]:VA},hf=[],Zn=[];class Xo{constructor(t,e=null,i=null,s=null){this.points=[],this.holes=[],this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=s,this.type=t.type}clone(){return new Xo(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const Hi=new wt,ug=class dg extends ym{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new Uo,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Zn.push(this.drawCalls[t]);this.drawCalls.length=0;for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e.reset(),hf.push(e)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(t,e=null,i=null,s=null){const n=new Xo(t,e,i,s);return this.graphicsData.push(n),this.dirty++,this}drawHole(t,e=null){if(!this.graphicsData.length)return null;const i=new Xo(t,null,null,e),s=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=s.lineStyle,s.holes.push(i),this.dirty++,this}destroy(){super.destroy();for(let t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(t){const e=this.graphicsData;for(let i=0;i<e.length;++i){const s=e[i];if(s.fillStyle.visible&&s.shape&&(s.matrix?s.matrix.applyInverse(t,Hi):Hi.copyFrom(t),s.shape.contains(Hi.x,Hi.y))){let n=!1;if(s.holes){for(let o=0;o<s.holes.length;o++)if(s.holes[o].shape.contains(Hi.x,Hi.y)){n=!0;break}}if(!n)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;const t=this.uvs,e=this.graphicsData;let i=null,s=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],s=i.style);for(let l=this.shapeIndex;l<e.length;l++){this.shapeIndex++;const h=e[l],c=h.fillStyle,u=h.lineStyle;ll[h.type].build(h),h.matrix&&this.transformPoints(h.points,h.matrix),(c.visible||u.visible)&&this.processHoles(h.holes);for(let d=0;d<2;d++){const f=d===0?c:u;if(!f.visible)continue;const p=f.texture.baseTexture,m=this.indices.length,g=this.points.length/2;p.wrapMode=zr.REPEAT,d===0?this.processFill(h):this.processLine(h);const y=this.points.length/2-g;y!==0&&(i&&!this._compareStyles(s,f)&&(i.end(m,g),i=null),i||(i=hf.pop()||new XA,i.begin(f,m,g),this.batches.push(i),s=f),this.addUvs(this.points,t,f.texture,g,y,f.matrix))}}const n=this.indices.length,o=this.points.length/2;if(i&&i.end(n,o),this.batches.length===0){this.batchable=!0;return}const a=o>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&a===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=a?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let t=0,e=this.graphicsData.length;t<e;t++){const i=this.graphicsData[t],s=i.fillStyle,n=i.lineStyle;if(s&&!s.texture.baseTexture.valid||n&&!n.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);const t=this.batches;for(let e=0,i=t.length;e<i;e++){const s=t[e];for(let n=0;n<s.size;n++){const o=s.start+n;this.indicesUint16[o]=this.indicesUint16[o]-s.attribStart}}}isBatchable(){if(this.points.length>65535*2)return!1;const t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<dg.BATCHABLE_SIZE*2}buildDrawCalls(){let t=++ft._globalBatch;for(let u=0;u<this.drawCalls.length;u++)this.drawCalls[u].texArray.clear(),Zn.push(this.drawCalls[u]);this.drawCalls.length=0;const e=this.colors,i=this.textureIds;let s=Zn.pop();s||(s=new oh,s.texArray=new ch),s.texArray.count=0,s.start=0,s.size=0,s.type=Qe.TRIANGLES;let n=0,o=null,a=0,l=!1,h=Qe.TRIANGLES,c=0;this.drawCalls.push(s);for(let u=0;u<this.batches.length;u++){const d=this.batches[u],f=8,p=d.style,m=p.texture.baseTexture;l!==!!p.native&&(l=!!p.native,h=l?Qe.LINES:Qe.TRIANGLES,o=null,n=f,t++),o!==m&&(o=m,m._batchEnabled!==t&&(n===f&&(t++,n=0,s.size>0&&(s=Zn.pop(),s||(s=new oh,s.texArray=new ch),this.drawCalls.push(s)),s.start=c,s.size=0,s.texArray.count=0,s.type=h),m.touched=1,m._batchEnabled=t,m._batchLocation=n,m.wrapMode=zr.REPEAT,s.texArray.elements[s.texArray.count++]=m,n++)),s.size+=d.size,c+=d.size,a=m._batchLocation,this.addColors(e,p.color,p.alpha,d.attribSize,d.attribStart),this.addTextureIds(i,a,d.attribSize,d.attribStart)}ft._globalBatch=t,this.packAttributes()}packAttributes(){const t=this.points,e=this.uvs,i=this.colors,s=this.textureIds,n=new ArrayBuffer(t.length*3*4),o=new Float32Array(n),a=new Uint32Array(n);let l=0;for(let h=0;h<t.length/2;h++)o[l++]=t[h*2],o[l++]=t[h*2+1],o[l++]=e[h*2],o[l++]=e[h*2+1],a[l++]=i[h],o[l++]=s[h];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(t){t.holes.length?cg.triangulate(t,this):ll[t.type].triangulate(t,this)}processLine(t){lf(t,this);for(let e=0;e<t.holes.length;e++)lf(t.holes[e],this)}processHoles(t){for(let e=0;e<t.length;e++){const i=t[e];ll[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}}calculateBounds(){const t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)}transformPoints(t,e){for(let i=0;i<t.length/2;i++){const s=t[i*2],n=t[i*2+1];t[i*2]=e.a*s+e.c*n+e.tx,t[i*2+1]=e.b*s+e.d*n+e.ty}}addColors(t,e,i,s,n=0){const o=Bt.shared.setValue(e).toLittleEndianNumber(),a=Bt.shared.setValue(o).toPremultiplied(i);t.length=Math.max(t.length,n+s);for(let l=0;l<s;l++)t[n+l]=a}addTextureIds(t,e,i,s=0){t.length=Math.max(t.length,s+i);for(let n=0;n<i;n++)t[s+n]=e}addUvs(t,e,i,s,n,o=null){let a=0;const l=e.length,h=i.frame;for(;a<n;){let u=t[(s+a)*2],d=t[(s+a)*2+1];if(o){const f=o.a*u+o.c*d+o.tx;d=o.b*u+o.d*d+o.ty,u=f}a++,e.push(u/h.width,d/h.height)}const c=i.baseTexture;(h.width<c.width||h.height<c.height)&&this.adjustUvs(e,i,l,n)}adjustUvs(t,e,i,s){const n=e.baseTexture,o=1e-6,a=i+s*2,l=e.frame,h=l.width/n.width,c=l.height/n.height;let u=l.x/l.width,d=l.y/l.height,f=Math.floor(t[i]+o),p=Math.floor(t[i+1]+o);for(let m=i+2;m<a;m+=2)f=Math.min(f,Math.floor(t[m]+o)),p=Math.min(p,Math.floor(t[m+1]+o));u-=f,d-=p;for(let m=i;m<a;m+=2)t[m]=(t[m]+u)*h,t[m+1]=(t[m+1]+d)*c}};ug.BATCHABLE_SIZE=100;let jA=ug;class ya{constructor(){this.color=16777215,this.alpha=1,this.texture=et.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){const t=new ya;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t}reset(){this.color=16777215,this.alpha=1,this.texture=et.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class wc extends ya{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=Je.BUTT,this.join=ce.MITER,this.miterLimit=10}clone(){const t=new wc;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=Je.BUTT,this.join=ce.MITER,this.miterLimit=10}}const hl={},Ih=class mo extends le{constructor(t=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new ya,this._lineStyle=new wc,this._matrix=null,this._holeMode=!1,this.state=or.for2d(),this._geometry=t||new jA,this._geometry.refCount++,this._transformID=-1,this._tintColor=new Bt(16777215),this.blendMode=ct.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new mo(this._geometry)}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(t){this._tintColor.setValue(t)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(t=null,e=0,i,s=.5,n=!1){return typeof t=="number"&&(t={width:t,color:e,alpha:i,alignment:s,native:n}),this.lineTextureStyle(t)}lineTextureStyle(t){const e={width:0,texture:et.WHITE,color:t!=null&&t.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:Je.BUTT,join:ce.MITER,miterLimit:10};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const i=t.width>0&&t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:i},t)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){const t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new br,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new br,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this}lineTo(t,e){this.currentPath||this.moveTo(0,0);const i=this.currentPath.points,s=i[i.length-2],n=i[i.length-1];return(s!==t||n!==e)&&i.push(t,e),this}_initCurve(t=0,e=0){this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[t,e]):this.moveTo(t,e)}quadraticCurveTo(t,e,i,s){this._initCurve();const n=this.currentPath.points;return n.length===0&&this.moveTo(0,0),Tc.curveTo(t,e,i,s,n),this}bezierCurveTo(t,e,i,s,n,o){return this._initCurve(),Ec.curveTo(t,e,i,s,n,o,this.currentPath.points),this}arcTo(t,e,i,s,n){this._initCurve(t,e);const o=this.currentPath.points,a=of.curveTo(t,e,i,s,n,o);if(a){const{cx:l,cy:h,radius:c,startAngle:u,endAngle:d,anticlockwise:f}=a;this.arc(l,h,c,u,d,f)}return this}arc(t,e,i,s,n,o=!1){if(s===n)return this;if(!o&&n<=s?n+=Fo:o&&s<=n&&(s+=Fo),n-s===0)return this;const a=t+Math.cos(s)*i,l=e+Math.sin(s)*i,h=this._geometry.closePointEps;let c=this.currentPath?this.currentPath.points:null;if(c){const u=Math.abs(c[c.length-2]-a),d=Math.abs(c[c.length-1]-l);u<h&&d<h||c.push(a,l)}else this.moveTo(a,l),c=this.currentPath.points;return of.arc(a,l,t,e,i,s,n,o,c),this}beginFill(t=0,e){return this.beginTextureFill({texture:et.WHITE,color:t,alpha:e})}normalizeColor(t){const e=Bt.shared.setValue(t.color??0);t.color=e.toNumber(),t.alpha??(t.alpha=e.alpha)}beginTextureFill(t){const e={texture:et.WHITE,color:16777215,matrix:null};t=Object.assign(e,t),this.normalizeColor(t),this.currentPath&&this.startPoly();const i=t.alpha>0;return i?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:i},t)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(t,e,i,s){return this.drawShape(new mt(t,e,i,s))}drawRoundedRect(t,e,i,s,n){return this.drawShape(new pa(t,e,i,s,n))}drawCircle(t,e,i){return this.drawShape(new fa(t,e,i))}drawEllipse(t,e,i,s){return this.drawShape(new vn(t,e,i,s))}drawPolygon(...t){let e,i=!0;const s=t[0];s.points?(i=s.closeStroke,e=s.points):Array.isArray(t[0])?e=t[0]:e=t;const n=new br(e);return n.closeStroke=i,this.drawShape(n),this}drawShape(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){const t=this._geometry.graphicsData;return t.length===1&&t[0].shape.type===te.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)}_render(t){this.finishPoly();const e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))}_populateBatches(){const t=this._geometry,e=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(let s=0;s<i;s++){const n=t.batches[s],o=n.style.color,a=new Float32Array(this.vertexData.buffer,n.attribStart*4*2,n.attribSize*2),l=new Float32Array(t.uvsFloat32.buffer,n.attribStart*4*2,n.attribSize*2),h=new Uint16Array(t.indicesUint16.buffer,n.start*2,n.size),c={vertexData:a,blendMode:e,indices:h,uvs:l,_batchRGB:Bt.shared.setValue(o).toRgbArray(),_tintRGB:o,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[s]=c}}_renderBatched(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let e=0,i=this.batches.length;e<i;e++){const s=this.batches[e];s.worldAlpha=this.worldAlpha*s.alpha,t.plugins[this.pluginName].render(s)}}}_renderDirect(t){const e=this._resolveDirectShader(t),i=this._geometry,s=this.worldAlpha,n=e.uniforms,o=i.drawCalls;n.translationMatrix=this.transform.worldTransform,Bt.shared.setValue(this._tintColor).premultiply(s).toArray(n.tint),t.shader.bind(e),t.geometry.bind(i,e),t.state.set(this.state);for(let a=0,l=o.length;a<l;a++)this._renderDrawCallDirect(t,i.drawCalls[a])}_renderDrawCallDirect(t,e){const{texArray:i,type:s,size:n,start:o}=e,a=i.count;for(let l=0;l<a;l++)t.texture.bind(i.elements[l],l);t.geometry.draw(s,n,o)}_resolveDirectShader(t){let e=this.shader;const i=this.pluginName;if(!e){if(!hl[i]){const{maxTextures:s}=t.plugins[i],n=new Int32Array(s);for(let l=0;l<s;l++)n[l]=l;const o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Dt,default:Le.from({uSamplers:n},!0)},a=t.plugins[i]._shader.program;hl[i]=new rr(a,o)}e=hl[i]}return e}_calculateBounds(){this.finishPoly();const t=this._geometry;if(!t.graphicsData.length)return;const{minX:e,minY:i,maxX:s,maxY:n}=t.bounds;this._bounds.addFrame(this.transform,e,i,s,n)}containsPoint(t){return this.worldTransform.applyInverse(t,mo._TEMP_POINT),this._geometry.containsPoint(mo._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let t=0;t<this.batches.length;t++){const e=this.batches[t];e._tintRGB=Bt.shared.setValue(this._tintColor).multiply(e._batchRGB).toLittleEndianNumber()}}}calculateVertices(){const t=this.transform._worldID;if(this._transformID===t)return;this._transformID=t;const e=this.transform.worldTransform,i=e.a,s=e.b,n=e.c,o=e.d,a=e.tx,l=e.ty,h=this._geometry.points,c=this.vertexData;let u=0;for(let d=0;d<h.length;d+=2){const f=h[d],p=h[d+1];c[u++]=i*f+n*p+a,c[u++]=o*p+s*f+l}}closePath(){const t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this}setMatrix(t){return this._matrix=t,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(t){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(t)}};Ih.curves=vs,Ih._TEMP_POINT=new wt;let be=Ih;class YA{constructor(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(t){if(!t&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;const e=this.uvBuffer.data;(!this.data||this.data.length!==e.length)&&(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}}const cl=new wt,cf=new br,fg=class pg extends le{constructor(t,e,i,s=Qe.TRIANGLES){super(),this.geometry=t,this.shader=e,this.state=i||or.for2d(),this.drawMode=s,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=tt.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(t){this.shader=t}get material(){return this.shader}set blendMode(t){this.state.blendMode=t}get blendMode(){return this.state.blendMode}set roundPixels(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(t){this.shader.tint=t}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(t){this.shader.texture=t}_render(t){const e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===Qe.TRIANGLES&&e.length<pg.BATCHABLE_SIZE*2?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(t){const e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(t){const e=this.geometry,i=this.shader;i.uvMatrix&&(i.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=i._tintRGB,this._texture=i.texture;const s=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[s]),t.plugins[s].render(this)}calculateVertices(){const t=this.geometry.buffers[0],e=t.data,i=t._updateID;if(i===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));const s=this.transform.worldTransform,n=s.a,o=s.b,a=s.c,l=s.d,h=s.tx,c=s.ty,u=this.vertexData;for(let d=0;d<u.length/2;d++){const f=e[d*2],p=e[d*2+1];u[d*2]=n*f+a*p+h,u[d*2+1]=o*f+l*p+c}if(this._roundPixels){const d=tt.RESOLUTION;for(let f=0;f<u.length;++f)u[f]=Math.round(u[f]*d)/d}this.vertexDirty=i}calculateUvs(){const t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new YA(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,cl);const e=this.geometry.getBuffer("aVertexPosition").data,i=cf.points,s=this.geometry.getIndex().data,n=s.length,o=this.drawMode===4?3:1;for(let a=0;a+2<n;a+=o){const l=s[a]*2,h=s[a+1]*2,c=s[a+2]*2;if(i[0]=e[l],i[1]=e[l+1],i[2]=e[h],i[3]=e[h+1],i[4]=e[c],i[5]=e[c+1],cf.contains(cl.x,cl.y))return!0}return!1}destroy(t){super.destroy(t),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}};fg.BATCHABLE_SIZE=100;let uf=fg;class qA extends Yr{constructor(t,e,i){super();const s=new Ht(t),n=new Ht(e,!0),o=new Ht(i,!0,!0);this.addAttribute("aVertexPosition",s,2,!1,nt.FLOAT).addAttribute("aTextureCoord",n,2,!1,nt.FLOAT).addIndex(o),this._updateId=-1}get vertexDirtyId(){return this.buffers[0]._updateID}}var KA=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,ZA=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class df extends rr{constructor(t,e){const i={uSampler:t,alpha:1,uTextureMatrix:Dt.IDENTITY,uColor:new Float32Array([1,1,1,1])};e=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},e),e.uniforms&&Object.assign(i,e.uniforms),super(e.program||yr.from(ZA,KA),i),this._colorDirty=!1,this.uvMatrix=new Mm(t),this.batchable=e.program===void 0,this.pluginName=e.pluginName,this._tintColor=new Bt(e.tint),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0,this.alpha=e.alpha}get texture(){return this.uniforms.uSampler}set texture(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!=!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)}set alpha(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)}get alpha(){return this._alpha}set tint(t){t!==this.tint&&(this._tintColor.setValue(t),this._tintRGB=this._tintColor.toLittleEndianNumber(),this._colorDirty=!0)}get tint(){return this._tintColor.value}get tintValue(){return this._tintColor.toNumber()}update(){if(this._colorDirty){this._colorDirty=!1;const t=this.texture.baseTexture.alphaMode;Bt.shared.setValue(this._tintColor).premultiply(this._alpha,t).toArray(this.uniforms.uColor)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)}}class ff{constructor(t,e,i){this.geometry=new Yr,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(let s=0;s<t.length;++s){let n=t[s];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||nt.FLOAT,offset:n.offset},e[s]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){const t=this.geometry;let e=0;this.indexBuffer=new Ht(vE(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];a.offset=e,e+=a.size,this.dynamicStride+=a.size}const i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new Ht(this.dynamicData,!1,!1);let s=0;this.staticStride=0;for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];a.offset=s,s+=a.size,this.staticStride+=a.size}const n=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(n),this.staticDataUint32=new Uint32Array(n),this.staticBuffer=new Ht(this.staticData,!0,!1);for(let o=0;o<this.dynamicProperties.length;++o){const a=this.dynamicProperties[o];t.addAttribute(a.attributeName,this.dynamicBuffer,0,a.type===nt.UNSIGNED_BYTE,a.type,this.dynamicStride*4,a.offset*4)}for(let o=0;o<this.staticProperties.length;++o){const a=this.staticProperties[o];t.addAttribute(a.attributeName,this.staticBuffer,0,a.type===nt.UNSIGNED_BYTE,a.type,this.staticStride*4,a.offset*4)}}uploadDynamic(t,e,i){for(let s=0;s<this.dynamicProperties.length;s++){const n=this.dynamicProperties[s];n.uploadFunction(t,e,i,n.type===nt.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(t,e,i){for(let s=0;s<this.staticProperties.length;s++){const n=this.staticProperties[s];n.uploadFunction(t,e,i,n.type===nt.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var QA=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,JA=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class mg extends ma{constructor(t){super(t),this.shader=null,this.properties=null,this.tempMatrix=new Dt,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:nt.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=rr.from(JA,QA,{}),this.state=or.for2d()}render(t){const e=t.children,i=t._maxSize,s=t._batchSize,n=this.renderer;let o=e.length;if(o===0)return;o>i&&!t.autoResize&&(o=i);let a=t._buffers;a||(a=t._buffers=this.generateBuffers(t));const l=e[0]._texture.baseTexture,h=l.alphaMode>0;this.state.blendMode=pm(t.blendMode,h),n.state.set(this.state);const c=n.gl,u=t.worldTransform.copyTo(this.tempMatrix);u.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=Bt.shared.setValue(t.tintRgb).premultiply(t.worldAlpha,h).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=l,this.renderer.shader.bind(this.shader);let d=!1;for(let f=0,p=0;f<o;f+=s,p+=1){let m=o-f;m>s&&(m=s),p>=a.length&&a.push(this._generateOneMoreBuffer(t));const g=a[p];g.uploadDynamic(e,f,m);const y=t._bufferUpdateIDs[p]||0;d=d||g._updateID<y,d&&(g._updateID=t._updateID,g.uploadStatic(e,f,m)),n.geometry.bind(g.geometry),c.drawElements(c.TRIANGLES,m*6,c.UNSIGNED_SHORT,0)}}generateBuffers(t){const e=[],i=t._maxSize,s=t._batchSize,n=t._properties;for(let o=0;o<i;o+=s)e.push(new ff(this.properties,n,s));return e}_generateOneMoreBuffer(t){const e=t._batchSize,i=t._properties;return new ff(this.properties,i,e)}uploadVertices(t,e,i,s,n,o){let a=0,l=0,h=0,c=0;for(let u=0;u<i;++u){const d=t[e+u],f=d._texture,p=d.scale.x,m=d.scale.y,g=f.trim,y=f.orig;g?(l=g.x-d.anchor.x*y.width,a=l+g.width,c=g.y-d.anchor.y*y.height,h=c+g.height):(a=y.width*(1-d.anchor.x),l=y.width*-d.anchor.x,h=y.height*(1-d.anchor.y),c=y.height*-d.anchor.y),s[o]=l*p,s[o+1]=c*m,s[o+n]=a*p,s[o+n+1]=c*m,s[o+n*2]=a*p,s[o+n*2+1]=h*m,s[o+n*3]=l*p,s[o+n*3+1]=h*m,o+=n*4}}uploadPosition(t,e,i,s,n,o){for(let a=0;a<i;a++){const l=t[e+a].position;s[o]=l.x,s[o+1]=l.y,s[o+n]=l.x,s[o+n+1]=l.y,s[o+n*2]=l.x,s[o+n*2+1]=l.y,s[o+n*3]=l.x,s[o+n*3+1]=l.y,o+=n*4}}uploadRotation(t,e,i,s,n,o){for(let a=0;a<i;a++){const l=t[e+a].rotation;s[o]=l,s[o+n]=l,s[o+n*2]=l,s[o+n*3]=l,o+=n*4}}uploadUvs(t,e,i,s,n,o){for(let a=0;a<i;++a){const l=t[e+a]._texture._uvs;l?(s[o]=l.x0,s[o+1]=l.y0,s[o+n]=l.x1,s[o+n+1]=l.y1,s[o+n*2]=l.x2,s[o+n*2+1]=l.y2,s[o+n*3]=l.x3,s[o+n*3+1]=l.y3,o+=n*4):(s[o]=0,s[o+1]=0,s[o+n]=0,s[o+n+1]=0,s[o+n*2]=0,s[o+n*2+1]=0,s[o+n*3]=0,s[o+n*3+1]=0,o+=n*4)}}uploadTint(t,e,i,s,n,o){for(let a=0;a<i;++a){const l=t[e+a],h=Bt.shared.setValue(l._tintRGB).toPremultiplied(l.alpha,l.texture.baseTexture.alphaMode>0);s[o]=h,s[o+n]=h,s[o+n*2]=h,s[o+n*3]=h,o+=n*4}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}mg.extension={name:"particle",type:Y.RendererPlugin};rt.add(mg);var _a=(r=>(r[r.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",r[r.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",r))(_a||{});const Qn={willReadFrequently:!0},ze=class st{static get experimentalLetterSpacingSupported(){let t=st._experimentalLetterSpacingSupported;if(t!==void 0){const e=tt.ADAPTER.getCanvasRenderingContext2D().prototype;t=st._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,i,s,n,o,a,l,h){this.text=t,this.style=e,this.width=i,this.height=s,this.lines=n,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=h}static measureText(t,e,i,s=st._canvas){i=i??e.wordWrap;const n=e.toFontString(),o=st.measureFont(n);o.fontSize===0&&(o.fontSize=e.fontSize,o.ascent=e.fontSize);const a=s.getContext("2d",Qn);a.font=n;const l=(i?st.wordWrap(t,e,s):t).split(/(?:\r\n|\r|\n)/),h=new Array(l.length);let c=0;for(let p=0;p<l.length;p++){const m=st._measureText(l[p],e.letterSpacing,a);h[p]=m,c=Math.max(c,m)}let u=c+e.strokeThickness;e.dropShadow&&(u+=e.dropShadowDistance);const d=e.lineHeight||o.fontSize+e.strokeThickness;let f=Math.max(d,o.fontSize+e.strokeThickness*2)+e.leading+(l.length-1)*(d+e.leading);return e.dropShadow&&(f+=e.dropShadowDistance),new st(t,e,u,f,l,h,d+e.leading,c,o)}static _measureText(t,e,i){let s=!1;st.experimentalLetterSpacingSupported&&(st.experimentalLetterSpacing?(i.letterSpacing=`${e}px`,i.textLetterSpacing=`${e}px`,s=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let n=i.measureText(t).width;return n>0&&(s?n-=e:n+=(st.graphemeSegmenter(t).length-1)*e),n}static wordWrap(t,e,i=st._canvas){const s=i.getContext("2d",Qn);let n=0,o="",a="";const l=Object.create(null),{letterSpacing:h,whiteSpace:c}=e,u=st.collapseSpaces(c),d=st.collapseNewlines(c);let f=!u;const p=e.wordWrapWidth+h,m=st.tokenize(t);for(let g=0;g<m.length;g++){let y=m[g];if(st.isNewline(y)){if(!d){a+=st.addLine(o),f=!u,o="",n=0;continue}y=" "}if(u){const _=st.isBreakingSpace(y),b=st.isBreakingSpace(o[o.length-1]);if(_&&b)continue}const x=st.getFromCache(y,h,l,s);if(x>p)if(o!==""&&(a+=st.addLine(o),o="",n=0),st.canBreakWords(y,e.breakWords)){const _=st.wordWrapSplit(y);for(let b=0;b<_.length;b++){let S=_[b],D=S,M=1;for(;_[b+M];){const I=_[b+M];if(!st.canBreakChars(D,I,y,b,e.breakWords))S+=I;else break;D=I,M++}b+=M-1;const T=st.getFromCache(S,h,l,s);T+n>p&&(a+=st.addLine(o),f=!1,o="",n=0),o+=S,n+=T}}else{o.length>0&&(a+=st.addLine(o),o="",n=0);const _=g===m.length-1;a+=st.addLine(y,!_),f=!1,o="",n=0}else x+n>p&&(f=!1,a+=st.addLine(o),o="",n=0),(o.length>0||!st.isBreakingSpace(y)||f)&&(o+=y,n+=x)}return a+=st.addLine(o,!1),a}static addLine(t,e=!0){return t=st.trimRight(t),t=e?`${t}
`:t,t}static getFromCache(t,e,i,s){let n=i[t];return typeof n!="number"&&(n=st._measureText(t,e,s)+e,i[t]=n),n}static collapseSpaces(t){return t==="normal"||t==="pre-line"}static collapseNewlines(t){return t==="normal"}static trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const i=t[e];if(!st.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static isNewline(t){return typeof t!="string"?!1:st._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:st._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){const e=[];let i="";if(typeof t!="string")return e;for(let s=0;s<t.length;s++){const n=t[s],o=t[s+1];if(st.isBreakingSpace(n,o)||st.isNewline(n)){i!==""&&(e.push(i),i=""),e.push(n);continue}i+=n}return i!==""&&e.push(i),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,s,n){return!0}static wordWrapSplit(t){return st.graphemeSegmenter(t)}static measureFont(t){if(st._fonts[t])return st._fonts[t];const e={ascent:0,descent:0,fontSize:0},i=st._canvas,s=st._context;s.font=t;const n=st.METRICS_STRING+st.BASELINE_SYMBOL,o=Math.ceil(s.measureText(n).width);let a=Math.ceil(s.measureText(st.BASELINE_SYMBOL).width);const l=Math.ceil(st.HEIGHT_MULTIPLIER*a);if(a=a*st.BASELINE_MULTIPLIER|0,o===0||l===0)return st._fonts[t]=e,e;i.width=o,i.height=l,s.fillStyle="#f00",s.fillRect(0,0,o,l),s.font=t,s.textBaseline="alphabetic",s.fillStyle="#000",s.fillText(n,0,a);const h=s.getImageData(0,0,o,l).data,c=h.length,u=o*4;let d=0,f=0,p=!1;for(d=0;d<a;++d){for(let m=0;m<u;m+=4)if(h[f+m]!==255){p=!0;break}if(!p)f+=u;else break}for(e.ascent=a-d,f=c-u,p=!1,d=l;d>a;--d){for(let m=0;m<u;m+=4)if(h[f+m]!==255){p=!0;break}if(!p)f-=u;else break}return e.descent=d-a,e.fontSize=e.ascent+e.descent,st._fonts[t]=e,e}static clearMetrics(t=""){t?delete st._fonts[t]:st._fonts={}}static get _canvas(){var t;if(!st.__canvas){let e;try{const i=new OffscreenCanvas(0,0);if((t=i.getContext("2d",Qn))!=null&&t.measureText)return st.__canvas=i,i;e=tt.ADAPTER.createCanvas()}catch{e=tt.ADAPTER.createCanvas()}e.width=e.height=10,st.__canvas=e}return st.__canvas}static get _context(){return st.__context||(st.__context=st._canvas.getContext("2d",Qn)),st.__context}};ze.METRICS_STRING="|ÉqÅ",ze.BASELINE_SYMBOL="M",ze.BASELINE_MULTIPLIER=1.4,ze.HEIGHT_MULTIPLIER=2,ze.graphemeSegmenter=(()=>{if(typeof(Intl==null?void 0:Intl.Segmenter)=="function"){const r=new Intl.Segmenter;return t=>[...r.segment(t)].map(e=>e.segment)}return r=>[...r]})(),ze.experimentalLetterSpacing=!1,ze._fonts={},ze._newlines=[10,13],ze._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];let Lr=ze;const tS=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],gg=class Vs{constructor(t){this.styleID=0,this.reset(),dl(this,t,t)}clone(){const t={};return dl(t,this,Vs.defaultStyle),new Vs(t)}reset(){dl(this,Vs.defaultStyle,Vs.defaultStyle)}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(t){const e=ul(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)}get fill(){return this._fill}set fill(t){const e=ul(t);this._fill!==e&&(this._fill=e,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(t){eS(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.styleID++)}get stroke(){return this._stroke}set stroke(t){const e=ul(t);this._stroke!==e&&(this._stroke=e,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)}toFontString(){const t=typeof this.fontSize=="number"?`${this.fontSize}px`:this.fontSize;let e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(let i=e.length-1;i>=0;i--){let s=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(s)&&!tS.includes(s)&&(s=`"${s}"`),e[i]=s}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${t} ${e.join(",")}`}};gg.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:_a.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Kr=gg;function ul(r){const t=Bt.shared,e=i=>{const s=t.setValue(i);return s.alpha===1?s.toHex():s.toRgbaString()};return Array.isArray(r)?r.map(e):e(r)}function eS(r,t){if(!Array.isArray(r)||!Array.isArray(t)||r.length!==t.length)return!1;for(let e=0;e<r.length;++e)if(r[e]!==t[e])return!1;return!0}function dl(r,t,e){for(const i in e)Array.isArray(t[i])?r[i]=t[i].slice():r[i]=t[i]}const rS={texture:!0,children:!1,baseTexture:!0},yg=class Ph extends Di{constructor(t,e,i){let s=!1;i||(i=tt.ADAPTER.createCanvas(),s=!0),i.width=3,i.height=3;const n=et.from(i);n.orig=new mt,n.trim=new mt,super(n),this._ownCanvas=s,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=Ph.defaultResolution??tt.RESOLUTION,this._autoResolution=Ph.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=e,this.localStyleID=-1}static get experimentalLetterSpacing(){return Lr.experimentalLetterSpacing}static set experimentalLetterSpacing(t){vt("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),Lr.experimentalLetterSpacing=t}updateText(t){const e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;this._font=this._style.toFontString();const i=this.context,s=Lr.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),n=s.width,o=s.height,a=s.lines,l=s.lineHeight,h=s.lineWidths,c=s.maxLineWidth,u=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,n)+e.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+e.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=e.strokeThickness,i.textBaseline=e.textBaseline,i.lineJoin=e.lineJoin,i.miterLimit=e.miterLimit;let d,f;const p=e.dropShadow?2:1;for(let m=0;m<p;++m){const g=e.dropShadow&&m===0,y=g?Math.ceil(Math.max(1,o)+e.padding*2):0,x=y*this._resolution;if(g){i.fillStyle="black",i.strokeStyle="black";const b=e.dropShadowColor,S=e.dropShadowBlur*this._resolution,D=e.dropShadowDistance*this._resolution;i.shadowColor=Bt.shared.setValue(b).setAlpha(e.dropShadowAlpha).toRgbaString(),i.shadowBlur=S,i.shadowOffsetX=Math.cos(e.dropShadowAngle)*D,i.shadowOffsetY=Math.sin(e.dropShadowAngle)*D+x}else i.fillStyle=this._generateFillStyle(e,a,s),i.strokeStyle=e.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;let _=(l-u.fontSize)/2;l-u.fontSize<0&&(_=0);for(let b=0;b<a.length;b++)d=e.strokeThickness/2,f=e.strokeThickness/2+b*l+u.ascent+_,e.align==="right"?d+=c-h[b]:e.align==="center"&&(d+=(c-h[b])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(a[b],d+e.padding,f+e.padding-y,!0),e.fill&&this.drawLetterSpacing(a[b],d+e.padding,f+e.padding-y)}this.updateTexture()}drawLetterSpacing(t,e,i,s=!1){const n=this._style.letterSpacing;let o=!1;if(Lr.experimentalLetterSpacingSupported&&(Lr.experimentalLetterSpacing?(this.context.letterSpacing=`${n}px`,this.context.textLetterSpacing=`${n}px`,o=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),n===0||o){s?this.context.strokeText(t,e,i):this.context.fillText(t,e,i);return}let a=e;const l=Lr.graphemeSegmenter(t);let h=this.context.measureText(t).width,c=0;for(let u=0;u<l.length;++u){const d=l[u];s?this.context.strokeText(d,a,i):this.context.fillText(d,a,i);let f="";for(let p=u+1;p<l.length;++p)f+=l[p];c=this.context.measureText(f).width,a+=h-c+n,h=c}}updateTexture(){const t=this.canvas;if(this._style.trim){const o=TE(t);o.data&&(t.width=o.width,t.height=o.height,this.context.putImageData(o.data,0,0))}const e=this._texture,i=this._style,s=i.trim?0:i.padding,n=e.baseTexture;e.trim.width=e._frame.width=t.width/this._resolution,e.trim.height=e._frame.height=t.height/this._resolution,e.trim.x=-s,e.trim.y=-s,e.orig.width=e._frame.width-s*2,e.orig.height=e._frame.height-s*2,this._onTextureUpdate(),n.setRealSize(t.width,t.height,this._resolution),e.updateUvs(),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(t,e){return this.updateText(!0),this._textureID===-1&&(t=!1),super.getBounds(t,e)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds.call(this,t)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(t,e,i){const s=t.fill;if(Array.isArray(s)){if(s.length===1)return s[0]}else return s;let n;const o=t.dropShadow?t.dropShadowDistance:0,a=t.padding||0,l=this.canvas.width/this._resolution-o-a*2,h=this.canvas.height/this._resolution-o-a*2,c=s.slice(),u=t.fillGradientStops.slice();if(!u.length){const d=c.length+1;for(let f=1;f<d;++f)u.push(f/d)}if(c.unshift(s[0]),u.unshift(0),c.push(s[s.length-1]),u.push(1),t.fillGradientType===_a.LINEAR_VERTICAL){n=this.context.createLinearGradient(l/2,a,l/2,h+a);const d=i.fontProperties.fontSize+t.strokeThickness;for(let f=0;f<e.length;f++){const p=i.lineHeight*(f-1)+d,m=i.lineHeight*f;let g=m;f>0&&p>m&&(g=(m+p)/2);const y=m+d,x=i.lineHeight*(f+1);let _=y;f+1<e.length&&x<y&&(_=(y+x)/2);const b=(_-g)/h;for(let S=0;S<c.length;S++){let D=0;typeof u[S]=="number"?D=u[S]:D=S/c.length;let M=Math.min(1,Math.max(0,g/h+D*b));M=Number(M.toFixed(5)),n.addColorStop(M,c[S])}}}else{n=this.context.createLinearGradient(a,h/2,l+a,h/2);const d=c.length+1;let f=1;for(let p=0;p<c.length;p++){let m;typeof u[p]=="number"?m=u[p]:m=f/d,n.addColorStop(m,c[p]),f++}}return n}destroy(t){typeof t=="boolean"&&(t={children:t}),t=Object.assign({},rS,t),super.destroy(t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this.updateText(!0);const e=Gr(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this.updateText(!0);const e=Gr(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t}get style(){return this._style}set style(t){t=t||{},t instanceof Kr?this._style=t:this._style=new Kr(t),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}};yg.defaultAutoResolution=!0;let Ac=yg;class iS{constructor(t){this.maxItemsPerFrame=t,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function sS(r,t){var i;let e=!1;if((i=r==null?void 0:r._textures)!=null&&i.length){for(let s=0;s<r._textures.length;s++)if(r._textures[s]instanceof et){const n=r._textures[s].baseTexture;t.includes(n)||(t.push(n),e=!0)}}return e}function nS(r,t){if(r.baseTexture instanceof ft){const e=r.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function oS(r,t){if(r._texture&&r._texture instanceof et){const e=r._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function aS(r,t){return t instanceof Ac?(t.updateText(!0),!0):!1}function lS(r,t){if(t instanceof Kr){const e=t.toFontString();return Lr.measureFont(e),!0}return!1}function hS(r,t){if(r instanceof Ac){t.includes(r.style)||t.push(r.style),t.includes(r)||t.push(r);const e=r._texture.baseTexture;return t.includes(e)||t.push(e),!0}return!1}function cS(r,t){return r instanceof Kr?(t.includes(r)||t.push(r),!0):!1}const _g=class vg{constructor(t){this.limiter=new iS(vg.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(hS),this.registerFindHook(cS),this.registerFindHook(sS),this.registerFindHook(nS),this.registerFindHook(oS),this.registerUploadHook(aS),this.registerUploadHook(lS)}upload(t){return new Promise(e=>{t&&this.add(t),this.queue.length?(this.completes.push(e),this.ticking||(this.ticking=!0,ve.system.addOnce(this.tick,this,Pi.UTILITY))):e()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){const t=this.queue[0];let e=!1;if(t&&!t._destroyed){for(let i=0,s=this.uploadHooks.length;i<s;i++)if(this.uploadHooks[i](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}}e||this.queue.shift()}if(this.queue.length)ve.system.addOnce(this.tick,this,Pi.UTILITY);else{this.ticking=!1;const t=this.completes.slice(0);this.completes.length=0;for(let e=0,i=t.length;e<i;e++)t[e]()}}registerFindHook(t){return t&&this.addHooks.push(t),this}registerUploadHook(t){return t&&this.uploadHooks.push(t),this}add(t){for(let e=0,i=this.addHooks.length;e<i&&!this.addHooks[e](t,this.queue);e++);if(t instanceof le)for(let e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this}destroy(){this.ticking&&ve.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};_g.uploadsPerFrame=4;let Rh=_g;Object.defineProperties(tt,{UPLOADS_PER_FRAME:{get(){return Rh.uploadsPerFrame},set(r){vt("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),Rh.uploadsPerFrame=r}}});function xg(r,t){return t instanceof ft?(t._glTextures[r.CONTEXT_UID]||r.texture.bind(t),!0):!1}function uS(r,t){if(!(t instanceof be))return!1;const{geometry:e}=t;t.finishPoly(),e.updateBatches();const{batches:i}=e;for(let s=0;s<i.length;s++){const{texture:n}=i[s].style;n&&xg(r,n.baseTexture)}return e.batchable||r.geometry.bind(e,t._resolveDirectShader(r)),!0}function dS(r,t){return r instanceof be?(t.push(r),!0):!1}class bg extends Rh{constructor(t){super(t),this.uploadHookHelper=this.renderer,this.registerFindHook(dS),this.registerUploadHook(xg),this.registerUploadHook(uS)}}bg.extension={name:"prepare",type:Y.RendererSystem};rt.add(bg);var fS=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,pS=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,mS=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,pf=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,gS=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const Jn=new Dt;class Eg extends ma{constructor(t){super(t),t.runners.contextChange.add(this),this.quad=new Cm,this.state=or.for2d()}contextChange(){const t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=rr.from(pf,gS,e),this.shader=t.context.webGLVersion>1?rr.from(pS,fS,e):rr.from(pf,mS,e)}render(t){const e=this.renderer,i=this.quad;let s=i.vertices;s[0]=s[6]=t._width*-t.anchor.x,s[1]=s[3]=t._height*-t.anchor.y,s[2]=s[4]=t._width*(1-t.anchor.x),s[5]=s[7]=t._height*(1-t.anchor.y);const n=t.uvRespectAnchor?t.anchor.x:0,o=t.uvRespectAnchor?t.anchor.y:0;s=i.uvs,s[0]=s[6]=-n,s[1]=s[3]=-o,s[2]=s[4]=1-n,s[5]=s[7]=1-o,i.invalidate();const a=t._texture,l=a.baseTexture,h=l.alphaMode>0,c=t.tileTransform.localTransform,u=t.uvMatrix;let d=l.isPowerOfTwo&&a.frame.width===l.width&&a.frame.height===l.height;d&&(l._glTextures[e.CONTEXT_UID]?d=l.wrapMode!==zr.CLAMP:l.wrapMode===zr.CLAMP&&(l.wrapMode=zr.REPEAT));const f=d?this.simpleShader:this.shader,p=a.width,m=a.height,g=t._width,y=t._height;Jn.set(c.a*p/g,c.b*p/y,c.c*m/g,c.d*m/y,c.tx/g,c.ty/y),Jn.invert(),d?Jn.prepend(u.mapCoord):(f.uniforms.uMapCoord=u.mapCoord.toArray(!0),f.uniforms.uClampFrame=u.uClampFrame,f.uniforms.uClampOffset=u.uClampOffset),f.uniforms.uTransform=Jn.toArray(!0),f.uniforms.uColor=Bt.shared.setValue(t.tint).premultiply(t.worldAlpha,h).toArray(f.uniforms.uColor),f.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),f.uniforms.uSampler=a,e.shader.bind(f),e.geometry.bind(i),this.state.blendMode=pm(t.blendMode,h),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}Eg.extension={name:"tilingSprite",type:Y.RendererPlugin};rt.add(Eg);const Tg=class Xs{constructor(t,e,i=null){this.linkedSheets=[],this._texture=t instanceof et?t:null,this.baseTexture=t instanceof ft?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;const s=this.baseTexture.resource;this.resolution=this._updateResolution(i||(s?s.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(t=null){const{scale:e}=this.data.meta;let i=Tr(t,null);return i===null&&(i=parseFloat(e??"1")),i!==1&&this.baseTexture.setResolution(i),i}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=Xs.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const i=Xs.BATCH_SIZE;for(;e-t<i&&e<this._frameKeys.length;){const s=this._frameKeys[e],n=this._frames[s],o=n.frame;if(o){let a=null,l=null;const h=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,c=new mt(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);n.rotated?a=new mt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new mt(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(l=new mt(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[s]=new et(this.baseTexture,a,c,l,n.rotated?2:0,n.anchor,n.borders),et.addToCache(this.textures[s],s.toString())}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){const s=t[e][i];this.animations[e].push(this.textures[s])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*Xs.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*Xs.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){var e;for(const i in this.textures)this.textures[i].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)==null||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};Tg.BATCH_SIZE=1e3;let mf=Tg;const yS=["jpg","png","jpeg","avif","webp"];function wg(r,t,e){const i={};if(r.forEach(s=>{i[s]=t}),Object.keys(t.textures).forEach(s=>{i[s]=t.textures[s]}),!e){const s=Yt.dirname(r[0]);t.linkedSheets.forEach((n,o)=>{const a=wg([`${s}/${t.data.meta.related_multi_packs[o]}`],n,!0);Object.assign(i,a)})}return i}const _S={extension:Y.Asset,cache:{test:r=>r instanceof mf,getCacheableAssets:(r,t)=>wg(r,t,!1)},resolver:{test:r=>{const t=r.split("?")[0].split("."),e=t.pop(),i=t.pop();return e==="json"&&yS.includes(i)},parse:r=>{var e;const t=r.split(".");return{resolution:parseFloat(((e=tt.RETINA_PREFIX.exec(r))==null?void 0:e[1])??"1"),format:t[t.length-2],src:r}}},loader:{name:"spritesheetLoader",extension:{type:Y.LoadParser,priority:Ue.Normal},async testParse(r,t){return Yt.extname(t.src).toLowerCase()===".json"&&!!r.frames},async parse(r,t,e){var l,h;let i=Yt.dirname(t.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let s=i+r.meta.image;s=Sh(s,t.src);const n=(await e.load([s]))[s],o=new mf(n.baseTexture,r,t.src);await o.parse();const a=(l=r==null?void 0:r.meta)==null?void 0:l.related_multi_packs;if(Array.isArray(a)){const c=[];for(const d of a){if(typeof d!="string")continue;let f=i+d;(h=t.data)!=null&&h.ignoreMultiPack||(f=Sh(f,t.src),c.push(e.load({src:f,data:{ignoreMultiPack:!0}})))}const u=await Promise.all(c);o.linkedSheets=u,u.forEach(d=>{d.linkedSheets=[o].concat(o.linkedSheets.filter(f=>f!==d))})}return o},unload(r){r.destroy(!0)}}};rt.add(_S);class zo{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class go{static test(t){return typeof t=="string"&&t.startsWith("info face=")}static parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const n in e){const o=e[n].match(/^[a-z]+/gm)[0],a=e[n].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),l={};for(const h in a){const c=a[h].split("="),u=c[0],d=c[1].replace(/"/gm,""),f=parseFloat(d),p=isNaN(f)?d:f;l[u]=p}i[o].push(l)}const s=new zo;return i.info.forEach(n=>s.info.push({face:n.face,size:parseInt(n.size,10)})),i.common.forEach(n=>s.common.push({lineHeight:parseInt(n.lineHeight,10)})),i.page.forEach(n=>s.page.push({id:parseInt(n.id,10),file:n.file})),i.char.forEach(n=>s.char.push({id:parseInt(n.id,10),page:parseInt(n.page,10),x:parseInt(n.x,10),y:parseInt(n.y,10),width:parseInt(n.width,10),height:parseInt(n.height,10),xoffset:parseInt(n.xoffset,10),yoffset:parseInt(n.yoffset,10),xadvance:parseInt(n.xadvance,10)})),i.kerning.forEach(n=>s.kerning.push({first:parseInt(n.first,10),second:parseInt(n.second,10),amount:parseInt(n.amount,10)})),i.distanceField.forEach(n=>s.distanceField.push({distanceRange:parseInt(n.distanceRange,10),fieldType:n.fieldType})),s}}class Mh{static test(t){const e=t;return typeof t!="string"&&"getElementsByTagName"in t&&e.getElementsByTagName("page").length&&e.getElementsByTagName("info")[0].getAttribute("face")!==null}static parse(t){const e=new zo,i=t.getElementsByTagName("info"),s=t.getElementsByTagName("common"),n=t.getElementsByTagName("page"),o=t.getElementsByTagName("char"),a=t.getElementsByTagName("kerning"),l=t.getElementsByTagName("distanceField");for(let h=0;h<i.length;h++)e.info.push({face:i[h].getAttribute("face"),size:parseInt(i[h].getAttribute("size"),10)});for(let h=0;h<s.length;h++)e.common.push({lineHeight:parseInt(s[h].getAttribute("lineHeight"),10)});for(let h=0;h<n.length;h++)e.page.push({id:parseInt(n[h].getAttribute("id"),10)||0,file:n[h].getAttribute("file")});for(let h=0;h<o.length;h++){const c=o[h];e.char.push({id:parseInt(c.getAttribute("id"),10),page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xoffset:parseInt(c.getAttribute("xoffset"),10),yoffset:parseInt(c.getAttribute("yoffset"),10),xadvance:parseInt(c.getAttribute("xadvance"),10)})}for(let h=0;h<a.length;h++)e.kerning.push({first:parseInt(a[h].getAttribute("first"),10),second:parseInt(a[h].getAttribute("second"),10),amount:parseInt(a[h].getAttribute("amount"),10)});for(let h=0;h<l.length;h++)e.distanceField.push({fieldType:l[h].getAttribute("fieldType"),distanceRange:parseInt(l[h].getAttribute("distanceRange"),10)});return e}}class Bh{static test(t){return typeof t=="string"&&t.includes("<font>")?Mh.test(tt.ADAPTER.parseXML(t)):!1}static parse(t){return Mh.parse(tt.ADAPTER.parseXML(t))}}const fl=[go,Mh,Bh];function vS(r){for(let t=0;t<fl.length;t++)if(fl[t].test(r))return fl[t];return null}function xS(r,t,e,i,s,n){const o=e.fill;if(Array.isArray(o)){if(o.length===1)return o[0]}else return o;let a;const l=e.dropShadow?e.dropShadowDistance:0,h=e.padding||0,c=r.width/i-l-h*2,u=r.height/i-l-h*2,d=o.slice(),f=e.fillGradientStops.slice();if(!f.length){const p=d.length+1;for(let m=1;m<p;++m)f.push(m/p)}if(d.unshift(o[0]),f.unshift(0),d.push(o[o.length-1]),f.push(1),e.fillGradientType===_a.LINEAR_VERTICAL){a=t.createLinearGradient(c/2,h,c/2,u+h);let p=0;const m=(n.fontProperties.fontSize+e.strokeThickness)/u;for(let g=0;g<s.length;g++){const y=n.lineHeight*g;for(let x=0;x<d.length;x++){let _=0;typeof f[x]=="number"?_=f[x]:_=x/d.length;const b=y/u+_*m;let S=Math.max(p,b);S=Math.min(S,1),a.addColorStop(S,d[x]),p=S}}}else{a=t.createLinearGradient(h,u/2,c+h,u/2);const p=d.length+1;let m=1;for(let g=0;g<d.length;g++){let y;typeof f[g]=="number"?y=f[g]:y=m/p,a.addColorStop(y,d[g]),m++}}return a}function bS(r,t,e,i,s,n,o){const a=e.text,l=e.fontProperties;t.translate(i,s),t.scale(n,n);const h=o.strokeThickness/2,c=-(o.strokeThickness/2);if(t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=xS(r,t,o,n,[a],e),t.strokeStyle=o.stroke,o.dropShadow){const u=o.dropShadowColor,d=o.dropShadowBlur*n,f=o.dropShadowDistance*n;t.shadowColor=Bt.shared.setValue(u).setAlpha(o.dropShadowAlpha).toRgbaString(),t.shadowBlur=d,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*f,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*f}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;o.stroke&&o.strokeThickness&&t.strokeText(a,h,c+e.lineHeight-l.descent),o.fill&&t.fillText(a,h,c+e.lineHeight-l.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function yo(r){return r.codePointAt?r.codePointAt(0):r.charCodeAt(0)}function Ag(r){return Array.from?Array.from(r):r.split("")}function ES(r){typeof r=="string"&&(r=[r]);const t=[];for(let e=0,i=r.length;e<i;e++){const s=r[e];if(Array.isArray(s)){if(s.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${s.length}.`);const n=s[0].charCodeAt(0),o=s[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(let a=n,l=o;a<=l;a++)t.push(String.fromCharCode(a))}else t.push(...Ag(s))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}const Mr=class We{constructor(t,e,i){var c;const[s]=t.info,[n]=t.common,[o]=t.page,[a]=t.distanceField,l=Tr(o.file),h={};this._ownsTextures=i,this.font=s.face,this.size=s.size,this.lineHeight=n.lineHeight/l,this.chars={},this.pageTextures=h;for(let u=0;u<t.page.length;u++){const{id:d,file:f}=t.page[u];h[d]=e instanceof Array?e[u]:e[f],a!=null&&a.fieldType&&a.fieldType!=="none"&&(h[d].baseTexture.alphaMode=de.NO_PREMULTIPLIED_ALPHA,h[d].baseTexture.mipmap=sr.OFF)}for(let u=0;u<t.char.length;u++){const{id:d,page:f}=t.char[u];let{x:p,y:m,width:g,height:y,xoffset:x,yoffset:_,xadvance:b}=t.char[u];p/=l,m/=l,g/=l,y/=l,x/=l,_/=l,b/=l;const S=new mt(p+h[f].frame.x/l,m+h[f].frame.y/l,g,y);this.chars[d]={xOffset:x,yOffset:_,xAdvance:b,kerning:{},texture:new et(h[f].baseTexture,S),page:f}}for(let u=0;u<t.kerning.length;u++){let{first:d,second:f,amount:p}=t.kerning[u];d/=l,f/=l,p/=l,this.chars[f]&&(this.chars[f].kerning[d]=p)}this.distanceFieldRange=a==null?void 0:a.distanceRange,this.distanceFieldType=((c=a==null?void 0:a.fieldType)==null?void 0:c.toLowerCase())??"none"}destroy(){for(const t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(const t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null}static install(t,e,i){let s;if(t instanceof zo)s=t;else{const o=vS(t);if(!o)throw new Error("Unrecognized data format for font.");s=o.parse(t)}e instanceof et&&(e=[e]);const n=new We(s,e,i);return We.available[n.font]=n,n}static uninstall(t){const e=We.available[t];if(!e)throw new Error(`No font found named '${t}'`);e.destroy(),delete We.available[t]}static from(t,e,i){if(!t)throw new Error("[BitmapFont] Property `name` is required.");const{chars:s,padding:n,resolution:o,textureWidth:a,textureHeight:l,...h}=Object.assign({},We.defaultOptions,i),c=ES(s),u=e instanceof Kr?e:new Kr(e),d=a,f=new zo;f.info[0]={face:u.fontFamily,size:u.fontSize},f.common[0]={lineHeight:u.fontSize};let p=0,m=0,g,y,x,_=0;const b=[];for(let D=0;D<c.length;D++){g||(g=tt.ADAPTER.createCanvas(),g.width=a,g.height=l,y=g.getContext("2d"),x=new ft(g,{resolution:o,...h}),b.push(new et(x)),f.page.push({id:b.length-1,file:""}));const M=c[D],T=Lr.measureText(M,u,!1,g),I=T.width,F=Math.ceil(T.height),q=Math.ceil((u.fontStyle==="italic"?2:1)*I);if(m>=l-F*o){if(m===0)throw new Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${u.fontFamily}', fontSize: ${u.fontSize}px, char: '${M}')`);--D,g=null,y=null,x=null,m=0,p=0,_=0;continue}if(_=Math.max(F+T.fontProperties.descent,_),q*o+p>=d){if(p===0)throw new Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${u.fontFamily}', fontSize: ${u.fontSize}px, char: '${M}')`);--D,m+=_*o,m=Math.ceil(m),p=0,_=0;continue}bS(g,y,T,p,m,o,u);const C=yo(T.text);f.char.push({id:C,page:b.length-1,x:p/o,y:m/o,width:q,height:F,xoffset:0,yoffset:0,xadvance:I-(u.dropShadow?u.dropShadowDistance:0)-(u.stroke?u.strokeThickness:0)}),p+=(q+2*n)*o,p=Math.ceil(p)}if(!(i!=null&&i.skipKerning))for(let D=0,M=c.length;D<M;D++){const T=c[D];for(let I=0;I<M;I++){const F=c[I],q=y.measureText(T).width,C=y.measureText(F).width,A=y.measureText(T+F).width-(q+C);A&&f.kerning.push({first:yo(T),second:yo(F),amount:A})}}const S=new We(f,b,!0);return We.available[t]!==void 0&&We.uninstall(t),We.available[t]=S,S}};Mr.ALPHA=[["a","z"],["A","Z"]," "],Mr.NUMERIC=[["0","9"]],Mr.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],Mr.ASCII=[[" ","~"]],Mr.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:Mr.ALPHANUMERIC},Mr.available={};let Br=Mr;var TS=`// Pixi texture info\r
varying vec2 vTextureCoord;\r
uniform sampler2D uSampler;\r
\r
// Tint\r
uniform vec4 uColor;\r
\r
// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r
uniform float uFWidth;\r
\r
void main(void) {\r
\r
  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r
  vec4 texColor = texture2D(uSampler, vTextureCoord);\r
\r
  // MSDF\r
  float median = texColor.r + texColor.g + texColor.b -\r
                  min(texColor.r, min(texColor.g, texColor.b)) -\r
                  max(texColor.r, max(texColor.g, texColor.b));\r
  // SDF\r
  median = min(median, texColor.a);\r
\r
  float screenPxDistance = uFWidth * (median - 0.5);\r
  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r
  if (median < 0.01) {\r
    alpha = 0.0;\r
  } else if (median > 0.99) {\r
    alpha = 1.0;\r
  }\r
\r
  // Gamma correction for coverage-like alpha\r
  float luma = dot(uColor.rgb, vec3(0.299, 0.587, 0.114));\r
  float gamma = mix(1.0, 1.0 / 2.2, luma);\r
  float coverage = pow(uColor.a * alpha, gamma);  \r
\r
  // NPM Textures, NPM outputs\r
  gl_FragColor = vec4(uColor.rgb, coverage);\r
}\r
`,wS=`// Mesh material default fragment\r
attribute vec2 aVertexPosition;\r
attribute vec2 aTextureCoord;\r
\r
uniform mat3 projectionMatrix;\r
uniform mat3 translationMatrix;\r
uniform mat3 uTextureMatrix;\r
\r
varying vec2 vTextureCoord;\r
\r
void main(void)\r
{\r
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r
\r
    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r
}\r
`;const gf=[],yf=[],_f=[],AS=class Sg extends le{constructor(t,e={}){super();const{align:i,tint:s,maxWidth:n,letterSpacing:o,fontName:a,fontSize:l}=Object.assign({},Sg.styleDefaults,e);if(!Br.available[a])throw new Error(`Missing BitmapFont "${a}"`);this._activePagesMeshData=[],this._textWidth=0,this._textHeight=0,this._align=i,this._tintColor=new Bt(s),this._font=void 0,this._fontName=a,this._fontSize=l,this.text=t,this._maxWidth=n,this._maxLineHeight=0,this._letterSpacing=o,this._anchor=new gr(()=>{this.dirty=!0},this,0,0),this._roundPixels=tt.ROUND_PIXELS,this.dirty=!0,this._resolution=tt.RESOLUTION,this._autoResolution=!0,this._textureCache={}}updateText(){var q;const t=Br.available[this._fontName],e=this.fontSize,i=e/t.size,s=new wt,n=[],o=[],a=[],l=this._text.replace(/(?:\r\n|\r)/g,`
`)||" ",h=Ag(l),c=this._maxWidth*t.size/e,u=t.distanceFieldType==="none"?gf:yf;let d=null,f=0,p=0,m=0,g=-1,y=0,x=0,_=0,b=0;for(let C=0;C<h.length;C++){const A=h[C],O=yo(A);if(/(?:\s)/.test(A)&&(g=C,y=f,b++),A==="\r"||A===`
`){o.push(f),a.push(-1),p=Math.max(p,f),++m,++x,s.x=0,s.y+=t.lineHeight,d=null,b=0;continue}const Q=t.chars[O];if(!Q)continue;d&&Q.kerning[d]&&(s.x+=Q.kerning[d]);const X=_f.pop()||{texture:et.EMPTY,line:0,charCode:0,prevSpaces:0,position:new wt};X.texture=Q.texture,X.line=m,X.charCode=O,X.position.x=Math.round(s.x+Q.xOffset+this._letterSpacing/2),X.position.y=Math.round(s.y+Q.yOffset),X.prevSpaces=b,n.push(X),f=X.position.x+Math.max(Q.xAdvance-Q.xOffset,Q.texture.orig.width),s.x+=Q.xAdvance+this._letterSpacing,_=Math.max(_,Q.yOffset+Q.texture.height),d=O,g!==-1&&c>0&&s.x>c&&(++x,as(n,1+g-x,1+C-g),C=g,g=-1,o.push(y),a.push(n.length>0?n[n.length-1].prevSpaces:0),p=Math.max(p,y),m++,s.x=0,s.y+=t.lineHeight,d=null,b=0)}const S=h[h.length-1];S!=="\r"&&S!==`
`&&(/(?:\s)/.test(S)&&(f=y),o.push(f),p=Math.max(p,f),a.push(-1));const D=[];for(let C=0;C<=m;C++){let A=0;this._align==="right"?A=p-o[C]:this._align==="center"?A=(p-o[C])/2:this._align==="justify"&&(A=a[C]<0?0:(p-o[C])/a[C]),D.push(A)}const M=n.length,T={},I=[],F=this._activePagesMeshData;u.push(...F);for(let C=0;C<M;C++){const A=n[C].texture,O=A.baseTexture.uid;if(!T[O]){let Q=u.pop();if(!Q){const z=new qA;let K,St;t.distanceFieldType==="none"?(K=new df(et.EMPTY),St=ct.NORMAL):(K=new df(et.EMPTY,{program:yr.from(wS,TS),uniforms:{uFWidth:0}}),St=ct.NORMAL_NPM);const H=new uf(z,K);H.blendMode=St,Q={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:H,vertices:null,uvs:null,indices:null}}Q.index=0,Q.indexCount=0,Q.vertexCount=0,Q.uvsCount=0,Q.total=0;const{_textureCache:X}=this;X[O]=X[O]||new et(A.baseTexture),Q.mesh.texture=X[O],Q.mesh.tint=this._tintColor.value,I.push(Q),T[O]=Q}T[O].total++}for(let C=0;C<F.length;C++)I.includes(F[C])||this.removeChild(F[C].mesh);for(let C=0;C<I.length;C++)I[C].mesh.parent!==this&&this.addChild(I[C].mesh);this._activePagesMeshData=I;for(const C in T){const A=T[C],O=A.total;if(!(((q=A.indices)==null?void 0:q.length)>6*O)||A.vertices.length<uf.BATCHABLE_SIZE*2)A.vertices=new Float32Array(4*2*O),A.uvs=new Float32Array(4*2*O),A.indices=new Uint16Array(6*O);else{const Q=A.total,X=A.vertices;for(let z=Q*4*2;z<X.length;z++)X[z]=0}A.mesh.size=6*O}for(let C=0;C<M;C++){const A=n[C];let O=A.position.x+D[A.line]*(this._align==="justify"?A.prevSpaces:1);this._roundPixels&&(O=Math.round(O));const Q=O*i,X=A.position.y*i,z=A.texture,K=T[z.baseTexture.uid],St=z.frame,H=z._uvs,G=K.index++;K.indices[G*6+0]=0+G*4,K.indices[G*6+1]=1+G*4,K.indices[G*6+2]=2+G*4,K.indices[G*6+3]=0+G*4,K.indices[G*6+4]=2+G*4,K.indices[G*6+5]=3+G*4,K.vertices[G*8+0]=Q,K.vertices[G*8+1]=X,K.vertices[G*8+2]=Q+St.width*i,K.vertices[G*8+3]=X,K.vertices[G*8+4]=Q+St.width*i,K.vertices[G*8+5]=X+St.height*i,K.vertices[G*8+6]=Q,K.vertices[G*8+7]=X+St.height*i,K.uvs[G*8+0]=H.x0,K.uvs[G*8+1]=H.y0,K.uvs[G*8+2]=H.x1,K.uvs[G*8+3]=H.y1,K.uvs[G*8+4]=H.x2,K.uvs[G*8+5]=H.y2,K.uvs[G*8+6]=H.x3,K.uvs[G*8+7]=H.y3}this._textWidth=p*i,this._textHeight=(s.y+t.lineHeight)*i;for(const C in T){const A=T[C];if(this.anchor.x!==0||this.anchor.y!==0){let z=0;const K=this._textWidth*this.anchor.x,St=this._textHeight*this.anchor.y;for(let H=0;H<A.total;H++)A.vertices[z++]-=K,A.vertices[z++]-=St,A.vertices[z++]-=K,A.vertices[z++]-=St,A.vertices[z++]-=K,A.vertices[z++]-=St,A.vertices[z++]-=K,A.vertices[z++]-=St}this._maxLineHeight=_*i;const O=A.mesh.geometry.getBuffer("aVertexPosition"),Q=A.mesh.geometry.getBuffer("aTextureCoord"),X=A.mesh.geometry.getIndex();O.data=A.vertices,Q.data=A.uvs,X.data=A.indices,O.update(),Q.update(),X.update()}for(let C=0;C<n.length;C++)_f.push(n[C]);this._font=t,this.dirty=!1}updateTransform(){this.validate(),this.containerUpdateTransform()}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0);const{distanceFieldRange:e,distanceFieldType:i,size:s}=Br.available[this._fontName];if(i!=="none"){const{a:n,b:o,c:a,d:l}=this.worldTransform,h=Math.sqrt(n*n+o*o),c=Math.sqrt(a*a+l*l),u=(Math.abs(h)+Math.abs(c))/2,d=this.fontSize/s,f=t._view.resolution;for(const p of this._activePagesMeshData)p.mesh.shader.uniforms.uFWidth=u*e*d*f}super._render(t)}getLocalBounds(){return this.validate(),super.getLocalBounds()}validate(){const t=Br.available[this._fontName];if(!t)throw new Error(`Missing BitmapFont "${this._fontName}"`);this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()}get tint(){return this._tintColor.value}set tint(t){if(this.tint!==t){this._tintColor.setValue(t);for(let e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.dirty=!0)}get fontName(){return this._fontName}set fontName(t){if(!Br.available[t])throw new Error(`Missing BitmapFont "${t}"`);this._fontName!==t&&(this._fontName=t,this.dirty=!0)}get fontSize(){return this._fontSize??Br.available[this._fontName].size}set fontSize(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get text(){return this._text}set text(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)}get maxWidth(){return this._maxWidth}set maxWidth(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)}get maxLineHeight(){return this.validate(),this._maxLineHeight}get textWidth(){return this.validate(),this._textWidth}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)}get roundPixels(){return this._roundPixels}set roundPixels(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)}get textHeight(){return this.validate(),this._textHeight}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}destroy(t){const{_textureCache:e}=this,i=Br.available[this._fontName].distanceFieldType==="none"?gf:yf;i.push(...this._activePagesMeshData);for(const s of this._activePagesMeshData)this.removeChild(s.mesh);this._activePagesMeshData=[],i.filter(s=>e[s.mesh.texture.baseTexture.uid]).forEach(s=>{s.mesh.texture=et.EMPTY});for(const s in e)e[s].destroy(),delete e[s];this._font=null,this._tintColor=null,this._textureCache=null,super.destroy(t)}};AS.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0};const SS=[".xml",".fnt"],CS={extension:{type:Y.LoadParser,priority:Ue.Normal},name:"loadBitmapFont",test(r){return SS.includes(Yt.extname(r).toLowerCase())},async testParse(r){return go.test(r)||Bh.test(r)},async parse(r,t,e){const i=go.test(r)?go.parse(r):Bh.parse(r),{src:s}=t,{page:n}=i,o=[];for(let h=0;h<n.length;++h){const c=n[h].file;let u=Yt.join(Yt.dirname(s),c);u=Sh(u,s),o.push(u)}const a=await e.load(o),l=o.map(h=>a[h]);return Br.install(i,l,!0)},async load(r,t){return(await tt.ADAPTER.fetch(r)).text()},unload(r){r.destroy()}};rt.add(CS);const Dh=class qi extends Kr{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new qi(Object.keys(qi.defaultOptions).reduce((e,i)=>({...e,[i]:t[i]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(t=>{URL.revokeObjectURL(t.src),t.refs--,t.refs===0&&(t.fontFace&&document.fonts.delete(t.fontFace),delete qi.availableFonts[t.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,e={}){const{availableFonts:i}=qi;if(i[t]){const s=i[t];return this._fonts.push(s),s.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return tt.ADAPTER.fetch(t).then(s=>s.blob()).then(async s=>new Promise((n,o)=>{const a=URL.createObjectURL(s),l=new FileReader;l.onload=()=>n([a,l.result]),l.onerror=o,l.readAsDataURL(s)})).then(async([s,n])=>{const o=Object.assign({family:Yt.basename(t,Yt.extname(t)),weight:"normal",style:"normal",display:"auto",src:s,dataSrc:n,refs:1,originalUrl:t,fontFace:null},e);i[t]=o,this._fonts.push(o),this.styleID++;const a=new FontFace(o.family,`url(${o.src})`,{weight:o.weight,style:o.style,display:o.display});o.fontFace=a,await a.load(),document.fonts.add(a),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...t){const e=t.filter(i=>!this._overrides.includes(i));e.length>0&&(this._overrides.push(...e),this.styleID++)}removeOverride(...t){const e=t.filter(i=>this._overrides.includes(i));e.length>0&&(this._overrides=this._overrides.filter(i=>!e.includes(i)),this.styleID++)}toCSS(t){return[`transform: scale(${t})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((t,e)=>`${t}
            @font-face {
                font-family: "${e.family}";
                src: url('${e.dataSrc}');
                font-weight: ${e.weight};
                font-style: ${e.style};
                font-display: ${e.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(t){this._stylesheet!==t&&(this._stylesheet=t,this.styleID++)}normalizeColor(t){return Array.isArray(t)&&(t=yE(t)),typeof t=="number"?gE(t):t}dropShadowToCSS(){let t=this.normalizeColor(this.dropShadowColor);const e=this.dropShadowAlpha,i=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),s=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);t.startsWith("#")&&e<1&&(t+=(e*255|0).toString(16).padStart(2,"0"));const n=`${i}px ${s}px`;return this.dropShadowBlur>0?`text-shadow: ${n} ${this.dropShadowBlur}px ${t}`:`text-shadow: ${n} ${t}`}reset(){Object.assign(this,qi.defaultOptions)}onBeforeDraw(){const{fontsDirty:t}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&t?new Promise(e=>setTimeout(e,100)):Promise.resolve()}get isSafari(){const{userAgent:t}=tt.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}set fillGradientStops(t){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(t){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(t){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(t){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(t){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(t){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(t){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};Dh.availableFonts={},Dh.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};let pl=Dh;const to=class Ki extends Di{constructor(t="",e={}){super(et.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;const i=new Image,s=et.from(i,{scaleMode:tt.SCALE_MODE,resourceOptions:{autoLoad:!1}});s.orig=new mt,s.trim=new mt,this.texture=s;const n="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(n,"svg"),l=document.createElementNS(n,"foreignObject"),h=document.createElementNS(o,"div"),c=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=Ki.defaultMaxWidth,this.maxHeight=Ki.defaultMaxHeight,this._domElement=h,this._styleElement=c,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(c),this._foreignObject.appendChild(h),this._image=i,this._loadImage=new Image,this._autoResolution=Ki.defaultAutoResolution,this._resolution=Ki.defaultResolution??tt.RESOLUTION,this.text=t,this.style=e}measureText(t){var c,u;const{text:e,style:i,resolution:s}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},t);Object.assign(this._domElement,{innerHTML:e,style:i.toCSS(s)}),this._styleElement.textContent=i.toGlobalCSS(),document.body.appendChild(this._svgRoot);const n=this._domElement.getBoundingClientRect();this._svgRoot.remove();const{width:o,height:a}=n;(o>this.maxWidth||a>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");const l=Math.min(this.maxWidth,Math.ceil(o)),h=Math.min(this.maxHeight,Math.ceil(a));return this._svgRoot.setAttribute("width",l.toString()),this._svgRoot.setAttribute("height",h.toString()),e!==this._text&&(this._domElement.innerHTML=this._text),i!==this._style&&(Object.assign(this._domElement,{style:(c=this._style)==null?void 0:c.toCSS(s)}),this._styleElement.textContent=(u=this._style)==null?void 0:u.toGlobalCSS()),{width:l+i.padding*2,height:h+i.padding*2}}async updateText(t=!0){const{style:e,_image:i,_loadImage:s}=this;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),!this.dirty&&t)return;const{width:n,height:o}=this.measureText();i.width=s.width=Math.ceil(Math.max(1,n)),i.height=s.height=Math.ceil(Math.max(1,o)),this._updateID++;const a=this._updateID;await new Promise(l=>{s.onload=async()=>{if(a<this._updateID){l();return}await e.onBeforeDraw(),i.src=s.src,s.onload=null,s.src="",this.updateTexture(),l()};const h=new XMLSerializer().serializeToString(this._svgRoot);s.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(h)}`})}get source(){return this._image}updateTexture(){const{style:t,texture:e,_image:i,resolution:s}=this,{padding:n}=t,{baseTexture:o}=e;e.trim.width=e._frame.width=i.width/s,e.trim.height=e._frame.height=i.height/s,e.trim.x=-n,e.trim.y=-n,e.orig.width=e._frame.width-n*2,e.orig.height=e._frame.height-n*2,this._onTextureUpdate(),o.setRealSize(i.width,i.height,s),this.dirty=!1}_render(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._render(t)}_renderCanvas(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(t)}getLocalBounds(t){return this.updateText(!0),super.getLocalBounds(t)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){var i,s,n,o,a;typeof t=="boolean"&&(t={children:t}),t=Object.assign({},Ki.defaultDestroyOptions,t),super.destroy(t);const e=null;this.ownsStyle&&((i=this._style)==null||i.cleanFonts()),this._style=e,(s=this._svgRoot)==null||s.remove(),this._svgRoot=e,(n=this._domElement)==null||n.remove(),this._domElement=e,(o=this._foreignObject)==null||o.remove(),this._foreignObject=e,(a=this._styleElement)==null||a.remove(),this._styleElement=e,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=e,this._image.src="",this._image=e}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(t){this.updateText(!0);const e=Gr(this.scale.x)||1;this.scale.x=e*t/this._image.width/this.resolution,this._width=t}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(t){this.updateText(!0);const e=Gr(this.scale.y)||1;this.scale.y=e*t/this._image.height/this.resolution,this._height=t}get style(){return this._style}set style(t){this._style!==t&&(t=t||{},t instanceof pl?(this.ownsStyle=!1,this._style=t):t instanceof Kr?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=pl.from(t)):(this.ownsStyle=!0,this._style=new pl(t)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(t){t=String(t===""||t===null||t===void 0?" ":t),t=this.sanitiseText(t),this._text!==t&&(this._text=t,this.dirty=!0)}get resolution(){return this._resolution}set resolution(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)}sanitiseText(t){return t.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};to.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},to.defaultMaxWidth=2024,to.defaultMaxHeight=2024,to.defaultAutoResolution=!0;const Cg=(r,t)=>{const e=t.x-r.x,i=t.y-r.y,s=e<0?-1:1,n=Math.pow(e*e+i*i,1/2)*s;let o=Math.atan2(i,e);return s===-1&&(o=i<0?-Math.PI+o:Math.PI+o),{width:e,height:i,distance:n,angle:o}};let vi,Me;function IS(r,t){const{drawType:e}=r.graphicsConfig;vi=this.parent,Me=vi.customInfo,vi!==r.container&&r.removeSelected(),e==="select"&&(t.stopPropagation(),r.container=vi,r.drawSelected(),r.app.stage.setChildIndex(vi,r.app.stage.children.length-1),Me.isMove=!0,Me.startPoint={x:t.x,y:t.y})}function vf(){Me&&(Me.isMove=!1)}function PS(r){if(!(Me!=null&&Me.isMove))return;const t=r.x-Me.startPoint.x,e=r.y-Me.startPoint.y;Me.startPoint={x:r.x,y:r.y},vi.x+=t,vi.y+=e}function va(r){r.on("pointerenter",()=>{const{drawType:t}=this.graphicsConfig;if(t!=="select")return r.cursor="crosshair";r.cursor="move"}),r.on("pointerdown",t=>IS.call(r,this,t)),r.on("pointerup",vf),r.on("pointerleave",vf),r.on("pointermove",PS)}class RS{constructor({width:t,height:e,bgColor:i,graphicsConfig:s,dom:n}){ar(this,"app");ar(this,"dom");ar(this,"scale");ar(this,"graphicsConfig");ar(this,"container");ar(this,"isDraw",!1);ar(this,"startPoints",{x:0,y:0});this.app=new ng({width:t*2,height:e*2,antialias:!0,eventMode:"static",backgroundColor:i||16777215,resolution:window.devicePixelRatio||1}),this.dom=n,this.scale=this.app.screen.width/t,this.graphicsConfig=s,this.initCanvasSize(t,e),this.createMesh(),n.appendChild(this.app.view)}initCanvasSize(t,e){this.app.view.style&&(this.app.view.style.width=`${t}px`,this.app.view.style.height=`${e}px`),this.app.stage.scale.set(this.scale),this.app.stage.position={x:-t,y:-e}}createMesh(t=!0){if(!t){const n=this.app.stage.getChildByName("mesh");return n==null?void 0:n.destroy()}const e=new be;this.app.stage.addChildAt(e,0);const i=this.app.screen.width,s=this.app.screen.height;e.name="mesh",e.hitArea=new mt(0,0,i,s),e.lineStyle(1,0,.1);for(let n=0;n<i;n+=20)e.moveTo(n,0),e.lineTo(n,s);for(let n=0;n<s;n+=20)e.moveTo(0,n),e.lineTo(i,n)}getMappingPoints(t,e){return{x:t+Math.abs(this.app.stage.x)/this.scale,y:e+Math.abs(this.app.stage.y)/this.scale}}drawStroke(t,e=[]){t.beginFill(0,0),t.lineStyle({...this.graphicsConfig.styleConfig,cap:Je.ROUND,join:ce.ROUND});const s=this.container.customInfo,{drawType:n,styleConfig:o,randomOffset:a}=s;if(n!=="paintingBrush"&&!(n==="arc"&&o.type==="simple")){(!a||n==="mark")&&(s.randomOffset=e.concat(e).map(()=>Math.random()*(3*2)-3)),s.controlPoints=o.type==="simple"?e:s.randomOffset.map((l,h)=>{const c=h%e.length;return l+e[c]});for(let l=0;l<s.controlPoints.length;l+=6){const[h,c,u,d,f,p]=s.controlPoints.slice(l,l+6);t.moveTo(h,c),t.quadraticCurveTo(u,d,f,p)}}}createElement(t=[]){const e=this.container;e.removeChildren();const i=new be;return i.name="main_graphics",e.addChild(i),va.call(this,i),this.drawStroke(i,t),this.drawBackground(i,t),e.setChildIndex(i,e.children.length-1),i}drawBackground(t,e=[]){var p,m,g,y;const i=this.container,{drawType:s,randomOffset:n,styleConfig:{alpha:o,type:a,fillColor:l,fillStyle:h}}=i.customInfo;if(l==="transparent"||["mark","straightLine"].includes(s))return;const c=new be;if(c.name="background_elm_left",c.position.set(t.x,t.y),c.lineStyle({width:1,color:l,cap:Je.ROUND,join:ce.ROUND}),(p=this.container)==null||p.addChild(c),(m=this.container)==null||m.setChildIndex(c,this.container.children.length-2),h==="simple"){c.beginFill(l,o),s!=="arc"&&c.drawPolygon(e);return}t.getBounds();const u=t.geometry.graphicsData;let d=[];const f=a==="simple"?u.length:u.length/2;for(let x=0;x<f;x++){if(s==="rect"&&(d=[...d,...u[x].points]),s==="arc"){if(a==="simple"){d=u[x].points.filter((S,D)=>D%4<2);let _=Math.floor(d.length/8);_%2===1&&_++;const b=d.slice(0,_);d=d.slice(_).concat(b);continue}if(d=[...d,...u[x].points],x===f-1){let _=u[0].points.length/2;_%2===1&&_++;const b=d.slice(0,_);d=d.slice(_).concat(b)}}s==="diamond"&&x%2===1&&(d=[...d,...u[x].points])}for(let x=0;x<d.length/2;x+=2){let[_,b]=d.slice(x,x+2),[S,D]=d.slice(d.length-2-x);for(let M=0;M<2;M++){const[T,I,F,q]=n==null?void 0:n.sort(()=>Math.random()-.5).slice(-4);_+=T,b+=I,S+=F,D+=q;const{width:C,height:A}=Cg({x:_,y:b},{x:S,y:D});c.moveTo(_,b),c.quadraticCurveTo(_+C/2,b+A/2,S,D)}}if(h==="grid"){const x=new be;x.name="background_elm_right",(g=this.container)==null||g.addChild(x),(y=this.container)==null||y.setChildIndex(x,this.container.children.length-2),x.lineStyle(c.line),x.position.set(t.x+t.geometry.bounds.maxX,t.y),c.geometry.graphicsData.forEach(_=>{x.drawShape(_.shape)}),x.scale.set(-1,1)}}copy(t){}clear(t){if(t)return this.app.stage.removeChild(this.container);this.app.stage.children.filter(e=>e.name!=="mesh").forEach(e=>this.app.stage.removeChild(e))}async canvas2Base64(t="image/jpeg"){const e=this.container?this.container.children.filter(c=>c.name!=="selected"):this.app.stage.children.filter(c=>c.name!=="mesh");if(!e.length)return await this.app.renderer.extract.base64(this.app.stage,t);const i=new le;i.addChild(...e);const{x:s,y:n,width:o,height:a}=i.getBounds(),l=new be;t==="image/jpeg"&&i.addChildAt(l,0),l.position.set(s,n),l.beginFill(16777215,1),l.drawRect(0,0,o,a);const h=await this.app.renderer.extract.base64(i,t);return this.container?this.container.addChild(...e):this.app.stage.addChild(...e),h}}class MS extends RS{drawRect(t,e){const{x:i,y:s}=this.startPoints,n=t-i,o=e-s,a=[0,0,n/2,0,n,0,n,0,n,o/2,n,o,n,o,n/2,o,0,o,0,o,0,o/2,0,0],l=this.createElement(a);l.hitArea=new br(a)}}function BS(r,t){const e=document.createElement("canvas"),i=e.getContext("2d");return e.width=r,e.height=t,i.strokeStyle="#000000",i.lineWidth=t/10,i.setLineDash([5,5]),i.beginPath(),i.moveTo(0,t/2),i.lineTo(r,t/2),i.stroke(),i.lineWidth=r/10,i.beginPath(),i.moveTo(r/2,0),i.lineTo(r/2,t),i.stroke(),et.from(e)}let Zi,_r,Ig={width:0,height:0};function DS(r,t,e){e.stopPropagation(),Zi=this.parent.parent,_r=Zi.customInfo,_r.isMove=!0,_r.startPoint={x:e.x,y:e.y},Zi.getChildByName("selected"),Zi.getChildByName("main_graphics");const{width:i,height:s}=Zi;Ig={width:i,height:s}}function xf(r){r.stopPropagation(),_r&&(_r.isMove=!1)}function FS(r,t){if(t.stopPropagation(),!(_r!=null&&_r.isMove))return;const{width:e,height:i}=Ig,{x:s,y:n}=_r.startPoint||{x:0,y:0},o=t.x-s,a=t.y-n;return Zi.scale.set(1+o/e,1+a/i),console.log(o,e)}function OS(r,t){r.on("pointerdown",e=>{console.log(999),DS.call(r,this,t,e)}),r.on("pointerup",e=>{xf.call(r,e)}),r.parent.parent.parent.on("pointerup",e=>{xf.call(r,e)}),r.parent.parent.parent.on("pointermove",e=>{FS.call(r,this,e)})}const eo=12,$i=8,NS=(r,t)=>{switch(!0){case[0,4].includes(t):return r.cursor="ew-resize";case[2,6].includes(t):return r.cursor="ns-resize";case[1,5].includes(t):return r.cursor="nwse-resize";case[3,7].includes(t):return r.cursor="nesw-resize"}};function LS(r,t,e){t+=$i/2,e+=$i/2;const i=Math.atan(e/t),s=Math.PI/2-i;let n=-i;const o=!r.children.length;(o?new Array(8).fill(8).map(()=>new be):r.children).forEach((l,h)=>{const c=h%4<=1?i:s;n+=c;const u=Math.pow(t*t+e*e,1/2);let d=Math.cos(n)*u,f=Math.sin(n)*u;(d<-t||d>t)&&(d=d<0?-t:t),(f<-e||f>e)&&(f=f<0?-e:e),o&&(r.addChild(l),NS(l,h),OS.call(this,l,h)),l.position.set(d,f),l.beginFill(16777215,.8),l.lineStyle({width:1,color:0}),l.drawRect(-$i/2,-$i/2,$i,$i)})}const kS=r=>{switch(r.name){case"main_graphics":return r.geometry.bounds;case"main_text":return{minX:0,minY:0,maxX:r.width,maxY:r.height};case"main_sprite":return{minX:0,minY:0,maxX:r.width,maxY:r.height};default:return r.geometry.bounds}};class US extends MS{removeSelected(t=this.container){const e=t==null?void 0:t.getChildByName("selected");t==null||t.removeChild(e)}drawSelected(){const t=this.container;let e=t.getChildByName("selected");if(e)return;e=new be,e.name="selected",t.addChild(e);const i=t.children.filter(d=>d.name&&/^main/.test(d.name))[0],{minX:s,minY:n,maxX:o,maxY:a}=kS(i),l=o-s+eo,h=a-n+eo,c=l/2,u=h/2;e.beginFill(0,0),e.lineTextureStyle({width:1,texture:BS(l,h)}),e.position.set(i.x+s+c-eo/2,i.y+n+u-eo/2),e.drawPolygon([-c,-u,c,-u,c,u,-c,u]),LS.call(this,e,c,u)}}class GS extends US{drawDiamond(t,e){const{x:i,y:s}=this.startPoints,n=t-i,o=e-s,a=[0,o/2,n/4,o/4,n/2,0,n/2,0,n*3/4,o/4,n,o/2,n,o/2,n*3/4,o*3/4,n/2,o,n/2,o,n/4,o*3/4,0,o/2],l=this.createElement(a);l.hitArea=new br(a)}}class HS extends GS{drawArc(t,e){var m;const{x:i,y:s}=this.startPoints,o=this.container.customInfo,{type:a,fillStyle:l}=o.styleConfig,h=t-i,c=e-s,u=[0,c/2+3,0,0,h/2+3,0,h/2-3,0,h,0,h,c/2+3,h,c/2-3,h,c,h/2-3,c,h/2+3,c,0,c,0,c/2-3],d=[h/2,c/2,Math.abs(h/2),Math.abs(c/2)],f=this.createElement(u);f.hitArea=new vn(...d),a==="simple"&&f.drawEllipse(...d);const p=(m=this.container)==null?void 0:m.getChildByName("background_elm_left");l==="simple"?p==null||p.drawEllipse(...d):this.drawBackground(f)}}const $S=(r,t)=>{const e=Math.abs(r)<100?Math.abs(r)/10*4:40;let i=r<0?1:-1;return t==="left"&&(i*=-1),{x:e*i,y:e/3}};function bf({elm:r,type:t,point:e,direction:i,angle:s,distance:n}){const o=new be;o.position.set(e.x,e.y),o.rotation=s,r.addChild(o);const{x:a,y:l}=$S(n,i),h=t==="arrow"?[0,0,a/2,-l/2,a,-l,0,0,a/2,l/2,a,l]:[0,-l,0,0,0,l];this.drawStroke(o,h)}class VS extends HS{drawMark(t,e){const i=this.container,{drawType:s,styleConfig:n}=i.customInfo,{extremePoint_left:o,extremePoint_right:a}=n,{width:l,height:h,distance:c,angle:u}=Cg(this.startPoints,{x:t,y:e}),d=[0,0,l/2,h/2,l,h],f=this.createElement(d);s==="straightLine"&&(n.extremePoint_left="none",n.extremePoint_right="none"),o!=="none"&&bf.call(this,{elm:f,type:o,point:{x:0,y:0},direction:"left",angle:u,distance:c}),a!=="none"&&bf.call(this,{elm:f,type:a,point:{x:l,y:h},direction:"right",angle:u,distance:c})}}const Ke=28,XS=(r,t,e)=>{const i=document.createElement(r);return i.style.cssText=`
    overflow: hidden;
    position: absolute;
    top: ${t.y-Ke/2}px;
    left: ${t.x}px;
    width: ${Ke}px;
    height: ${Ke}px;
    line-height: 1;
    font-family: LongCang-Regular;
    font-size: ${Ke}px;
    resize: none;
    border: none;
    outline: none;
    color: transparent;
    caret-color: ${e};
    background-color: transparent;
  `,i};class zS extends VS{drawText(t="",e){const i=this.container,{styleConfig:{color:s,alpha:n}}=i.customInfo,o=new Ac(t,{fontFamily:"LongCang-Regular",fontSize:Ke,lineHeight:Ke,fill:s});o.name="main_text",o.alpha=n,i.addChild(o),va.call(this,o);const a=XS("textarea",{x:this.startPoints.x-Math.abs(this.app.stage.x)/this.scale,y:this.startPoints.y-Math.abs(this.app.stage.y)/this.scale},s);e=e||{...this.startPoints},t||(i.y-=Ke/2,e.y=Ke/2),e.y-=t?0:Ke/2,a.oninput=l=>{o.text=l.target.value,a.style.width=o.width+Ke+"px",a.style.height=o.height+"px"},a.onblur=()=>{var l;this.container=void 0,(l=a.parentNode)==null||l.removeChild(a)},!t&&this.dom.appendChild(a),setTimeout(()=>a.focus())}}class WS extends zS{paintingBrush(t,e){const i=this.container;let s=i.getChildByName("main_graphics");s||(s=new be,s.name="main_graphics",i.addChild(s)),this.drawStroke(s);const{x:n,y:o}=this.startPoints;s.moveTo(n-i.x,o-i.y),s.lineTo(t-i.x,e-i.y),this.startPoints={x:t,y:e}}}class jS extends WS{drawImage(t,e){const{drawType:i,styleConfig:s}=this.graphicsConfig;let{x:n,y:o}=this.getMappingPoints(window.innerWidth/2,window.innerHeight/2);this.removeSelected();const a=new Image;a.src=t,a.onload=()=>{const h=200*a.height/a.width;this.container=new le,this.app.stage.addChild(this.container),n=e?e.x:n-200/2,o=e?e.y:o-h/2,this.container.position.set(n,o),this.container.customInfo={drawType:i,styleConfig:{...s}};const c=Di.from(t);c.alpha=s.alpha,this.container.addChild(c),c.name="main_sprite",va.call(this,c),c.width=200,c.height=h,this.drawSelected()}}}class YS extends jS{copy(){if(!this.container)return;this.removeSelected();const t=this.container.customInfo;let{x:e,y:i}=this.container;e+=10,i+=10;const s=this.container.getChildByName("main_sprite"),n=this.container.getChildByName("main_text");if(s){const a=s.texture.baseTexture.cacheId;this.drawImage(a,{x:e,y:i});return}const o=new le;o.position.set(e,i),o.customInfo={...t,styleConfig:{...t.styleConfig}},this.app.stage.addChild(o),n?(this.container=o,this.drawText(n.text,{x:e,y:i})):(this.container.children.filter(a=>a.name!=="selected").forEach(a=>{const l=a.geometry.graphicsData,h=new be;o.addChild(h),h.name=a.name,h.hitArea=a.hitArea,h.scale=a.scale,a.name==="main_graphics"&&va.call(this,h),h.beginFill(a.fill.color,a.fill.alpha),h.lineStyle({...a.line}),l.forEach(c=>h.drawShape(c.shape))}),this.container=o),this.drawSelected()}}function Pg({deltaX:r,deltaY:t}){if(document.querySelectorAll("textarea").length)return;const i=this.app.stage;i.x+=r*-1,i.y+=t*-1;const s=this.app.screen.width,n=this.app.screen.height,o=i.children.filter(a=>a.name!=="mesh");(i.x>=0||i.x<=-s)&&(o.forEach(a=>{a.x=a.x+s/this.scale/2*(r<0?1:-1)}),i.x=-(s/this.scale)),(i.y>=0||i.y<=-n)&&(o.forEach(a=>{a.y=a.y+n/this.scale/2*(t<0?1:-1)}),i.y=-(n/this.scale))}function qS({x:r,y:t}){const{drawType:e,styleConfig:i}=this.graphicsConfig;if(this.startPoints=this.getMappingPoints(r,t),this.container&&(this.removeSelected(),this.container=void 0),this.container=new le,this.container.customInfo={drawType:e,styleConfig:{...i}},this.container.position.set(this.startPoints.x,this.startPoints.y),this.app.stage.addChild(this.container),e!=="image"){if(e==="text")return this.drawText();this.keys.includes("space")&&(document.body.style.cursor="grabbing"),this.isDraw=!0}}function KS({x:r,y:t}){if(!this.isDraw)return;const e=this.getMappingPoints(r,t),i=(e.x-this.startPoints.x)*-1,s=(e.y-this.startPoints.y)*-1;if(this.keys.includes("space"))return Pg.call(this,{deltaX:i,deltaY:s});const o=this.container.customInfo.drawType,a={rect:this.drawRect.bind(this),diamond:this.drawDiamond.bind(this),arc:this.drawArc.bind(this),mark:this.drawMark.bind(this),straightLine:this.drawMark.bind(this),paintingBrush:this.paintingBrush.bind(this)};a[o]&&a[o](e.x,e.y)}function Ef(){if(this.isDraw=!1,!this.container)return;if(!this.container.children.length)return this.app.stage.removeChild(this.container),this.container=void 0;const r=["select","paintingBrush","text","image"],t=this.container.customInfo.drawType;!r.includes(t)&&this.container&&this.drawSelected(),this.keys.includes("space")&&(document.body.style.cursor="default")}function ZS(){const r=this.app.stage;r.on("wheel",Pg.bind(this)),r.on("pointerdown",qS.bind(this)),r.on("pointermove",KS.bind(this)),r.on("pointerup",Ef.bind(this)),r.on("pointerleave",Ef.bind(this))}function QS(r){const t=r.code==="Space"?r.code.toLowerCase():r.key.toLowerCase();switch(this.keys.push(t),!0){case["backspace","delete"].includes(t):return document.querySelector("textarea")?void 0:this.app.stage.removeChild(this.container);case(r.ctrlKey&&t==="c"):return this.copy()}}function JS(r){const t=r.code==="Space"?r.code.toLowerCase():r.key.toLowerCase();this.keys=this.keys.filter(e=>e!==t)}function tC(){document.addEventListener("keydown",QS.bind(this)),document.addEventListener("keyup",JS.bind(this))}class eC extends YS{constructor(e){super(e);ar(this,"keys");this.keys=[],ZS.call(this),tC.call(this)}}const rC=nr({__name:"index",setup(r){const t=ws(),e=oe();return Xr(t.styleConfig,i=>{t.pixiApp.styleConfig={...i,drawType:t.drawType}}),Zh(()=>{const i=new eC({width:window.innerWidth,height:window.innerHeight,graphicsConfig:{drawType:t.drawType,styleConfig:t.styleConfig},dom:e.value});t.pixiApp=yt(i)}),(i,s)=>(Wt(),_e("section",null,[pt("section",null,[Lt(Rv),Lt(px)]),pt("main",{ref_key:"container",ref:e},null,512)]))}}),iC=wv({history:G0("/style-palette/"),routes:[{path:"/",name:"home",component:rC}]}),Sc=h0(E0);Sc.use(v0);Sc.use(iC);Sc.mount("#app");
